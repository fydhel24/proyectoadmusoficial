import{j as e,r as l,$,Y as W}from"./app-B43QGLc0.js";import{b as A,A as G,B as E,C as Y,D as J}from"./app-layout-Be3qQQND.js";import{u as K,T as x,B as i,P as Q}from"./Box-wyR9uVm8.js";import{u as U,C as M}from"./Close-Cz4RoyBw.js";import{S as Z}from"./Snackbar-DXjD44eI.js";import{A as ee}from"./Alert-jlTjsRRW.js";import{G as _}from"./Grid-CETg5pbP.js";import{C as ae,a as te}from"./CardContent-DjPAPL63.js";import{B as w}from"./Button-DYoxZ0OF.js";import{T as se}from"./TextField-DxJvG6sb.js";import{I as j}from"./IconButton-BL5db-mN.js";import{S as oe}from"./Search-FSgN8jeY.js";import{T as re,a as ne,b as ie,c as I,d as s,D as z,e as le}from"./Delete-BkjAzzvM.js";import{C as ce}from"./CalendarToday-D5LjfBW-.js";import{E as H}from"./Edit-ObCAyVeJ.js";import{a as de}from"./TablePagination-ByLNpSOA.js";import{D as me,a as xe,b as pe,c as he}from"./DialogTitle-DF65PE_P.js";import"./app-logo-icon-2Eh3Z-eT.js";import"./index-CfAE_ukx.js";import"./index-HnoccPYx.js";import"./getThemeProps-DFqRyJBL.js";import"./Grow-DipP32jZ.js";import"./useThemeProps-B6-r2NBi.js";import"./ButtonBase-BmVSOhCT.js";import"./CircularProgress-Bt0vLMV2.js";import"./Select-BCKCZh52.js";import"./Portal-DCrN8Gw5.js";import"./MenuItem-DkzQH4XY.js";import"./dividerClasses-CS4maqJB.js";const ue=A(e.jsx("path",{d:"M16.53 11.06 15.47 10l-4.88 4.88-2.12-2.12-1.06 1.06L10.59 17zM19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 16H5V8h14z"})),fe=A(e.jsx("path",{d:"M19 5v14H5V5zm1.1-2H3.9c-.5 0-.9.4-.9.9v16.2c0 .4.4.9.9.9h16.2c.4 0 .9-.5.9-.9V3.9c0-.5-.5-.9-.9-.9M11 7h6v2h-6zm0 4h6v2h-6zm0 4h6v2h-6zM7 7h2v2H7zm0 4h2v2H7zm0 4h2v2H7z"}));function R(h){return{monday:"Lunes",tuesday:"Martes",wednesday:"Miércoles",thursday:"Jueves",friday:"Viernes",saturday:"Sábado",sunday:"Domingo"}[h]||h}const $e=({companies:h})=>{const[D,y]=l.useState(!1),[d,b]=l.useState(null),[k,u]=l.useState(null),[m,L]=l.useState(h),[C,B]=l.useState(""),[f,P]=l.useState(0),[p,V]=l.useState(10),t=K(),o=U(t.breakpoints.down("sm")),S=l.useMemo(()=>{const a=C.trim().toLowerCase();return a?m.filter(r=>{var n,c;return r.name.toLowerCase().includes(a)||((c=(n=r.category)==null?void 0:n.name)==null?void 0:c.toLowerCase().includes(a))}):m},[C,m]),T=l.useMemo(()=>S.slice(f*p,f*p+p),[S,f,p]),q=l.useMemo(()=>{const a={monday:0,tuesday:0,wednesday:0,thursday:0,friday:0};return m.forEach(r=>{const n=r.availability_days||[];new Set(n.map(g=>g.day_of_week)).forEach(g=>{a[g]!==void 0&&a[g]++})}),a},[m]);function O(a){b(a),y(!0)}async function F(){var a;if(d){try{const n=await(await fetch(`/companies/${d.id}`,{method:"DELETE",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":((a=document.querySelector('meta[name="csrf-token"]'))==null?void 0:a.getAttribute("content"))||""}})).json();u(n.success||"Compañía eliminada"),L(m.filter(c=>c.id!==d.id))}catch{u("Error al eliminar la compañía")}y(!1),b(null)}}function v(){y(!1),b(null)}const N=(a,r)=>{P(r)},X=a=>{V(parseInt(a.target.value,10)),P(0)};return e.jsxs(G,{children:[e.jsx($,{title:"Compañías"}),e.jsx(Z,{open:!!k,autoHideDuration:4e3,onClose:()=>u(null),anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(ee,{onClose:()=>u(null),severity:"success",sx:{width:"100%"},children:k})}),e.jsx(_,{container:!0,spacing:2,sx:{mb:3,mx:{xs:0,md:4}},children:Object.entries(q).map(([a,r])=>e.jsx(_,{item:!0,xs:12,sm:6,md:2.4,children:e.jsx(ae,{sx:{background:t.palette.grey[100],borderRadius:2,boxShadow:2},children:e.jsxs(te,{children:[e.jsx(x,{variant:"subtitle1",sx:{fontWeight:"bold",mb:1},children:R(a)}),e.jsx(x,{variant:"h6",color:"primary",sx:{fontWeight:700},children:r}),e.jsx(x,{variant:"body2",color:"text.secondary",children:r===1?"empresa":"empresas"})]})})},a))}),e.jsxs(i,{sx:{py:6,mx:{xs:0,md:4}},children:[e.jsxs(i,{sx:{mb:4,display:"flex",flexDirection:{xs:"column",md:"row"},gap:2,alignItems:{md:"center"},justifyContent:{md:"space-between"}},children:[e.jsx(w,{component:W,href:"/companies/create",variant:"contained",color:"primary",sx:{fontWeight:"bold"},startIcon:e.jsx(E,{}),children:"Crear nueva compañía"}),e.jsx(se,{placeholder:"Buscar por nombre o categoría...",value:C,onChange:a=>B(a.target.value),size:"small",fullWidth:!0,sx:{maxWidth:320},InputProps:{startAdornment:e.jsx(j,{tabIndex:-1,children:e.jsx(oe,{})})}})]}),e.jsxs(re,{component:Q,sx:{borderRadius:2,boxShadow:3,overflowX:"auto",border:"1px solid #e0e0e0",background:t.palette.background.paper,mx:{xs:0,md:2}},children:[e.jsxs(ne,{stickyHeader:!0,sx:{minWidth:900},children:[e.jsx(ie,{children:e.jsxs(I,{children:[e.jsx(s,{sx:{fontWeight:"bold",backgroundColor:t.palette.primary.main,color:t.palette.common.white,padding:o?"8px":"16px",fontSize:o?"0.875rem":"1rem"},children:e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(E,{fontSize:"small"})," Nombre"]})}),e.jsx(s,{sx:{fontWeight:"bold",backgroundColor:t.palette.primary.main,color:t.palette.common.white,padding:o?"8px":"16px",fontSize:o?"0.875rem":"1rem"},children:e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Y,{fontSize:"small"})," Categoría"]})}),e.jsx(s,{sx:{fontWeight:"bold",backgroundColor:t.palette.primary.main,color:t.palette.common.white,padding:o?"8px":"16px",fontSize:o?"0.875rem":"1rem"},children:e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(fe,{fontSize:"small"})," Duración del contrato"]})}),e.jsx(s,{sx:{fontWeight:"bold",backgroundColor:t.palette.primary.main,color:t.palette.common.white,padding:o?"8px":"16px",fontSize:o?"0.875rem":"1rem"},children:e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(J,{fontSize:"small"})," Fecha inicio"]})}),e.jsx(s,{sx:{fontWeight:"bold",backgroundColor:t.palette.primary.main,color:t.palette.common.white,padding:o?"8px":"16px",fontSize:o?"0.875rem":"1rem"},children:e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ce,{fontSize:"small"})," Fecha fin"]})}),e.jsx(s,{sx:{fontWeight:"bold",backgroundColor:t.palette.primary.main,color:t.palette.common.white,padding:o?"8px":"16px",fontSize:o?"0.875rem":"1rem"},children:e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ue,{fontSize:"small"})," Días Disponibles"]})}),e.jsx(s,{sx:{fontWeight:"bold",backgroundColor:t.palette.primary.main,color:t.palette.common.white,padding:o?"8px":"16px",fontSize:o?"0.875rem":"1rem"},children:e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(H,{fontSize:"small"})," / ",e.jsx(z,{fontSize:"small"})," Acciones"]})})]})}),e.jsxs(le,{children:[T.length===0&&e.jsx(I,{children:e.jsx(s,{colSpan:7,align:"center",sx:{py:6,color:"text.secondary"},children:"No se encontraron compañías."})}),T.map(a=>{var r;return e.jsxs(I,{hover:!0,children:[e.jsx(s,{children:a.name}),e.jsx(s,{children:((r=a.category)==null?void 0:r.name)||e.jsx("span",{style:{color:"#aaa",fontStyle:"italic"},children:"Sin categoría"})}),e.jsx(s,{children:a.contract_duration}),e.jsx(s,{children:a.start_date||"-"}),e.jsx(s,{children:a.end_date||"-"}),e.jsx(s,{children:e.jsx(i,{sx:{display:"flex",flexDirection:"column",gap:.5},children:Array.isArray(a.availability_days)&&a.availability_days.length>0?a.availability_days.map((n,c)=>e.jsxs(i,{sx:{display:"inline-block",px:1,py:.5,borderRadius:1,fontSize:"0.75rem",fontWeight:600,bgcolor:n.turno==="mañana"?"blue.100":"yellow.100",color:n.turno==="mañana"?"blue.800":"yellow.800",border:"1px solid",borderColor:"grey.200"},children:[R(n.day_of_week),": ",n.start_time," - ",n.end_time," (",n.turno,")"]},c)):e.jsx(x,{variant:"body2",color:"text.secondary",fontStyle:"italic",children:"Sin disponibilidad"})})}),e.jsxs(s,{children:[e.jsx(j,{color:"primary",component:W,href:`/companies/${a.id}/edit`,"aria-label":"Editar",children:e.jsx(H,{})}),e.jsx(j,{color:"error",onClick:()=>O(a),"aria-label":"Eliminar",children:e.jsx(z,{})})]})]},a.id)})]})]}),e.jsx(de,{component:"div",count:S.length,page:f,onPageChange:N,rowsPerPage:p,onRowsPerPageChange:X,rowsPerPageOptions:[5,10,25,50],labelRowsPerPage:"Filas por página"})]})]}),e.jsxs(me,{open:D,onClose:v,maxWidth:"xs",fullWidth:!0,children:[e.jsxs(xe,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(x,{variant:"h6",children:"Confirmar eliminación"}),e.jsx(j,{onClick:v,children:e.jsx(M,{})})]}),e.jsx(pe,{dividers:!0,children:e.jsxs(x,{children:["¿Estás seguro de que deseas eliminar la compañía"," ",e.jsx("b",{children:d==null?void 0:d.name}),"?"]})}),e.jsxs(he,{children:[e.jsx(w,{onClick:v,color:"inherit",variant:"outlined",startIcon:e.jsx(M,{}),children:"Cancelar"}),e.jsx(w,{onClick:F,color:"error",variant:"contained",startIcon:e.jsx(z,{}),children:"Eliminar"})]})]})]})};export{$e as default};
