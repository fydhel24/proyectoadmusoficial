import{r as s,a as d,j as r,$ as k,U as I}from"./app-DWYhLQL6.js";import{A as L,B as W}from"./app-layout-p7K4X7eV.js";import{d as w}from"./debounce-Be36O1Ab.js";import{B as m}from"./Box-BbMU-_RR.js";import{C}from"./Container-C7xxEfFj.js";import{T as c}from"./Typography-IkT196je.js";import{P as x}from"./Paper-EniTK7He.js";import{S as $}from"./Stack-nT1jkqe3.js";import{T as _}from"./TextField-MHNYv_sC.js";import{I as D}from"./InputAdornment-elME3r4g.js";import{S as G}from"./Search-DU2LiQPG.js";import{T as H}from"./TableContainer-DwTJ9q9t.js";import{T as N,a as O,b as E,c as U}from"./TableRow-DBOU2XrP.js";import{T as o}from"./TableCell-C5DOKis2.js";import{C as l}from"./Chip-Dd1dfm5j.js";import{F as q}from"./FolderOutlined-Vvmzl4gO.js";import{C as J}from"./CalendarToday-zfC2SNRe.js";import{P as K}from"./Pagination-BIsdDX7E.js";import{b as h}from"./DefaultPropsProvider-CHy6HlRv.js";import{f as Q}from"./format-C6wJrPT2.js";import"./button-wMTuvAkw.js";import"./clsx-B-dksMZM.js";import"./avatar-C0bnmZQz.js";import"./createLucideIcon-DISkT-zV.js";import"./index-vDywYphy.js";import"./index-CvZMSx04.js";import"./index-C-qtZoBa.js";import"./settings-B1FLQ7wV.js";import"./app-logo-icon-HoYzQaBs.js";import"./createSvgIcon-C-V1FIKo.js";import"./useThemeProps-Bas4AH8z.js";import"./getThemeProps-DLKBaTjH.js";import"./createSimplePaletteValueFilter-WGi9SSDd.js";import"./useSlot-CO4IlLCl.js";import"./TransitionGroupContext-D4TXwhqE.js";import"./useId-o3zk_1yM.js";import"./Select-DJEe7ust.js";import"./useFormControl-CsRgqpY5.js";import"./isMuiElement-D94hBNTL.js";import"./index-DtBJPI5W.js";import"./useSlotProps-CBCDIG0V.js";import"./List-DOdfdsGa.js";import"./ownerDocument-DW-IO8s5.js";import"./Modal-N30Js5sT.js";import"./useTimeout-CcjJ2cmE.js";import"./createChainedFunction-BO_9K8Jh.js";import"./Portal-Dt5KHSRP.js";import"./Fade-BWgYys4A.js";import"./Grow-IF_zPiYA.js";import"./useControlled-5UsadrEY.js";import"./ButtonBase-DpqQEAAf.js";import"./LastPage-BK5EUJI-.js";const V=[{title:"Mis Tareas",href:"/pasante/mistareas"}],F=i=>{if(!i)return"#9E9E9E";switch(i.toLowerCase()){case"alta":return"#FF1744";case"media":return"#FF9100";case"baja":return"#00E676";default:return"#9E9E9E"}},X=i=>{if(!i)return"default";switch(i.toLowerCase()){case"publicada":return"success";case"en_revision":return"primary";case"pendiente":return"warning";default:return"default"}};function ee({tareas:i,total:u,perPage:P,currentPage:v}){const[a,f]=s.useState(i),[Y,Z]=s.useState(null),[j,z]=s.useState(""),[y,rr]=s.useState(""),[g,er]=s.useState(""),[b,tr]=s.useState(""),[B,S]=s.useState(v);s.useCallback(w(async(e,t)=>{var n;try{await d.patch(`/tareas/actualizar-estado/${e}`,{detalle:t,estado:((n=a.find(p=>p.id===e))==null?void 0:n.estado)||"pendiente"})}catch(p){console.error("Error al guardar el detalle:",p)}},1e3),[a]);const T=s.useCallback(w(async(e,t)=>{try{const n=await d.get("/tareaspublicadas",{params:{search:e,priority:t.priority,status:t.status,type:t.type,page:t.page}});f(n.data.tareas),n.data.total!==u&&S(1)}catch(n){console.error("Error al buscar tareas:",n)}},500),[]),A=e=>{const t=e.target.value;z(t),T(t,{priority:y,status:g,type:b,page:1})},M=(e,t)=>{S(t),T(j,{priority:y,status:g,type:b,page:t})};Array.from(new Set((a==null?void 0:a.map(e=>{var t;return(t=e.tarea.tipo)==null?void 0:t.nombre_tipo}).filter(Boolean))||[]));const R=async()=>{try{const e=await d.get("/tareaspublicadas",{params:{search:"",priority:"",status:"",type:"",page:1}});f(e.data.tareas)}catch(e){console.error("Error al cargar tareas:",e)}};return s.useEffect(()=>{R()},[]),r.jsxs(L,{breadcrumbs:V,children:[r.jsx(k,{title:"Mis Tareas"}),r.jsx(m,{sx:{background:"linear-gradient(135deg, #1976d2 0%, #0d47a1 100%)",color:"white",py:3,position:"relative",overflow:"hidden"},children:r.jsx(C,{maxWidth:"xl",sx:{position:"relative",zIndex:1},children:r.jsx(c,{variant:"h4",fontWeight:"bold",children:"Tareas Publicadas"})})}),r.jsxs(C,{maxWidth:"xl",sx:{py:4},children:[r.jsx(x,{sx:{p:2,mb:3},children:r.jsx($,{spacing:2,children:r.jsx(m,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:r.jsx(_,{placeholder:"Buscar tareas...",value:j,onChange:A,sx:{flexGrow:1},InputProps:{startAdornment:r.jsx(D,{position:"start",children:r.jsx(G,{})})}})})})}),r.jsx(H,{component:x,sx:{borderRadius:2,boxShadow:2},children:r.jsxs(N,{children:[r.jsx(O,{children:r.jsxs(E,{sx:{bgcolor:h("#1976d2",.05)},children:[r.jsx(o,{children:"TÃ­tulo"}),r.jsx(o,{children:"Tipo"}),r.jsx(o,{children:"Empresa"}),r.jsx(o,{children:"Fecha"}),r.jsx(o,{children:"Prioridad"}),r.jsx(o,{children:"Estado"})]})}),r.jsx(U,{children:a==null?void 0:a.map(e=>r.jsx(I.Fragment,{children:r.jsxs(E,{sx:{"&:hover":{bgcolor:h("#1976d2",.02)},borderLeft:`4px solid ${F(e.tarea.prioridad)}`},children:[r.jsx(o,{children:r.jsx(c,{variant:"subtitle2",fontWeight:"medium",children:e.tarea.titulo})}),r.jsx(o,{children:e.tarea.tipo&&r.jsx(l,{icon:r.jsx(q,{sx:{fontSize:16}}),label:e.tarea.tipo.nombre_tipo,size:"small",sx:{bgcolor:h("#1976d2",.1),color:"primary.main"}})}),r.jsx(o,{children:e.tarea.company&&r.jsx(l,{icon:r.jsx(W,{fontSize:"small"}),label:e.tarea.company.name,size:"small",variant:"outlined"})}),r.jsx(o,{children:r.jsx(l,{icon:r.jsx(J,{fontSize:"small"}),label:Q(new Date(e.fecha),"dd/MM/yyyy"),size:"small",variant:"outlined"})}),r.jsx(o,{children:r.jsx(l,{label:e.tarea.prioridad,size:"small",sx:{bgcolor:F(e.tarea.prioridad),color:"white"}})}),r.jsx(o,{children:r.jsx(l,{label:e.estado||"Sin estado",color:X(e.estado),size:"small"})})]})},e.id))})]})}),(a==null?void 0:a.length)===0&&r.jsxs(x,{sx:{p:6,textAlign:"center",borderRadius:3,background:"linear-gradient(145deg, #f8f9fa 0%, #e9ecef 100%)"},children:[r.jsx(c,{variant:"h5",color:"text.secondary",sx:{mb:2},children:"ðŸ“ No tienes tareas asignadas"}),r.jsx(c,{color:"text.secondary",children:"Por el momento no hay tareas asignadas para ti"})]}),(a==null?void 0:a.length)>0&&r.jsx(m,{sx:{mt:3,display:"flex",justifyContent:"center"},children:r.jsx(K,{count:Math.ceil(u/P),page:B,onChange:M,color:"primary",showFirstButton:!0,showLastButton:!0})})]})]})}export{ee as default};
