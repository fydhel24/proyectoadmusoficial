import{q as O,r as s,j as e,Y as f,m as o}from"./app-DwTpSH0U.js";import{A as B}from"./app-layout-DnzGBPFG.js";import{F as W}from"./index-BU7F-rKR.js";import{T as y}from"./TextField-C7xTuRXe.js";import{D as C,a as v,b as N}from"./DialogTitle-ZAyjaWw9.js";import{D as S}from"./DialogActions-jpbpOf34.js";import{B as n}from"./Button-D3LYaN2t.js";import"./button-CE2sw9In.js";import"./clsx-B-dksMZM.js";import"./avatar-3rZPDCsD.js";import"./createLucideIcon-8z-XiBgF.js";import"./index-DQwHB60N.js";import"./index-Bu13Uyqm.js";import"./index-DuFQU5C7.js";import"./settings-BWGxbpXO.js";import"./app-logo-icon-kT6HeMlV.js";import"./createSvgIcon-DkcSd2-O.js";import"./DefaultPropsProvider-DRRnqVYH.js";import"./useSlot-DErp_0ST.js";import"./TransitionGroupContext-nALX_Gj3.js";import"./useId-DQCmvY1A.js";import"./Select-D3mwh1vN.js";import"./isMuiElement-BJS3qdzF.js";import"./createSimplePaletteValueFilter-fPviOYGM.js";import"./index-Bw2APseq.js";import"./useSlotProps-BNWp3nnv.js";import"./List-NBjoO2Ug.js";import"./Typography-B8heRhDi.js";import"./ownerDocument-DW-IO8s5.js";import"./Modal-EvmVwdIL.js";import"./useTimeout--HoZvQIH.js";import"./Portal-dRwe7D2B.js";import"./Fade-CPmkmtx1.js";import"./debounce-Be36O1Ab.js";import"./Grow-BaQddceE.js";import"./useControlled-CkY63cvR.js";import"./ButtonBase-DRmvLRZN.js";import"./CircularProgress-D9k1A7p4.js";const Ne=()=>{const{informes:m,filters:w}=O().props,[I,M]=s.useState(w.search||""),[D,d]=s.useState(!1),[E,c]=s.useState(!1),[a,i]=s.useState(""),[x,p]=s.useState(null),[h,u]=s.useState([]),[_,g]=s.useState(""),A=t=>{confirm("¿Eliminar este informe?")&&o.delete(route("informes.destroy",t))},F=t=>{p(t),i(""),d(!0)},l=()=>{d(!1),p(null),i("")},T=()=>{!a||x===null||o.post(route("comentarios.store"),{contenido:a,informe_id:x},{onSuccess:()=>{l(),alert("Comentario agregado con éxito!")}})},k=t=>{u(t.comentarios??[]),g(t.titulo),c(!0)},j=()=>{u([]),g(""),c(!1)},L=t=>{M(t.target.value),o.get(route("informes.index"),{search:t.target.value},{preserveState:!0,replace:!0})};return e.jsx(B,{children:e.jsxs("div",{className:"mx-auto max-w-7xl px-6 py-10",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Listado de Informes"}),e.jsx(f,{href:route("informes.create"),className:"rounded bg-blue-600 px-4 py-2 font-semibold text-white transition hover:bg-blue-700",children:"Crear Informe"})]}),e.jsx("div",{className:"mb-6",children:e.jsx(y,{label:"Buscar informes...",variant:"outlined",size:"small",value:I,onChange:L,className:"w-64"})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:m.data.map(t=>{var r,b;return e.jsxs("div",{className:"bg-white shadow rounded-lg p-4 hover:shadow-lg transition",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx(W,{className:"text-yellow-500 text-3xl"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:t.titulo}),e.jsx("p",{className:"text-sm text-gray-500",children:((r=t.company)==null?void 0:r.name)??"Sin empresa"})]})]}),e.jsx("p",{className:"text-gray-600 mb-2",children:((b=t.descripcion)==null?void 0:b.substring(0,80))??"-"}),e.jsxs("p",{className:"text-xs text-gray-400 mb-2",children:["Estado: ",t.estado??"-"," | Inicio: ",t.fecha_inicio," | Fin: ",t.fecha_fin??"-"]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsx(f,{href:route("informes.edit",t.id),className:"px-2 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700",children:"Editar"}),e.jsx("button",{onClick:()=>A(t.id),className:"px-2 py-1 bg-red-600 text-white text-xs rounded hover:bg-red-700",children:"Eliminar"}),e.jsx("button",{onClick:()=>F(t.id),className:"px-2 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700",children:"Agregar Comentario"}),e.jsx("button",{onClick:()=>k(t),className:"px-2 py-1 bg-gray-600 text-white text-xs rounded hover:bg-gray-700",children:"Ver Comentarios"})]})]},t.id)})}),e.jsx("div",{className:"mt-6 flex justify-center space-x-2",children:m.links.map((t,r)=>e.jsx("button",{className:`px-3 py-1 rounded ${t.active?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`,disabled:!t.url,onClick:()=>t.url&&o.get(t.url,{},{preserveState:!0,replace:!0}),dangerouslySetInnerHTML:{__html:t.label}},r))}),e.jsxs(C,{open:D,onClose:l,children:[e.jsx(v,{children:"Agregar Comentario"}),e.jsx(N,{children:e.jsx(y,{label:"Comentario",fullWidth:!0,multiline:!0,rows:4,value:a,onChange:t=>i(t.target.value)})}),e.jsxs(S,{children:[e.jsx(n,{onClick:l,color:"secondary",children:"Cancelar"}),e.jsx(n,{onClick:T,variant:"contained",color:"primary",children:"Guardar"})]})]}),e.jsxs(C,{open:E,onClose:j,fullWidth:!0,maxWidth:"sm",children:[e.jsxs(v,{children:['Comentarios de "',_,'"']}),e.jsx(N,{dividers:!0,children:h.length>0?h.map(t=>{var r;return e.jsxs("div",{className:"mb-4 border-b border-gray-200 pb-2",children:[e.jsx("p",{className:"text-gray-800",children:t.contenido}),e.jsxs("p",{className:"text-xs text-gray-500",children:[((r=t.user)==null?void 0:r.name)??"Usuario"," - ",new Date(t.created_at).toLocaleString()]})]},t.id)}):e.jsx("p",{className:"text-gray-500",children:"No hay comentarios para este informe."})}),e.jsx(S,{children:e.jsx(n,{onClick:j,color:"primary",children:"Cerrar"})})]})]})})};export{Ne as default};
