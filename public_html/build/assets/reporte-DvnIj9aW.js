import{q as N,r as i,j as e,m as U}from"./app-DpimSwWW.js";import{A as q}from"./app-layout-D5OrI1FG.js";import{B as d}from"./Box-CcvOzitD.js";import{T as o,P as H}from"./Typography-KhbTzJKe.js";import{S as L}from"./Stack-CPeMGV6U.js";import{B as b}from"./Button-Wm0H3U4H.js";import{P as R}from"./PictureAsPdf-znQhwwzj.js";import{C as O}from"./Card-DPEhf4Im.js";import{C as J}from"./CardContent-DffKYiMG.js";import{F as k}from"./FilterList-DxFD9NUn.js";import{G as h}from"./Grid-CoUOdwyl.js";import{T as C}from"./TextField-pyf36G8w.js";import{I as v}from"./InputAdornment-DpmAzdgx.js";import{C as A}from"./CalendarToday-Clfc_oSO.js";import{F as K,I as Q,S as V}from"./Select-CnVUmuq6.js";import{M as _}from"./MenuItem-tKSb3dvZ.js";import{S as X}from"./Search-Ct1doS4x.js";import{T as Y}from"./TableContainer-B8F1Zvae.js";import{T as Z,a as ee,b as y,c as re}from"./TableRow-N8g30skt.js";import{T as a}from"./TableCell-DTOdW9i4.js";import{C as W}from"./Chip-CS0B1ph1.js";import{a as te}from"./TablePagination-Cpot48wk.js";import"./button-CFsyWUbq.js";import"./clsx-B-dksMZM.js";import"./avatar-CMLXmpAO.js";import"./createLucideIcon-D4CW-wHK.js";import"./index-CTw00F6I.js";import"./index-C0zh00gI.js";import"./index-VNCpVeP9.js";import"./settings-DlGdy5XP.js";import"./app-logo-icon-ZRykUD-a.js";import"./createSvgIcon-CzCXeKc2.js";import"./DefaultPropsProvider-DZDWfkmA.js";import"./createSimplePaletteValueFilter-CGtfMTWx.js";import"./useThemeProps-CLLhiJ1u.js";import"./getThemeProps-B8XpDgi_.js";import"./useId-B3TWxL2D.js";import"./ButtonBase-pmj5C_mX.js";import"./useTimeout-BOj4Dk7I.js";import"./TransitionGroupContext-eXL9qMo5.js";import"./CircularProgress-DtoVrIul.js";import"./isMuiElement-D4a5-yK2.js";import"./useSlot-wiR_y7XT.js";import"./index-DRp8ehcT.js";import"./useSlotProps-DEgqb-LW.js";import"./List-BgLYZ338.js";import"./ownerDocument-DW-IO8s5.js";import"./Modal-CR54Ot3q.js";import"./Portal-b9dgGZtC.js";import"./Fade-C4vPWcQd.js";import"./debounce-Be36O1Ab.js";import"./Grow-CQQAZfUW.js";import"./useControlled-BSzbgMqW.js";import"./listItemTextClasses-AIltRUCP.js";import"./dividerClasses-CuYbhpCd.js";import"./KeyboardArrowRight-CBQKr7hI.js";import"./LastPage-DzmpK5d8.js";import"./IconButton-BtLKT3mk.js";const oe=l=>{switch(l.toLowerCase()){case"alta":return"error";case"media":return"warning";case"baja":return"success";default:return"default"}},ae=l=>{switch(l.toLowerCase()){case"completado":return"success";case"en progreso":return"info";case"pendiente":return"warning";case"cancelado":return"error";default:return"default"}};function dr(){const{asignaciones:l,filters:g}=N().props,[u,P]=i.useState(g.fecha_inicio||""),[x,S]=i.useState(g.fecha_fin||""),[T,I]=i.useState(g.mes||""),[n,F]=i.useState(""),[f,j]=i.useState(0),[c,M]=i.useState(10),m=i.useMemo(()=>l.filter(r=>{var s,p;const t=n.toLowerCase();return r.user.name.toLowerCase().includes(t)||r.tarea.titulo.toLowerCase().includes(t)||r.tarea.prioridad.toLowerCase().includes(t)||((s=r.tarea.tipo)==null?void 0:s.nombre_tipo.toLowerCase().includes(t))||((p=r.tarea.company)==null?void 0:p.name.toLowerCase().includes(t))||r.estado.toLowerCase().includes(t)||r.detalle.toLowerCase().includes(t)}),[l,n]),w=i.useMemo(()=>m.slice(f*c,f*c+c),[m,f,c]),B=r=>{r.preventDefault(),U.get("/reportetareas",{fecha_inicio:u,fecha_fin:x,mes:T},{preserveState:!0,preserveScroll:!0})},D=()=>{const r=new URLSearchParams({fecha_inicio:u,fecha_fin:x}).toString();window.open(`/reportetareas/pdf?${r}`,"_blank")},$=()=>{const r=new URLSearchParams({fecha_inicio:u,fecha_fin:x}).toString();window.open(`/reportetareas/pdfmes?${r}`,"_blank")},E=(r,t)=>{j(t)},G=r=>{M(parseInt(r.target.value,10)),j(0)},z=()=>{P(""),S(""),I(""),F(""),j(0)};return e.jsx(q,{children:e.jsxs(d,{sx:{p:3},children:[e.jsxs(d,{sx:{mb:3},children:[e.jsx(o,{variant:"h4",component:"h1",gutterBottom:!0,fontWeight:"bold",children:"Reporte de Tareas Asignadas"}),e.jsx(o,{variant:"subtitle1",color:"text.secondary",children:"Gestiona y visualiza todas las asignaciones de tareas"})]}),e.jsxs(L,{direction:"row",spacing:2,sx:{mb:3},children:[e.jsx(b,{variant:"contained",color:"error",startIcon:e.jsx(R,{}),onClick:D,sx:{borderRadius:2},children:"Generar PDF"}),e.jsx(b,{variant:"contained",color:"primary",startIcon:e.jsx(R,{}),onClick:$,sx:{borderRadius:2},children:"Generar PDF Mensual"})]}),e.jsx(O,{sx:{mb:3,borderRadius:3,background:"linear-gradient(to right, #f0f4ff, #f9fbff)",boxShadow:3},children:e.jsxs(J,{children:[e.jsxs(d,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(k,{sx:{mr:1,color:"primary.main"}}),e.jsx(o,{variant:"h6",color:"primary",children:"Filtros"})]}),e.jsx(d,{component:"form",onSubmit:B,children:e.jsxs(h,{container:!0,spacing:3,alignItems:"flex-end",children:[e.jsx(h,{item:!0,xs:12,sm:6,md:3,children:e.jsx(C,{fullWidth:!0,type:"date",label:"Fecha Inicio",value:u,onChange:r=>P(r.target.value),InputLabelProps:{shrink:!0},InputProps:{startAdornment:e.jsx(v,{position:"start",children:e.jsx(A,{color:"primary"})})}})}),e.jsx(h,{item:!0,xs:12,sm:6,md:3,children:e.jsx(C,{fullWidth:!0,type:"date",label:"Fecha Fin",value:x,onChange:r=>S(r.target.value),InputLabelProps:{shrink:!0},InputProps:{startAdornment:e.jsx(v,{position:"start",children:e.jsx(A,{color:"primary"})})}})}),e.jsx(h,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(K,{fullWidth:!0,children:[e.jsx(Q,{children:"Mes"}),e.jsxs(V,{value:T,label:"Mes",onChange:r=>I(r.target.value),sx:{px:3,fontWeight:500,backgroundColor:"white",borderRadius:2},children:[e.jsx(_,{value:"",children:"-- Todos los meses --"}),Array.from({length:12},(r,t)=>e.jsx(_,{value:t+1,children:new Date(0,t).toLocaleString("es-ES",{month:"long"})},t+1))]})]})}),e.jsx(h,{item:!0,xs:12,sm:6,md:2,children:e.jsxs(L,{direction:"row",spacing:1,children:[e.jsx(b,{type:"submit",variant:"contained",color:"primary",startIcon:e.jsx(k,{}),fullWidth:!0,sx:{borderRadius:2},children:"Filtrar"}),e.jsx(b,{variant:"outlined",color:"secondary",onClick:z,fullWidth:!0,sx:{borderRadius:2},children:"Limpiar"})]})})]})})]})}),e.jsx(d,{sx:{mb:3},children:e.jsx(C,{fullWidth:!0,variant:"outlined",placeholder:"Buscar por usuario, tarea, prioridad, tipo, empresa, estado o detalle...",value:n,onChange:r=>{F(r.target.value),j(0)},InputProps:{startAdornment:e.jsx(v,{position:"start",children:e.jsx(X,{color:"action"})})},sx:{borderRadius:2}})}),e.jsx(d,{sx:{mb:2},children:e.jsxs(o,{variant:"body2",color:"text.secondary",children:["Mostrando ",w.length," de ",m.length," resultados",n&&` para "${n}"`]})}),e.jsxs(H,{sx:{borderRadius:2,overflow:"hidden",border:"1px solid",borderColor:"divider"},children:[e.jsx(Y,{children:e.jsxs(Z,{stickyHeader:!0,children:[e.jsx(ee,{children:e.jsx(y,{sx:{background:"linear-gradient(to right, #f9fafb, #ebf8ff)"},children:["Usuario","Tarea","Prioridad","Tipo","Empresa","Fecha Asignación","Estado","Detalle"].map(r=>e.jsx(a,{sx:{fontWeight:"bold",color:"grey.800",borderBottom:"2px solid",borderColor:"divider"},children:r},r))})}),e.jsx(re,{children:w.length===0?e.jsx(y,{children:e.jsx(a,{colSpan:8,align:"center",sx:{py:4},children:e.jsxs(o,{variant:"body1",color:"text.secondary",children:["No se encontraron asignaciones",n&&` que coincidan con "${n}"`]})})}):w.map((r,t)=>{var s,p;return e.jsxs(y,{sx:{backgroundColor:t%2===0?"white":"rgba(243, 244, 246, 0.5)","&:hover":{backgroundColor:"rgba(219, 234, 254, 0.5)"}},children:[e.jsxs(a,{children:[e.jsx(o,{variant:"body2",fontWeight:"medium",children:r.user.name}),e.jsx(o,{variant:"caption",color:"text.secondary",children:r.user.email})]}),e.jsx(a,{children:e.jsx(o,{variant:"body2",fontWeight:"medium",children:r.tarea.titulo})}),e.jsx(a,{children:e.jsx(W,{label:r.tarea.prioridad,color:oe(r.tarea.prioridad),size:"small",variant:"outlined"})}),e.jsx(a,{children:((s=r.tarea.tipo)==null?void 0:s.nombre_tipo)||"N/A"}),e.jsx(a,{children:((p=r.tarea.company)==null?void 0:p.name)||"N/A"}),e.jsx(a,{children:e.jsx(o,{variant:"body2",children:new Date(r.fecha).toLocaleDateString("es-ES")})}),e.jsx(a,{children:e.jsx(W,{label:r.estado,color:ae(r.estado),size:"small"})}),e.jsx(a,{children:e.jsx(o,{variant:"body2",sx:{maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:r.detalle,children:r.detalle})})]},r.id)})})]})}),m.length>0&&e.jsx(te,{component:"div",count:m.length,page:f,onPageChange:E,rowsPerPage:c,onRowsPerPageChange:G,rowsPerPageOptions:[5,10,25,50],labelRowsPerPage:"Filas por página:",labelDisplayedRows:({from:r,to:t,count:s})=>`${r}-${t} de ${s!==-1?s:`más de ${t}`}`,sx:{borderTop:"1px solid",borderColor:"divider",bgcolor:"grey.50"}})]})]})})}export{dr as default};
