import{r as i,j as e,$ as C,Y as E,m as g}from"./app-hmuC0z_W.js";import{A as z}from"./app-layout-tfxOdOKB.js";import"./button-BdWLbofJ.js";import"./clsx-B-dksMZM.js";import"./avatar-SH5xSAMo.js";import"./createLucideIcon-B2A0n4jm.js";import"./index-BeDZ4tg0.js";import"./index-B2CGEqEW.js";import"./index-CDmN9uZR.js";import"./settings-B81NYrWU.js";import"./app-logo-icon-DF-2vurZ.js";import"./createSvgIcon-DmtCSiy2.js";import"./DefaultPropsProvider-B9G9mrQg.js";function f({status:a,fieldName:p,value:u,onChange:x}){const r=a===u,l={pendiente:"bg-red-500 border-red-500",revision:"bg-yellow-500 border-yellow-500",completado:"bg-green-500 border-green-500"};return e.jsx("div",{className:`h-5 w-5 cursor-pointer rounded-full border-2 transition-colors duration-200 ${r?l[u]:"border-gray-400 bg-white"} `,onClick:()=>x(p,u)})}function A({tarea:a,usersProduccion:p,usersEdicion:u,empresaNombre:x}){const[r,l]=i.useState({titulo:a.titulo,fecha_produccion:a.fecha_produccion??"",fecha_nueva_produccion:a.fecha_nueva_produccion??"",razon_produccion:a.razon_produccion??"",estado_produccion:a.estado_produccion||"pendiente",user_produccion_id:a.user_produccion_id??null,fecha_edicion:a.fecha_edicion??"",fecha_nueva_edicion:a.fecha_nueva_edicion??"",razon_edicion:a.razon_edicion??"",estado_edicion:a.estado_edicion||"pendiente",user_edicion_id:a.user_edicion_id??null,fecha_entrega:a.fecha_entrega??"",fecha_nueva_entrega:a.fecha_nueva_entrega??"",razon_entrega:a.razon_entrega??"",estado_entrega:a.estado_entrega||"pendiente",estrategia:a.estrategia,comentario:a.comentario,guion:a.guion}),[v,j]=i.useState(!!a.fecha_nueva_produccion),[y,w]=i.useState(!!a.fecha_nueva_edicion),[N,S]=i.useState(!!a.fecha_nueva_entrega),h=(s,o)=>{const n={...r,[s]:o};l(n),g.patch(route("tareas.actualizar",a.id),n,{preserveScroll:!0,onError:()=>alert("Error al actualizar tarea")})},c=s=>{l({...r,[s.target.name]:s.target.value})},_=s=>{const o=s.target.value===""?null:Number(s.target.value),n={...r,[s.target.name]:o};l(n),g.patch(route("tareas.actualizar",a.id),n,{preserveScroll:!0,onError:()=>alert("Error al actualizar tarea")})},t=()=>{g.patch(route("tareas.actualizar",a.id),r,{preserveScroll:!0,onError:()=>alert("Error al actualizar tarea")})},b=r.estado_entrega==="completado"?"bg-green-100 text-green-800 border-2 border-emerald-500 shadow-md font-semibold":"hover:bg-gray-50",d="bg-blue-200 border-blue-400";return e.jsxs("tr",{className:`text-sm ${b}`,children:[e.jsx("td",{className:"border px-4 py-2 font-semibold",children:a.empresa?e.jsx(E,{href:route("empresas.seguimiento-tareas",a.empresa.id),className:"text-blue-600 hover:underline",children:x}):"Sin empresa"}),e.jsx("td",{className:"border px-4 py-2",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Título:"}),e.jsx("input",{name:"titulo",value:r.titulo,onChange:c,onBlur:t,className:"w-full rounded border px-2 py-1"}),e.jsx("label",{className:"text-xs text-gray-500",children:"Estrategia:"}),e.jsx("textarea",{name:"estrategia",value:r.estrategia,onChange:c,onBlur:t,className:"w-full rounded border px-2 py-1",rows:2})]})}),e.jsxs("td",{className:`border px-4 py-2 ${d}`,children:[e.jsx("input",{type:"date",name:"fecha_produccion",value:r.fecha_produccion,onChange:c,onBlur:t,className:"w-full rounded border px-2 py-1"}),!v&&!r.fecha_nueva_produccion?e.jsx("button",{onClick:()=>j(!0),className:"mt-2 text-blue-500 hover:text-blue-700",children:"➕ Agregar nueva fecha"}):e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Nueva Fecha:"}),e.jsx("input",{type:"date",name:"fecha_nueva_produccion",value:r.fecha_nueva_produccion??"",onChange:c,onBlur:t,className:"w-full rounded border px-2 py-1"}),e.jsx("label",{className:"text-xs text-gray-500",children:"Razón:"}),e.jsx("textarea",{name:"razon_produccion",value:r.razon_produccion??"",onChange:c,onBlur:t,className:"w-full rounded border px-2 py-1",rows:2})]})]}),e.jsx("td",{className:`border px-4 py-2 text-center ${d}`,children:e.jsx(f,{status:r.estado_produccion,fieldName:"estado_produccion",value:"pendiente",onChange:h})}),e.jsx("td",{className:`border px-4 py-2 text-center ${d}`,children:e.jsx(f,{status:r.estado_produccion,fieldName:"estado_produccion",value:"completado",onChange:h})}),e.jsxs("td",{className:`border px-4 py-2 ${d}`,children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Asignado:"}),e.jsxs("select",{name:"user_produccion_id",value:r.user_produccion_id??"",onChange:_,className:"w-full rounded border px-2 py-1",children:[e.jsx("option",{value:"",children:"Seleccionar"}),p.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsx("td",{className:"border px-4 py-2",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Comentario:"}),e.jsx("textarea",{name:"comentario",value:r.comentario,onChange:c,onBlur:t,className:"w-full rounded border px-2 py-1",rows:2}),e.jsx("label",{className:"text-xs text-gray-500",children:"Guión:"}),e.jsx("textarea",{name:"guion",value:r.guion,onChange:c,onBlur:t,className:"w-full rounded border px-2 py-1",rows:2})]})})]})}function H({tareas:a=[],usersProduccion:p,usersEdicion:u,mensaje:x,mes:r,anio:l}){var s;const[v,j]=i.useState(""),[y,w]=i.useState("1"),N=[{value:"01",label:"Enero"},{value:"02",label:"Febrero"},{value:"03",label:"Marzo"},{value:"04",label:"Abril"},{value:"05",label:"Mayo"},{value:"06",label:"Junio"},{value:"07",label:"Julio"},{value:"08",label:"Agosto"},{value:"09",label:"Septiembre"},{value:"10",label:"Octubre"},{value:"11",label:"Noviembre"},{value:"12",label:"Diciembre"}],[S,h]=i.useState(r),[c,_]=i.useState(l),t=(a??[]).reduce((o,n)=>{const m=n.semana??"0";return o[m]||(o[m]=[]),o[m].push(n),o},{}),b=Object.keys(t).filter(Boolean).map(Number).sort((o,n)=>o-n).map(String),d={writingMode:"vertical-rl",transform:"rotate(180deg)",height:"100px",width:"30px",padding:"0 4px",textAlign:"center",verticalAlign:"bottom"};return e.jsxs(z,{children:[e.jsx(C,{title:"Tareas de Seguimiento"}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-4 flex items-center justify-between border-b pb-4",children:e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:" Pendientes de Produccion de Hoy"})}),e.jsxs("div",{className:"mb-6 rounded-lg bg-gray-100 p-4 text-center text-xl font-bold text-gray-800 shadow-sm",children:[((s=N.find(o=>o.value===r))==null?void 0:s.label)??"Mes"," ",l]}),a.length===0?e.jsx("div",{className:"mb-6",children:e.jsx("h3",{children:"No hay tareas para este mes."})}):e.jsxs("div",{children:[e.jsx("h2",{className:"mb-4 text-xl font-semibold",children:"Tareas de Seguimiento"}),b.map(o=>e.jsxs("div",{className:"mb-8",children:[e.jsxs("h3",{className:"mb-2 text-lg font-bold text-blue-700",children:["Semana ",o]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full border border-gray-300 bg-white",children:[e.jsxs("thead",{className:"bg-gray-100",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Empresa"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Título/Estrategia"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Fecha Producción"}),e.jsx("th",{className:"border px-4 py-2",colSpan:2,children:"Estado Producción"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Usuario Producción"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Comentario/Guión"})]}),e.jsxs("tr",{children:[e.jsx("th",{className:"border bg-gray-200",style:d,children:"Pendiente"}),e.jsx("th",{className:"border bg-gray-200",style:d,children:"Completado"})]})]}),e.jsx("tbody",{children:Array.isArray(t[o])&&t[o].map(n=>{var m;return e.jsx(A,{tarea:n,usersProduccion:p,usersEdicion:u,empresaNombre:((m=n.empresa)==null?void 0:m.name)??"Sin empresa"},n.id)})})]})})]},o))]})]})]})}export{H as default};
