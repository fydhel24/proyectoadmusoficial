import{q as ee,r as h,v as E,m as I,j as e,$ as re}from"./app-BS78KgI9.js";import{A as te}from"./app-layout-DXAC2WAv.js";import{A as ie}from"./Add--ainIzPA.js";import{C as oe}from"./CheckCircle-DM2WBdfF.js";import{R as se,C as ae,a as ne}from"./react-confetti-oj1xg3dJ.js";import{E as le}from"./Edit-07f2nKEV.js";import{S as ce}from"./Search-0IMiUOv4.js";import{S as de}from"./Snackbar-DysO8TuN.js";import{A as pe}from"./Alert-B4Vyu2Ut.js";import{B as a}from"./Box-DUIKlT8z.js";import{T as o,P as me}from"./Typography-CcX01ihT.js";import{T as x}from"./TextField-CvGdJWCa.js";import{I as B}from"./InputAdornment-BT-QByY7.js";import{I as b}from"./IconButton-CZ7CUvid.js";import{B as T}from"./Button-DqXQBeNq.js";import{T as ue}from"./TableContainer-ChGTDe3P.js";import{T as he,a as xe,b as N,c as fe}from"./TableRow-HyuXIcfb.js";import{T as s}from"./TableCell-Bw8sPQev.js";import{T as q}from"./Tooltip-IWvH1ko8.js";import{G as ge}from"./index-B2_NhIyU.js";import{P as je}from"./Pagination-qzGW2WHO.js";import{M as be}from"./Modal-BH4F5tNL.js";import{G as c}from"./Grid-rYS9TwvK.js";import{F as D,I as L,S as G}from"./Select-9OsFqQh0.js";import{M as O}from"./MenuItem-D3GBDHMT.js";import"./button-oAFDZpeO.js";import"./clsx-B-dksMZM.js";import"./avatar-BWsYigjR.js";import"./createLucideIcon-D-6WHVmO.js";import"./index-Qic-rRyU.js";import"./index--gTV4hvx.js";import"./index-DBd0QHkk.js";import"./settings-DV0Bctrx.js";import"./app-logo-icon-GUvtkzgu.js";import"./createSvgIcon-12aY9Ngm.js";import"./DefaultPropsProvider-Dk6HDr1M.js";import"./useTimeout-oSTK7AfQ.js";import"./useSlot-DerHgNuN.js";import"./ClickAwayListener-VJqoF_b6.js";import"./Fade-FGt6R6vx.js";import"./Grow-CxMvSjLL.js";import"./Close-CzLUv769.js";import"./useId-DZf0Wwsg.js";import"./ButtonBase-DLk8W6EL.js";import"./CircularProgress-DHT395bS.js";import"./index-BZb61BhM.js";import"./useControlled-wSjlUgLl.js";import"./Popper-DnDfq_y6.js";import"./Portal-CCwm8dqL.js";import"./useSlotProps-Cf7xKLKx.js";import"./LastPage-CHCyyum-.js";import"./useThemeProps-hgA8uWgq.js";import"./getThemeProps--CMPU-9n.js";import"./isMuiElement-w8fP3KeW.js";import"./List-ctjg6MFH.js";import"./debounce-Be36O1Ab.js";import"./listItemTextClasses-CBB9ZnPp.js";import"./dividerClasses-893dsvZ6.js";const ve=["Sin exito","En proceso","Completado"],Ce={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600,bgcolor:"background.paper",boxShadow:24,p:4,borderRadius:"8px",maxHeight:"90vh",overflowY:"auto"},Ir=()=>{const{seguimientos:H,paquetes:f,auth:v,filters:m}=ee().props,d=H,[M,z]=h.useState(!1),[g,k]=h.useState(!1),[A,C]=h.useState(null),[n,w]=h.useState((m==null?void 0:m.search)||""),[F,S]=h.useState(!1),P=new Date().toISOString().slice(0,10),{data:p,setData:l,post:$,put:V,reset:R,processing:u,errors:t}=E({nombre_empresa:"",id_user:v.user.id,id_paquete:f.length>0?f[0].id:0,estado:"En proceso",fecha_inicio:P,fecha_fin:"",descripcion:"",celular:""}),{put:Y,processing:_}=E(),{put:J,processing:y}=E();h.useEffect(()=>{const r=setTimeout(()=>{n!==(m==null?void 0:m.search)&&I.get(route("seguimiento-empresa-vendedor.index"),{search:n},{preserveState:!0,preserveScroll:!0,replace:!0})},500);return()=>clearTimeout(r)},[n]);const W=r=>{r?(k(!0),C(r),l({nombre_empresa:r.nombre_empresa,id_user:r.id_user,id_paquete:r.id_paquete,estado:r.estado,fecha_inicio:r.fecha_inicio,fecha_fin:r.fecha_fin||"",descripcion:r.descripcion||"",celular:r.celular||""})):(k(!1),C(null),R(),l({nombre_empresa:"",id_user:v.user.id,id_paquete:f.length>0?f[0].id:0,estado:"En proceso",fecha_inicio:P,fecha_fin:"",descripcion:"",celular:""})),z(!0)},j=()=>{z(!1),C(null),R()},K=r=>{r.preventDefault(),g&&A?V(route("seguimiento-empresa-vendedor.update",A.id),{onSuccess:()=>{j()},onError:i=>{console.error("Error al actualizar:",i)}}):$(route("seguimiento-empresa-vendedor.store"),{onSuccess:()=>{j()},onError:i=>{console.error("Error al crear:",i)}})},Q=r=>{confirm("Â¿EstÃ¡s seguro de que deseas completar este contrato?")&&Y(route("seguimiento-empresa-vendedor.finalize",r.id),{onSuccess:()=>{S(!0)},onError:i=>{console.error("Error al finalizar:",i)}})},U=r=>{confirm("Â¿EstÃ¡s seguro de que deseas cancelar este empresa?")&&J(route("seguimiento-empresa-vendedor.cancel",r.id),{onSuccess:()=>{},onError:i=>{console.error("Error al cancelar:",i)}})},X=(r,i)=>{I.get(route("seguimiento-empresa-vendedor.index"),{page:i,search:n},{preserveState:!0,preserveScroll:!0})},Z=()=>{w(""),I.get(route("seguimiento-empresa-vendedor.index"),{},{preserveState:!0,preserveScroll:!0,replace:!0})};return e.jsxs(te,{user:v.user,header:e.jsx("h2",{className:"text-xl leading-tight font-semibold text-gray-800",children:"Seguimiento de Empresas"}),children:[e.jsx(re,{title:"Seguimiento de Empresas"}),F&&e.jsx(se,{width:window.innerWidth,height:window.innerHeight,numberOfPieces:300,recycle:!1}),e.jsx(de,{open:F,autoHideDuration:4e3,onClose:()=>S(!1),anchorOrigin:{vertical:"top",horizontal:"center"},children:e.jsx(pe,{elevation:6,variant:"filled",onClose:()=>S(!1),severity:"success",icon:e.jsx(ae,{fontSize:"inherit"}),sx:{fontSize:18,alignItems:"center"},children:"Â¡Felicidades! Has finalizado un contrato exitosamente ðŸŽ‰"})}),e.jsx("div",{children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2,bgcolor:"#f5f7fa",px:3,py:2,borderRadius:2,boxShadow:1,mb:2},children:[e.jsx("img",{src:"https://cdn-icons-png.flaticon.com/512/3135/3135715.png",alt:"Empresas",width:40,height:40,style:{borderRadius:"50%",background:"#fff",padding:4,boxShadow:"0 2px 8px #eee"}}),e.jsx(o,{variant:"h5",sx:{fontWeight:700,color:"#1a237e",letterSpacing:1,textShadow:"0 1px 2px #e3e3e3"},children:"Seguimiento de tus Empresas Activas"})]})}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsxs("div",{className:"overflow-hidden bg-white p-6 shadow-sm sm:rounded-lg",children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,gap:2},children:[e.jsx(x,{placeholder:"Buscar por empresa,celular o paquete...",value:n,onChange:r=>w(r.target.value),sx:{flexGrow:1,maxWidth:400},size:"small",InputProps:{startAdornment:e.jsx(B,{position:"start",children:e.jsx(ce,{})}),endAdornment:n&&e.jsx(B,{position:"end",children:e.jsx(b,{"aria-label":"limpiar bÃºsqueda",onClick:Z,edge:"end",size:"small",children:e.jsx(ne,{})})})}}),e.jsx(T,{variant:"contained",startIcon:e.jsx(ie,{}),onClick:()=>W(),children:"Agrega Nueva Empresa"})]}),e.jsx(a,{sx:{mb:2},children:e.jsxs(o,{variant:"body2",color:"text.secondary",children:["Mostrando ",d.data.length," de ",d.total," seguimientos",n&&` (filtrado por: "${n}")`]})}),e.jsx(ue,{component:me,children:e.jsxs(he,{sx:{minWidth:650},"aria-label":"simple table",children:[e.jsx(xe,{children:e.jsxs(N,{children:[e.jsx(s,{children:"Empresa"}),e.jsx(s,{children:"Paquete"}),e.jsx(s,{children:"Estado"}),e.jsx(s,{children:"Fecha Inicio"}),e.jsx(s,{children:"Celular"}),e.jsx(s,{children:"Acciones"})]})}),e.jsx(fe,{children:d.data.map(r=>{var i;return e.jsxs(N,{children:[e.jsx(s,{children:e.jsxs(a,{children:[e.jsx(o,{variant:"body2",fontWeight:"medium",children:r.nombre_empresa}),r.descripcion&&e.jsx(o,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:.5},children:r.descripcion.length>50?`${r.descripcion.substring(0,50)}...`:r.descripcion})]})}),e.jsx(s,{children:(i=r.paquete)==null?void 0:i.nombre_paquete}),e.jsx(s,{children:e.jsxs(a,{sx:{width:120,height:18,position:"relative",display:"flex",alignItems:"center"},children:[e.jsx(a,{sx:{width:"50%",height:"100%",bgcolor:"#ff9800",borderTopLeftRadius:9,borderBottomLeftRadius:9,display:"inline-block",transition:"background 0.3s"}}),e.jsx(a,{sx:{width:"50%",height:"100%",bgcolor:"#e0e0e0",borderTopRightRadius:9,borderBottomRightRadius:9,display:"inline-block"}}),e.jsx(o,{variant:"caption",sx:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",color:"#333",fontWeight:"bold",fontSize:12,width:"100%",textAlign:"center",pointerEvents:"none"},children:"En proceso"})]})}),e.jsx(s,{children:r.fecha_inicio}),e.jsx(s,{children:r.celular||"N/A"}),e.jsxs(s,{children:[r.estado!=="Completado"&&r.estado!=="Sin exito"&&e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Editar",children:e.jsx(b,{color:"primary",onClick:()=>W(r),disabled:u||_||y,size:"small",children:e.jsx(le,{})})}),e.jsx(q,{title:"Finalizar",children:e.jsx(b,{color:"success",onClick:()=>Q(r),disabled:u||_||y,size:"small",children:e.jsx(oe,{})})}),e.jsx(q,{title:"Cancelar",children:e.jsx(b,{color:"error",onClick:()=>U(r),disabled:u||_||y,size:"small",children:e.jsx(ge,{})})})]}),r.estado==="Sin exito"&&e.jsx(o,{variant:"body2",color:"text.secondary",children:"Cancelado"}),r.estado==="Completado"&&e.jsx(o,{variant:"body2",color:"success.main",children:"Completado"})]})]},r.id)})})]})}),d.data.length===0&&e.jsxs(a,{sx:{textAlign:"center",py:4},children:[e.jsx(o,{variant:"h6",color:"text.secondary",children:n?"No se encontraron seguimientos":"No hay seguimientos registrados"}),e.jsx(o,{variant:"body2",color:"text.secondary",children:n?"Intenta con diferentes tÃ©rminos de bÃºsqueda":'Crea tu primer seguimiento haciendo clic en "Nuevo Seguimiento"'})]}),d.last_page>1&&e.jsx(a,{sx:{display:"flex",justifyContent:"center",mt:3},children:e.jsx(je,{count:d.last_page,page:d.current_page,onChange:X,color:"primary",showFirstButton:!0,showLastButton:!0})})]})})}),e.jsx(be,{open:M,onClose:j,children:e.jsxs(a,{sx:Ce,component:"form",onSubmit:K,children:[e.jsx(o,{variant:"h6",component:"h2",mb:2,children:g?"Editar Seguimiento":"Crear Seguimiento"}),e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{item:!0,xs:12,children:e.jsx(x,{fullWidth:!0,label:"Nombre de Empresa",value:p.nombre_empresa,onChange:r=>l("nombre_empresa",r.target.value),required:!0,error:!!t.nombre_empresa,helperText:t.nombre_empresa})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(x,{fullWidth:!0,label:"Celular",value:p.celular,onChange:r=>l("celular",r.target.value),placeholder:"Ej: +591 70000000",error:!!t.celular,helperText:t.celular})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(D,{fullWidth:!0,required:!0,error:!!t.id_paquete,children:[e.jsx(L,{children:"Paquete"}),e.jsx(G,{value:p.id_paquete,label:"Paquete",onChange:r=>l("id_paquete",r.target.value),children:f.map(r=>e.jsx(O,{value:r.id,children:r.nombre_paquete},r.id))}),t.id_paquete&&e.jsx(o,{variant:"caption",color:"error",sx:{mt:.5,ml:1.5},children:t.id_paquete})]})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(D,{fullWidth:!0,required:!0,error:!!t.estado,children:[e.jsx(L,{children:"Estado"}),e.jsx(G,{value:p.estado,label:"Estado",onChange:r=>l("estado",r.target.value),children:ve.map(r=>e.jsx(O,{value:r,children:r},r))}),t.estado&&e.jsx(o,{variant:"caption",color:"error",sx:{mt:.5,ml:1.5},children:t.estado})]})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(x,{fullWidth:!0,label:"Fecha de Inicio",type:"date",value:p.fecha_inicio,onChange:r=>l("fecha_inicio",r.target.value),InputLabelProps:{shrink:!0},required:!0,error:!!t.fecha_inicio,helperText:t.fecha_inicio})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(x,{fullWidth:!0,label:"DescripciÃ³n",multiline:!0,rows:4,value:p.descripcion,onChange:r=>l("descripcion",r.target.value),placeholder:"Describe detalles del seguimiento, contactos, notas importantes...",error:!!t.descripcion,helperText:t.descripcion})}),g&&e.jsx(c,{item:!0,xs:12,children:e.jsx(x,{fullWidth:!0,label:"Fecha de Fin",type:"date",value:p.fecha_fin,onChange:r=>l("fecha_fin",r.target.value),InputLabelProps:{shrink:!0},error:!!t.fecha_fin,helperText:t.fecha_fin||"Solo completar si el seguimiento ya ha finalizado"})})]}),e.jsxs(a,{sx:{display:"flex",justifyContent:"flex-end",mt:3,gap:1},children:[e.jsx(T,{onClick:j,variant:"outlined",disabled:u,children:"Cancelar"}),e.jsx(T,{type:"submit",variant:"contained",disabled:u,children:u?"Procesando...":g?"Guardar Cambios":"Crear"})]})]})})]})};export{Ir as default};
