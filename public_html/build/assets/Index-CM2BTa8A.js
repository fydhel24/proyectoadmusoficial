import{j as e,r as t,$ as ee,a as h}from"./app-DpimSwWW.js";import{A as re,P as L}from"./app-layout-D5OrI1FG.js";import{B as i}from"./Box-CcvOzitD.js";import{T as s}from"./Typography-KhbTzJKe.js";import{c as N}from"./createSvgIcon-CzCXeKc2.js";import{D as B}from"./Divider-Bo-LvM2u.js";import{S as u}from"./Stack-CPeMGV6U.js";import{G as b}from"./Grow-CQQAZfUW.js";import{C as oe}from"./Chip-CS0B1ph1.js";import{I as O}from"./IconButton-BtLKT3mk.js";import{D as te}from"./Delete-H3bfBGYi.js";import{B as c}from"./Button-Wm0H3U4H.js";import{A as ie}from"./Add-ClPA2Rx3.js";import{M as E}from"./Modal-CR54Ot3q.js";import{T as y}from"./TextField-pyf36G8w.js";import{I as se}from"./InputAdornment-DpmAzdgx.js";import{S as ae}from"./Search-Ct1doS4x.js";import{G as P}from"./Grid-CoUOdwyl.js";import{C as ne}from"./Card-DPEhf4Im.js";import{C as le}from"./CardContent-DffKYiMG.js";import{A as G}from"./Avatar-Cs6vm9Gc.js";import{C as ce}from"./CardActions-CS4azOKZ.js";import{C as pe}from"./Close-DVzdr6ZP.js";import{C as D}from"./CircularProgress-DtoVrIul.js";import{A as de}from"./Autocomplete-D54W1GUQ.js";import{T as me}from"./Tooltip-CNe8VwL7.js";import{S as xe}from"./Snackbar-DeXY7UjR.js";import{A as he}from"./Alert-DsV2HJEG.js";import"./button-CFsyWUbq.js";import"./clsx-B-dksMZM.js";import"./avatar-CMLXmpAO.js";import"./createLucideIcon-D4CW-wHK.js";import"./index-CTw00F6I.js";import"./index-C0zh00gI.js";import"./index-VNCpVeP9.js";import"./settings-DlGdy5XP.js";import"./app-logo-icon-ZRykUD-a.js";import"./DefaultPropsProvider-DZDWfkmA.js";import"./createSimplePaletteValueFilter-CGtfMTWx.js";import"./dividerClasses-CuYbhpCd.js";import"./useThemeProps-CLLhiJ1u.js";import"./getThemeProps-B8XpDgi_.js";import"./Fade-C4vPWcQd.js";import"./TransitionGroupContext-eXL9qMo5.js";import"./useTimeout-BOj4Dk7I.js";import"./useSlot-wiR_y7XT.js";import"./ButtonBase-pmj5C_mX.js";import"./useId-B3TWxL2D.js";import"./ownerDocument-DW-IO8s5.js";import"./Portal-b9dgGZtC.js";import"./Select-CnVUmuq6.js";import"./isMuiElement-D4a5-yK2.js";import"./index-DRp8ehcT.js";import"./useSlotProps-DEgqb-LW.js";import"./List-BgLYZ338.js";import"./debounce-Be36O1Ab.js";import"./useControlled-BSzbgMqW.js";import"./Close-CdnP-DZi.js";import"./usePreviousProps-PSJo3fV-.js";import"./Popper-Rflxgs1J.js";import"./ClickAwayListener-D7CbGVqV.js";const C=N(e.jsx("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m0 4c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3m6 12H6v-1.4c0-2 4-3.1 6-3.1s6 1.1 6 3.1z"})),v=N(e.jsx("path",{d:"M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12z"}));function vr({users:_,tipos:$}){const[f,F]=t.useState(""),[H,S]=t.useState(!1),[q,T]=t.useState(!1),[p,w]=t.useState(""),[d,A]=t.useState($),[n,W]=t.useState(null),[m,x]=t.useState([]),[Q,k]=t.useState(!1),[I,z]=t.useState(!1),[g,a]=t.useState({open:!1,message:"",severity:"success"}),V=_.filter(r=>r.name.toLowerCase().includes(f.toLowerCase())||r.email.toLowerCase().includes(f.toLowerCase())),J=()=>S(!0),M=()=>{S(!1),w("")},K=async()=>{if(p.trim())try{const r=await h.post("/tipos",{nombre_tipo:p});A(o=>[...o,r.data.tipo]),a({open:!0,message:"Tipo creado con éxito",severity:"success"}),M()}catch{a({open:!0,message:"Error al crear tipo",severity:"error"})}},X=async r=>{W(r),k(!0);try{const o=await h.get(`/tipos/${r.id}/tipos`);x(o.data.map(l=>l.id))}catch{x([])}k(!1),T(!0)},j=()=>{T(!1),W(null),x([])},R=r=>{x(o=>o.includes(r)?o.filter(l=>l!==r):[...o,r])},Y=async()=>{if(n){z(!0);try{await h.put(`/tipos/${n.id}/tipos`,{tipos:m}),a({open:!0,message:"Tipos actualizados",severity:"success"}),j()}catch{a({open:!0,message:"Error al actualizar tipos",severity:"error"})}z(!1)}},U=["primary","secondary","success","error","warning","info"],Z=async r=>{if(window.confirm("¿Seguro que deseas eliminar este tipo?"))try{await h.delete(`/tipos/${r}`),A(o=>o.filter(l=>l.id!==r)),a({open:!0,message:"Tipo eliminado con éxito",severity:"success"})}catch{a({open:!0,message:"Error al eliminar tipo",severity:"error"})}};return e.jsxs(re,{breadcrumbs:[{title:"Tipos",href:"/tipos"}],children:[e.jsx(ee,{title:"Tipos"}),e.jsxs(i,{sx:{mb:4},children:[e.jsxs(s,{variant:"h4",fontWeight:700,gutterBottom:!0,color:"primary.main",sx:{letterSpacing:1},children:[e.jsx(C,{sx:{mr:1,verticalAlign:"middle",fontSize:36}}),"Gestión de Personal"]}),e.jsx(B,{sx:{mb:2}}),e.jsx(u,{direction:"row",spacing:2,alignItems:"center",flexWrap:"wrap",sx:{mb:2,gap:2},children:d.map((r,o)=>e.jsx(b,{in:!0,timeout:400+o*80,children:e.jsxs(i,{display:"flex",alignItems:"center",children:[e.jsx(oe,{icon:e.jsx(v,{}),label:r.nombre_tipo,color:U[o%U.length],sx:{fontWeight:500,fontSize:15,borderRadius:2,boxShadow:2,px:2,py:1,mb:1}}),e.jsx(O,{"aria-label":"Eliminar tipo",color:"error",size:"small",onClick:()=>Z(r.id),sx:{ml:1},children:e.jsx(te,{})})]})},r.id))}),e.jsx(c,{variant:"contained",color:"primary",startIcon:e.jsx(ie,{}),onClick:J,sx:{ml:1,height:40,borderRadius:2,boxShadow:2,fontWeight:600,textTransform:"none"},children:"Nuevo Tipo"})]}),e.jsx(E,{open:H,onClose:M,closeAfterTransition:!0,BackdropProps:{timeout:500},children:e.jsxs(i,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",borderRadius:4,boxShadow:24,p:4,outline:"none"},children:[e.jsxs(s,{variant:"h6",fontWeight:700,gutterBottom:!0,color:"primary.main",children:[e.jsx(v,{sx:{mr:1,verticalAlign:"middle"}}),"Crear Nuevo Tipo"]}),e.jsx(y,{label:"Nombre del Tipo",variant:"outlined",fullWidth:!0,value:p,onChange:r=>w(r.target.value),sx:{mb:3}}),e.jsx(c,{variant:"contained",color:"primary",fullWidth:!0,onClick:K,disabled:!p.trim(),sx:{borderRadius:2,fontWeight:600},children:"Crear"})]})}),e.jsx(y,{label:"Buscar Personl",variant:"outlined",fullWidth:!0,value:f,onChange:r=>F(r.target.value),InputProps:{endAdornment:e.jsx(se,{position:"end",children:e.jsx(ae,{})})},sx:{mb:4,borderRadius:2,boxShadow:1}}),e.jsx(P,{container:!0,spacing:4,children:V.map((r,o)=>e.jsx(b,{in:!0,timeout:400+o*80,children:e.jsx(P,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(ne,{elevation:6,sx:{borderRadius:4,boxShadow:6,transition:"transform 0.2s","&:hover":{transform:"scale(1.025)",boxShadow:12},mb:2,bgcolor:"background.paper"},children:[e.jsx(le,{children:e.jsxs(u,{direction:"row",spacing:2,alignItems:"center",sx:{mb:1},children:[e.jsx(G,{sx:{bgcolor:"primary.main",width:48,height:48,fontWeight:700,fontSize:22,boxShadow:2},children:e.jsx(L,{fontSize:"large"})}),e.jsxs(i,{children:[e.jsx(s,{variant:"h6",fontWeight:700,color:"text.primary",children:r.name}),e.jsx(s,{variant:"body2",color:"text.secondary",children:r.email})]})]})}),e.jsx(ce,{sx:{pt:0},children:e.jsx(c,{variant:"outlined",color:"primary",onClick:()=>X(r),fullWidth:!0,sx:{borderRadius:2,fontWeight:600,textTransform:"none",py:1,letterSpacing:.5},startIcon:e.jsx(C,{}),children:"Gestionar Tipos"})})]})})},r.id))}),e.jsx(E,{open:q,onClose:j,closeAfterTransition:!0,BackdropProps:{timeout:500},children:e.jsxs(i,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:440,bgcolor:"background.paper",borderRadius:4,boxShadow:24,p:4,outline:"none"},children:[e.jsxs(i,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:[e.jsxs(s,{variant:"h6",fontWeight:700,color:"primary.main",children:[e.jsx(L,{sx:{mr:1,verticalAlign:"middle"}}),"Tipos de ",n==null?void 0:n.name]}),e.jsx(O,{onClick:j,children:e.jsx(pe,{})})]}),Q?e.jsx(i,{display:"flex",justifyContent:"center",py:4,children:e.jsx(D,{})}):e.jsxs(e.Fragment,{children:[e.jsx(de,{options:d.filter(r=>!m.includes(r.id)),getOptionLabel:r=>r.nombre_tipo,renderInput:r=>e.jsx(y,{...r,label:"Agregar tipo",variant:"outlined"}),renderOption:(r,o)=>t.createElement("li",{...r,key:o.id},o.nombre_tipo),onChange:(r,o)=>{o&&R(o.id)},sx:{mb:3},isOptionEqualToValue:(r,o)=>r.id===o.id,noOptionsText:"No hay tipos para agregar"}),e.jsx(B,{sx:{mb:2}}),e.jsx(s,{variant:"subtitle1",fontWeight:700,sx:{mb:1},children:"Tipos asignados"}),e.jsxs(u,{spacing:1,sx:{mb:2},children:[d.filter(r=>m.includes(r.id)).map((r,o)=>e.jsx(b,{in:!0,timeout:400+o*60,children:e.jsxs(i,{display:"flex",alignItems:"center",justifyContent:"space-between",sx:{border:"1px solid",borderColor:"primary.light",borderRadius:2,px:2,py:1,bgcolor:"primary.50",boxShadow:1},children:[e.jsxs(u,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(G,{sx:{bgcolor:"primary.light",width:32,height:32,fontSize:18},children:e.jsx(v,{fontSize:"small"})}),e.jsx(s,{fontWeight:600,children:r.nombre_tipo})]}),e.jsx(me,{title:"Quitar tipo",children:e.jsx(c,{variant:"contained",color:"error",size:"small",onClick:()=>R(r.id),sx:{borderRadius:2,fontWeight:600},children:"Quitar"})})]})},r.id)),d.filter(r=>m.includes(r.id)).length===0&&e.jsx(s,{variant:"body2",color:"text.secondary",align:"center",children:"No hay tipos asignados."})]}),e.jsx(c,{variant:"contained",color:"primary",onClick:Y,disabled:I,fullWidth:!0,sx:{borderRadius:2,fontWeight:700,py:1.2,fontSize:16},startIcon:e.jsx(C,{}),children:I?e.jsx(D,{size:24}):"Guardar Cambios"})]})]})}),e.jsx(xe,{open:g.open,autoHideDuration:3e3,onClose:()=>a(r=>({...r,open:!1})),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(he,{severity:g.severity,variant:"filled",sx:{width:"100%"},children:g.message})})]})}export{vr as default};
