import{r as s,a as b,j as e,$ as me}from"./app-YEuHkux5.js";import{A as he,d as je,e as ge,c as ar,B as ir}from"./app-layout-Dh5sl-jU.js";import{l as be}from"./lodash-BHO6nJhN.js";import{u as tr,T as m,P as fe}from"./Typography-D8rBbavg.js";import{u as sr}from"./index-DXV3AoGs.js";import{C as ee}from"./Container-BdiSP8k6.js";import{S as ve}from"./Skeleton-CZo0iYFA.js";import{G as l}from"./Grid-CZ5Gk029.js";import{B as o}from"./Box-DZXJg_qv.js";import{F as re}from"./Fade-pc_dseJo.js";import{B as f}from"./Button-CMjaMz42.js";import{A as ae}from"./Add-DFr0aPth.js";import{S as or}from"./Slide-i9-6EFpb.js";import{A as lr}from"./Alert-M1Fv6YQG.js";import{S as nr}from"./Stack-DH4x_kPu.js";import{T as p}from"./TextField-CpThoci2.js";import{I as dr}from"./InputAdornment-t3XbOCFs.js";import{S as cr}from"./Search-Cu_J7Bp9.js";import{A as C}from"./Autocomplete-0sF2mYdL.js";import{Z as ie}from"./Zoom-CcpNAuSC.js";import{C as N}from"./Card-DmMu79y6.js";import{F as S,a as T,I as pr,S as ur}from"./Select-B_eRVbu_.js";import{R as E,a as u}from"./RadioGroup-CLDqlfLd.js";import{F as x}from"./FormControlLabel-4W3to2qB.js";import{C as ye}from"./Cancel-C43fUWRj.js";import{S as Ce}from"./Save-owSNR_wn.js";import{A as xr}from"./Avatar-JivPr5ws.js";import{I as D}from"./IconButton-DepEmupO.js";import{C as Se}from"./Collapse-ovmvXDJ4.js";import{C as L}from"./Chip-D0HSmcM1.js";import{C as mr}from"./CalendarToday-AqIyqL2V.js";import{T as we}from"./Tooltip-MqpFe2zP.js";import{E as hr}from"./Edit-DJy-qXX3.js";import{S as jr}from"./SwapHoriz-CmfrH_ih.js";import{M as gr}from"./MenuItem-EZI4tQJZ.js";import{F as br}from"./Fab-CwgDeW5T.js";import{a as y}from"./DefaultPropsProvider-CEXgxhq8.js";import"./button-_5e2JbJM.js";import"./clsx-B-dksMZM.js";import"./avatar-DPKp3hQk.js";import"./createLucideIcon-9JrBpBfL.js";import"./index-D3g71isE.js";import"./index-B2kdsAU2.js";import"./index-m3ZdHyWT.js";import"./settings-d7GkTK56.js";import"./app-logo-icon-BYryv9rn.js";import"./createSvgIcon-Bv7lX4UF.js";import"./createSimplePaletteValueFilter-J_8iZNoO.js";import"./getThemeProps-BO29yZBp.js";import"./useTimeout-g4Ibx1fA.js";import"./useThemeProps-B1feN13w.js";import"./isMuiElement-C40F-WzM.js";import"./TransitionGroupContext-mQf08jKB.js";import"./useId-DF1cwINX.js";import"./ButtonBase-CS4YXIYb.js";import"./CircularProgress-Bn3EXqD5.js";import"./debounce-Be36O1Ab.js";import"./Modal-B5zRzlCf.js";import"./ownerDocument-DW-IO8s5.js";import"./useSlot-q3G4gJ7a.js";import"./Portal-1gL4VHaW.js";import"./Close-B3-jeOLy.js";import"./useControlled-CZTOPfKL.js";import"./usePreviousProps-CyLAMf6c.js";import"./Popper-CBS_IXcw.js";import"./index-CyVCCTxO.js";import"./useSlotProps-BXV3urdk.js";import"./List-2At25vZV.js";import"./Grow-J0HjpUkY.js";import"./SwitchBase-D256AbvG.js";import"./FormGroup-DCX4qUwH.js";import"./listItemTextClasses-B6w7MOm2.js";import"./dividerClasses-Df44jC95.js";function La(){const[k,Ee]=s.useState([]),[W,ke]=s.useState([]),[F,_e]=s.useState([]),[O,Te]=s.useState([]),[We,te]=s.useState(!0),[U,v]=s.useState(null),[I,Fe]=s.useState(""),[z,Ie]=s.useState(""),[A,ze]=s.useState(""),[se,B]=s.useState(!1),[n,j]=s.useState({titulo:"",prioridad:"",descripcion:"",empresa:"",fecha:"",tipo_id:"",company_id:""}),[_,M]=s.useState("aleatoria"),[$,H]=s.useState(""),[oe,G]=s.useState("no"),[q,Z]=s.useState(null),[d,g]=s.useState({titulo:"",prioridad:"",descripcion:"",empresa:"",fecha:"",tipo_id:"",company_id:""}),[le,K]=s.useState("no"),[Ae,Q]=s.useState(null),[R,J]=s.useState(null),[ne,de]=s.useState({}),[ce,Re]=s.useState({}),[Pe,w]=s.useState({}),[Ne,X]=s.useState(null),[De,pe]=s.useState(""),Le=tr();sr(Le.breakpoints.down("sm"));const h=s.useCallback(async()=>{te(!0),v(null);try{const[r,a,t,i]=await Promise.all([b.get("/tareas-con-asignaciones"),b.get("/api/tipos"),b.get("/api/companies"),b.get("/api/pasantes")]);Ee(r.data),ke(a.data),_e(t.data),Te(i.data.data)}catch(r){console.error("Error al cargar datos:",r),v("Hubo un error al cargar los datos. Por favor, intenta de nuevo.")}finally{te(!1)}},[]),Oe=s.useCallback(async(r,a)=>{w(t=>({...t,[r]:!0}));try{await b.patch(`/asignaciones/${r}`,{estado:a}),await h()}catch(t){console.error("Error al actualizar estado:",t),v("No se pudo actualizar el estado")}finally{w(t=>({...t,[r]:!1}))}},[h]),Ue=s.useCallback(be.debounce(async(r,a)=>{w(t=>({...t,[r]:!0}));try{await b.patch(`/asignaciones/${r}`,{detalle:a}),await h()}catch(t){console.error("Error al actualizar detalle:",t),v("No se pudo actualizar el detalle")}finally{w(t=>({...t,[r]:!1}))}},1e3),[h]),Be=s.useCallback(be.debounce(async(r,a)=>{w(t=>({...t,[r]:!0}));try{await b.patch(`/tareas/${r}/descripcion`,{descripcion:a}),await h(),X(null)}catch(t){console.error("Error al actualizar descripci√≥n:",t),v("No se pudo actualizar la descripci√≥n")}finally{w(t=>({...t,[r]:!1}))}},1e3),[h]),ue=s.useMemo(()=>{const r=new Date().toISOString().split("T")[0];let a=k.filter(t=>t.fecha===r);return I&&(a=a.filter(t=>t.titulo.toLowerCase().includes(I.toLowerCase()))),A&&(a=a.filter(t=>t.prioridad===A)),z&&(a=a.filter(t=>t.asignados.some(i=>i.user_name===z))),a},[k,I,A,z]),P=s.useMemo(()=>{const r={};return ue.forEach(a=>{a.asignados.forEach(t=>{const i=t.user_name;r[i]||(r[i]=[]),r[i].push(a)})}),r},[ue]),Me=s.useMemo(()=>{const r=new Set;return k.forEach(a=>{a.asignados.forEach(t=>{r.add(t.user_name)})}),Array.from(r).sort()},[k]);s.useEffect(()=>{h()},[h]),s.useEffect(()=>{const r={};Object.keys(P).forEach(a=>{r[a]=!0}),de(r)},[P]);const $e=r=>{de(a=>({...a,[r]:!a[r]}))},He=r=>{Re(a=>({...a,[r]:!a[r]}))},Ge=r=>{var a,t;Z(r.id),g({titulo:r.titulo,prioridad:r.prioridad,descripcion:r.descripcion,empresa:r.empresa,fecha:r.fecha,tipo_id:(a=r.tipo)!=null&&a.id?String(r.tipo.id):"",company_id:(t=r.company)!=null&&t.id?String(r.company.id):""}),K(r.company?"si":"no")},qe=()=>{Z(null),g({titulo:"",prioridad:"",descripcion:"",empresa:"",fecha:"",tipo_id:"",company_id:""}),K("no")},Ze=async()=>{if(d.titulo.trim())try{const r={...d,tipo_id:d.tipo_id?Number(d.tipo_id):null,company_id:d.company_id?Number(d.company_id):null};await b.put(`/tareas/${q}`,r),Z(null),h()}catch(r){console.error("Error al actualizar tarea:",r),v("Error al actualizar la tarea")}},Y=()=>{B(!0),j({titulo:"",prioridad:"",descripcion:"",empresa:"",fecha:new Date().toISOString().split("T")[0],tipo_id:"",company_id:""}),G("no")},Ke=()=>{B(!1),j({titulo:"",prioridad:"",descripcion:"",empresa:"",fecha:"",tipo_id:"",company_id:""}),G("no"),M("aleatoria"),H("")},Qe=async()=>{if(n.titulo.trim())try{const r={...n,tipo_id:n.tipo_id?Number(n.tipo_id):null,company_id:n.company_id?Number(n.company_id):null,asignacion_aleatoria:_==="aleatoria",pasante_id:_==="manual"?Number($):null};console.log("üü¶ Payload que se env√≠a al backend:",r),await b.post("/create/tareas",r),B(!1),h(),M("aleatoria"),H("")}catch(r){console.error("Error al crear tarea:",r),v("Error al crear la tarea")}},Je=async r=>{if(R)try{const a=k.find(i=>i.id===r);if(!a||!a.asignados.length)return;const t=a.asignados[0].id;await b.delete(`/asignaciones/reasignar/${t}`,{data:{user_id:R}}).then(i=>{console.log(i.data.message)}).catch(i=>{console.error("Error al reasignar:",i)}),Q(null),J(null),h()}catch(a){console.error("Error al cambiar editor:",a),v("Error al cambiar el editor")}},Xe=r=>{X(r.id),pe(r.descripcion||"")},xe=r=>{switch(r.toLowerCase()){case"alta":return"#FF1744";case"media":return"#FF9100";case"baja":return"#00E676";default:return"#9E9E9E"}},Ye=r=>{const a=["#1976d2","#1565c0","#0d47a1","#2196f3","#0288d1","#01579b","#03a9f4","#00b0ff","#0091ea","#3f51b5"],t=r.charCodeAt(0)%a.length;return a[t]},Ve=r=>r.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2),er=`
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    `;return We?e.jsxs(he,{breadcrumbs:[{title:"Tareas",href:"/tareas"}],children:[e.jsx(me,{title:"Tareas"}),e.jsxs(ee,{maxWidth:"xl",sx:{py:4},children:[e.jsx(ve,{variant:"rectangular",height:60,sx:{mb:2,borderRadius:1}}),e.jsx(l,{container:!0,spacing:2,children:[...Array(7)].map((r,a)=>e.jsx(l,{item:!0,xs:12,sm:6,md:!0,children:e.jsx(ve,{variant:"rectangular",height:400,sx:{borderRadius:2}})},a))})]})]}):e.jsxs(he,{breadcrumbs:[{title:"Tareas",href:"/tareas"}],children:[e.jsx(me,{title:"Tareas"}),e.jsx("style",{children:er}),e.jsx(o,{sx:{background:"linear-gradient(135deg, #1976d2 0%, #0d47a1 100%)",color:"white",py:3,position:"relative",overflow:"hidden"},children:e.jsx(ee,{maxWidth:"xl",sx:{position:"relative",zIndex:1},children:e.jsx(re,{in:!0,timeout:800,children:e.jsxs(o,{children:[e.jsx(m,{variant:"h4",fontWeight:"bold",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:"üìÖ Tareas de Hoy"}),e.jsx(m,{variant:"subtitle1",sx:{opacity:.9},children:"Gestiona y edita tus tareas del d√≠a de manera eficiente"}),e.jsxs(o,{sx:{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap"},children:[e.jsx(o,{sx:{flexGrow:1}}),e.jsx(o,{sx:{display:"flex",gap:1},children:e.jsx(f,{variant:"contained",onClick:Y,startIcon:e.jsx(ae,{}),sx:{borderRadius:2,background:"linear-gradient(45deg, #1976d2 0%, #0d47a1 100%)","&:hover":{background:"linear-gradient(45deg, #1565c0 0%, #0a3880 100%)"},px:3,py:1},children:"Nueva Tarea Para Hoy"})})]})]})})})}),e.jsxs(ee,{maxWidth:"xl",sx:{py:3},children:[U&&e.jsx(or,{direction:"down",in:!!U,children:e.jsx(lr,{severity:"error",sx:{mb:3,borderRadius:2},action:e.jsx(f,{color:"inherit",size:"small",onClick:h,children:"Reintentar"}),children:U})}),e.jsx(fe,{elevation:0,sx:{p:3,mb:3,borderRadius:3,background:"linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%)",border:"1px solid rgba(0,0,0,0.05)",boxShadow:"0 4px 20px rgba(0,0,0,0.08)"},children:e.jsx(nr,{spacing:3,children:e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{item:!0,xs:12,md:4,children:e.jsx(p,{fullWidth:!0,placeholder:"Buscar tareas...",value:I,onChange:r=>Fe(r.target.value),InputProps:{startAdornment:e.jsx(dr,{position:"start",children:e.jsx(cr,{})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(l,{item:!0,xs:12,md:4,children:e.jsx(C,{options:Me,getOptionLabel:r=>r,value:z||null,onChange:(r,a)=>Ie(a||""),clearOnEscape:!0,sx:{minWidth:300},renderInput:r=>e.jsx(p,{...r,label:"üë§ Filtrar por Usuario",placeholder:"Filtrar por usuario",fullWidth:!0})})}),e.jsx(l,{item:!0,xs:12,md:4,children:e.jsx(C,{options:["alta","media","baja"],getOptionLabel:r=>r.charAt(0).toUpperCase()+r.slice(1),value:A||null,onChange:(r,a)=>ze(a||""),clearOnEscape:!0,sx:{minWidth:300},renderInput:r=>e.jsx(p,{...r,label:"‚ö° Filtrar por Prioridad",placeholder:"Filtrar por prioridad",fullWidth:!0})})})]})})}),se&&e.jsx(ie,{in:!0,children:e.jsxs(N,{sx:{mb:3,borderRadius:3,border:"2px solid #1976d2",boxShadow:"0 6px 24px rgba(25, 118, 210, 0.15)"},children:[e.jsxs(o,{sx:{p:3,background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",color:"white"},children:[e.jsx(m,{variant:"h5",fontWeight:"bold",children:"‚ú® Nueva Tarea para Hoy"}),e.jsx(m,{variant:"body2",sx:{opacity:.9},children:"Completa los campos para crear la tarea"})]}),e.jsx(o,{sx:{p:4,background:"white"},children:e.jsxs(l,{container:!0,spacing:3,children:[e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(p,{label:"üìù T√≠tulo",value:n.titulo,onChange:r=>j({...n,titulo:r.target.value}),fullWidth:!0,required:!0})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(p,{label:"üìÖ Fecha",type:"date",value:n.fecha,onChange:r=>j({...n,fecha:r.target.value}),fullWidth:!0,InputLabelProps:{shrink:!0}})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(C,{options:W,getOptionLabel:r=>r.nombre,value:W.find(r=>r.id===Number(n.tipo_id))||null,onChange:(r,a)=>j({...n,tipo_id:a?String(a.id):""}),sx:{minWidth:280},renderInput:r=>e.jsx(p,{...r,label:"üè∑Ô∏è Tipo de tarea",fullWidth:!0})})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsxs(S,{component:"fieldset",children:[e.jsx(T,{children:"‚ö° Prioridad"}),e.jsxs(E,{row:!0,value:n.prioridad,onChange:r=>j({...n,prioridad:r.target.value}),children:[e.jsx(x,{value:"alta",control:e.jsx(u,{}),label:"Alta"}),e.jsx(x,{value:"media",control:e.jsx(u,{}),label:"Media"}),e.jsx(x,{value:"baja",control:e.jsx(u,{}),label:"Baja"})]})]})}),e.jsx(l,{item:!0,xs:12,children:e.jsxs(S,{component:"fieldset",children:[e.jsx(T,{children:"üë• Asignaci√≥n"}),e.jsxs(E,{row:!0,value:_,onChange:r=>M(r.target.value),children:[e.jsx(x,{value:"aleatoria",control:e.jsx(u,{}),label:"Aleatoria"}),e.jsx(x,{value:"manual",control:e.jsx(u,{}),label:"Manual"})]})]})}),_==="manual"&&e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(C,{options:O,getOptionLabel:r=>`${r.name} (${r.email})`,value:O.find(r=>String(r.id)===$)||null,onChange:(r,a)=>H(a?String(a.id):""),sx:{minWidth:300},renderInput:r=>e.jsx(p,{...r,label:"üßë‚Äçüíº Seleccionar Usuario",fullWidth:!0})})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsxs(S,{component:"fieldset",children:[e.jsx(T,{children:"üè¢ ¬øAsignar empresa?"}),e.jsxs(E,{row:!0,value:oe,onChange:r=>{G(r.target.value),r.target.value==="no"&&j({...n,company_id:""})},children:[e.jsx(x,{value:"si",control:e.jsx(u,{}),label:"S√≠"}),e.jsx(x,{value:"no",control:e.jsx(u,{}),label:"No"})]})]})}),oe==="si"&&e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(C,{options:F,getOptionLabel:r=>r.nombre||r.name||"",value:F.find(r=>r.id===Number(n.company_id))||null,onChange:(r,a)=>j({...n,company_id:a?String(a.id):""}),sx:{minWidth:300},renderInput:r=>e.jsx(p,{...r,label:"üè¢ Seleccionar Empresa",fullWidth:!0})})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(p,{label:"üìÑ Breve Descripci√≥n",multiline:!0,rows:3,value:n.descripcion,onChange:r=>j({...n,descripcion:r.target.value}),fullWidth:!0})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(p,{label:"üìÑ Agrega Contenido",multiline:!0,rows:3,value:n.empresa,onChange:r=>j({...n,empresa:r.target.value}),fullWidth:!0})}),e.jsxs(l,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:2},children:[e.jsx(f,{variant:"outlined",onClick:Ke,startIcon:e.jsx(ye,{}),sx:{borderRadius:2,px:3,py:1},children:"Cancelar"}),e.jsx(f,{variant:"contained",onClick:Qe,disabled:!n.titulo.trim()||_==="manual"&&!$,startIcon:e.jsx(Ce,{}),sx:{borderRadius:2,px:3,py:1,background:"linear-gradient(45deg, #4caf50 0%, #2e7d32 100%)","&:hover":{background:"linear-gradient(45deg, #388e3c 0%, #1b5e20 100%)"}},children:"Crear Tarea"})]})]})})]})}),q&&e.jsx(ie,{in:!0,children:e.jsxs(N,{sx:{mb:3,borderRadius:3,border:"3px solid #FF9100",boxShadow:"0 8px 32px rgba(255, 145, 0, 0.2)"},children:[e.jsx(o,{sx:{p:3,background:"linear-gradient(135deg, #FF9100 0%, #FF6F00 100%)",color:"white"},children:e.jsx(m,{variant:"h5",fontWeight:"bold",children:"‚úèÔ∏è Editar Tarea"})}),e.jsx(o,{sx:{p:4},children:e.jsxs(l,{container:!0,spacing:3,children:[e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(p,{fullWidth:!0,label:"üìù T√≠tulo",value:d.titulo,onChange:r=>g({...d,titulo:r.target.value}),required:!0})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(p,{type:"date",fullWidth:!0,label:"üìÖ Fecha",value:d.fecha,onChange:r=>g({...d,fecha:r.target.value}),InputLabelProps:{shrink:!0}})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(C,{options:W,getOptionLabel:r=>r.nombre,value:W.find(r=>r.id===Number(d.tipo_id))||null,onChange:(r,a)=>g({...d,tipo_id:a?String(a.id):""}),renderInput:r=>e.jsx(p,{...r,label:"üè∑Ô∏è Tipo de tarea",fullWidth:!0})})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsxs(S,{component:"fieldset",fullWidth:!0,children:[e.jsx(T,{children:"‚ö° Prioridad"}),e.jsxs(E,{row:!0,value:d.prioridad,onChange:r=>g({...d,prioridad:r.target.value}),children:[e.jsx(x,{value:"alta",control:e.jsx(u,{}),label:"Alta"}),e.jsx(x,{value:"media",control:e.jsx(u,{}),label:"Media"}),e.jsx(x,{value:"baja",control:e.jsx(u,{}),label:"Baja"})]})]})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsxs(S,{component:"fieldset",fullWidth:!0,children:[e.jsx(T,{children:"üè¢ ¬øCambiar empresa?"}),e.jsxs(E,{row:!0,value:le,onChange:r=>{K(r.target.value),r.target.value==="no"&&g({...d,company_id:""})},children:[e.jsx(x,{value:"si",control:e.jsx(u,{}),label:"S√≠"}),e.jsx(x,{value:"no",control:e.jsx(u,{}),label:"No"})]})]})}),le==="si"&&e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(C,{options:F,getOptionLabel:r=>r.nombre||r.name||"",value:F.find(r=>r.id===Number(d.company_id))||null,onChange:(r,a)=>g({...d,company_id:a?String(a.id):""}),sx:{minWidth:300},renderInput:r=>e.jsx(p,{...r,label:"üè¢ Seleccionar Empresa",fullWidth:!0})})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,multiline:!0,rows:3,label:"üìÑ Descripci√≥n",value:d.descripcion,onChange:r=>g({...d,descripcion:r.target.value})})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,multiline:!0,rows:3,label:"üìÑ Contenido",value:d.empresa,onChange:r=>g({...d,empresa:r.target.value})})}),e.jsx(l,{item:!0,xs:12,children:e.jsxs(o,{sx:{display:"flex",gap:2,justifyContent:"flex-end"},children:[e.jsx(f,{variant:"outlined",startIcon:e.jsx(ye,{}),onClick:qe,children:"Cancelar"}),e.jsx(f,{variant:"contained",startIcon:e.jsx(Ce,{}),onClick:Ze,disabled:!d.titulo.trim(),sx:{background:"linear-gradient(45deg, #FF9100 0%, #FF6F00 100%)"},children:"Actualizar"})]})})]})})]})}),e.jsx(re,{in:!0,children:e.jsx(o,{children:Object.keys(P).length===0?e.jsxs(fe,{sx:{p:6,textAlign:"center",borderRadius:3},children:[e.jsx(m,{variant:"h5",color:"text.secondary",sx:{mb:2},children:"üìù No hay tareas para hoy"}),e.jsx(f,{variant:"contained",startIcon:e.jsx(ae,{}),onClick:Y,children:"Crear primera tarea"})]}):Object.entries(P).map(([r,a],t)=>e.jsx(re,{in:!0,timeout:300+t*100,children:e.jsxs(N,{sx:{mb:3,borderRadius:3,overflow:"hidden"},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:3,background:"linear-gradient(135deg, #1976d2 0%, #2196f3 100%)",color:"white",cursor:"pointer"},onClick:()=>$e(r),children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(xr,{sx:{bgcolor:"white",color:Ye(r),fontWeight:"bold",width:48,height:48},children:Ve(r)}),e.jsxs(o,{children:[e.jsx(m,{variant:"h5",fontWeight:"bold",children:r}),e.jsxs(m,{variant:"body1",sx:{opacity:.9},children:[a.length," ",a.length===1?"tarea asignada":"tareas asignadas"]})]})]}),e.jsx(D,{sx:{color:"white"},children:ne[r]?e.jsx(je,{}):e.jsx(ge,{})})]}),e.jsx(Se,{in:ne[r]??!0,children:e.jsx(o,{sx:{p:2},children:a.map((i,rr)=>e.jsx(ie,{in:!0,style:{transitionDelay:`${rr*100}ms`},children:e.jsxs(N,{sx:{mb:2,borderRadius:2,border:"1px solid rgba(0,0,0,0.1)",borderLeft:`6px solid ${xe(i.prioridad)}`},children:[e.jsxs(o,{onClick:()=>He(i.id),sx:{p:2,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between","&:hover":{bgcolor:y("#1976d2",.05)}},children:[e.jsxs(o,{sx:{flexGrow:1},children:[e.jsx(m,{variant:"h6",fontWeight:"bold",sx:{mb:1},children:i.titulo}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsx(L,{size:"small",label:i.prioridad.toUpperCase(),sx:{bgcolor:xe(i.prioridad),color:"white",fontWeight:"bold"}}),e.jsx(L,{size:"small",icon:e.jsx(mr,{fontSize:"small"}),label:i.fecha,variant:"outlined",color:"primary"}),i.tipo&&e.jsx(L,{size:"small",icon:e.jsx(ar,{fontSize:"small"}),label:i.tipo.nombre_tipo,variant:"outlined",color:"primary"}),i.company&&e.jsx(L,{size:"small",icon:e.jsx(ir,{fontSize:"small"}),label:i.company.name,variant:"outlined",color:"primary"})]})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(we,{title:"Editar tarea",children:e.jsx(D,{onClick:c=>{c.stopPropagation(),Ge(i)},size:"small",sx:{bgcolor:y("#1976d2",.1),"&:hover":{bgcolor:y("#1976d2",.2)}},children:e.jsx(hr,{fontSize:"small"})})}),e.jsx(we,{title:"Cambiar editor",children:e.jsx(D,{onClick:c=>{c.stopPropagation(),Q(i.id)},size:"small",sx:{bgcolor:y("#4caf50",.1),"&:hover":{bgcolor:y("#4caf50",.2)}},children:e.jsx(jr,{fontSize:"small"})})}),e.jsx(D,{size:"small",sx:{color:"#1976d2"},children:ce[i.id]?e.jsx(je,{}):e.jsx(ge,{})})]})]}),i.id===Ae&&e.jsxs(o,{sx:{p:3,bgcolor:y("#4caf50",.05),borderTop:"1px solid rgba(0,0,0,0.1)"},children:[e.jsx(m,{variant:"h6",sx:{mb:2,color:"#4caf50",fontWeight:"bold"},children:"üîÑ Cambiar Editor"}),e.jsxs(S,{fullWidth:!0,size:"small",sx:{mb:2},children:[e.jsx(pr,{children:"Seleccionar Nuevo Editor"}),e.jsx(ur,{value:R??"",onChange:c=>J(Number(c.target.value)),label:"Seleccionar Nuevo Editor",children:O.map(c=>e.jsxs(gr,{value:c.id,children:[c.name," (",c.email,")"]},c.id))})]}),e.jsxs(o,{sx:{display:"flex",gap:2},children:[e.jsx(f,{variant:"outlined",onClick:()=>{Q(null),J(null)},size:"small",children:"Cancelar"}),e.jsx(f,{variant:"contained",onClick:()=>Je(i.id),disabled:!R,size:"small",sx:{bgcolor:"#4caf50","&:hover":{bgcolor:"#388e3c"}},children:"Confirmar cambio"})]})]}),e.jsx(Se,{in:ce[i.id]??!1,children:e.jsx(o,{sx:{px:3,pb:3},children:e.jsxs(o,{sx:{borderTop:"1px solid rgba(0,0,0,0.1)",pt:2},children:[i.asignados.map(c=>e.jsxs(o,{sx:{mb:3,p:2,borderRadius:2,bgcolor:y("#1976d2",.02),border:"1px solid rgba(25, 118, 210, 0.1)"},children:[e.jsxs(o,{sx:{mb:2},children:[e.jsxs(m,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:"bold"},children:["üìä Estado de la tarea:",Pe[c.id]&&e.jsx(o,{component:"span",sx:{ml:1,display:"inline-block",width:16,height:16,border:"2px solid #1976d2",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}})]}),e.jsx(S,{component:"fieldset",size:"small",children:e.jsxs(E,{row:!0,value:c.estado,onChange:V=>Oe(c.id,V.target.value),sx:{gap:2,flexWrap:"wrap"},children:[e.jsx(x,{value:"pendiente",control:e.jsx(u,{size:"small"}),label:"Pendiente"}),e.jsx(x,{value:"en_revision",control:e.jsx(u,{size:"small"}),label:"En revisi√≥n"}),e.jsx(x,{value:"corregir",control:e.jsx(u,{size:"small"}),label:"Corregir"}),e.jsx(x,{value:"publicada",control:e.jsx(u,{size:"small"}),label:"Publicada"})]})})]}),e.jsxs(o,{sx:{mb:2},children:[e.jsxs(m,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:"bold"},children:["üìù Detalle del progreso de: ",c.user_name]}),e.jsx(p,{fullWidth:!0,size:"small",multiline:!0,rows:2,placeholder:"Escribe aqu√≠ los detalles del progreso...",defaultValue:c.detalle||"",onChange:V=>Ue(c.id,V.target.value),sx:{"& .MuiOutlinedInput-root":{borderRadius:2,bgcolor:"white"}}})]})]},c.id)),e.jsxs(o,{sx:{mt:2},children:[e.jsx(m,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:"bold"},children:"üìÑ Descripci√≥n de la tarea:"}),Ne===i.id?e.jsx(p,{fullWidth:!0,multiline:!0,rows:3,value:De,onChange:c=>{pe(c.target.value),Be(i.id,c.target.value)},onBlur:()=>X(null),autoFocus:!0,placeholder:"Describe la tarea en detalle..."}):e.jsxs(o,{onClick:()=>Xe(i),sx:{p:2,borderRadius:2,bgcolor:"white",border:"1px dashed rgba(25, 118, 210, 0.3)",cursor:"pointer","&:hover":{bgcolor:y("#1976d2",.02),borderColor:"#1976d2"}},children:[e.jsx(m,{variant:"body2",color:i.descripcion?"text.primary":"text.secondary",sx:{fontStyle:i.descripcion?"normal":"italic"},children:i.descripcion||"Haz clic para agregar una descripci√≥n..."}),e.jsx(m,{variant:"body2",color:i.empresa?"text.primary":"text.secondary",sx:{fontStyle:i.empresa?"normal":"italic"},children:i.empresa||"Haz clic para agregar una descripci√≥n..."})]})]})]})})})]})},i.id))})})]})},r))})}),!se&&!q&&e.jsx(br,{color:"primary",onClick:Y,sx:{position:"fixed",bottom:24,right:24,background:"linear-gradient(45deg, #4caf50 0%, #2e7d32 100%)","&:hover":{background:"linear-gradient(45deg, #388e3c 0%, #1b5e20 100%)",transform:"scale(1.1)"},transition:"all 0.3s ease",zIndex:1e3},children:e.jsx(ae,{})})]})]})}export{La as default};
