import{r as x,j as e,$ as z,m as y,Y as F}from"./app-gcPa0s22.js";import{A as $}from"./app-layout-CO_KMSKV.js";import"./button-DWmv4xKc.js";import"./clsx-B-dksMZM.js";import"./avatar-DEAtloF7.js";import"./createLucideIcon-DtIvEspD.js";import"./index-8qmTPeiK.js";import"./index-C3PMNp9i.js";import"./index-BZXrUZ9C.js";import"./settings-COpbVc2A.js";import"./app-logo-icon-TNEIzHJ2.js";import"./createSvgIcon-Bvn2cbuR.js";import"./DefaultPropsProvider-D0UdZHkc.js";function h({status:r,fieldName:g,value:p,onChange:N}){const a=r===p,i={pendiente:"bg-red-500 border-red-500",revision:"bg-yellow-500 border-yellow-500",completado:"bg-green-500 border-green-500"};return e.jsx("div",{className:`h-5 w-5 cursor-pointer rounded-full border-2 transition-colors duration-200 ${a?i[p]:"border-gray-400 bg-white"} `,onClick:()=>N(g,p)})}function A({tarea:r,usersProduccion:g,usersEdicion:p,empresaNombre:N}){const[a,i]=x.useState({titulo:r.titulo,fecha_produccion:r.fecha_produccion??"",fecha_nueva_produccion:r.fecha_nueva_produccion??"",razon_produccion:r.razon_produccion??"",estado_produccion:r.estado_produccion||"pendiente",user_produccion_id:r.user_produccion_id??null,fecha_edicion:r.fecha_edicion??"",fecha_nueva_edicion:r.fecha_nueva_edicion??"",razon_edicion:r.razon_edicion??"",estado_edicion:r.estado_edicion||"pendiente",user_edicion_id:r.user_edicion_id??null,fecha_entrega:r.fecha_entrega??"",fecha_nueva_entrega:r.fecha_nueva_entrega??"",razon_entrega:r.razon_entrega??"",estado_entrega:r.estado_entrega||"pendiente",estrategia:r.estrategia,comentario:r.comentario,guion:r.guion}),[w,S]=x.useState(!!r.fecha_nueva_produccion),[C,E]=x.useState(!!r.fecha_nueva_edicion),[_,v]=x.useState(!!r.fecha_nueva_entrega),d=(n,s)=>{const o={...a,[n]:s};i(o),y.patch(route("tareas.actualizar",r.id),o,{preserveScroll:!0,onError:()=>alert("Error al actualizar tarea")})},t=n=>{i({...a,[n.target.name]:n.target.value})},j=n=>{const s=n.target.value===""?null:Number(n.target.value),o={...a,[n.target.name]:s};i(o),y.patch(route("tareas.actualizar",r.id),o,{preserveScroll:!0,onError:()=>alert("Error al actualizar tarea")})},l=()=>{y.patch(route("tareas.actualizar",r.id),a,{preserveScroll:!0,onError:()=>alert("Error al actualizar tarea")})},f=a.estado_entrega==="completado"?"bg-green-100 text-green-800 border-2 border-emerald-500 shadow-md font-semibold":"hover:bg-gray-50",u="bg-blue-200 border-blue-400",m="bg-yellow-200 border-yellow-400",c="bg-green-200 border-green-400";return e.jsxs("tr",{className:`text-sm ${f}`,children:[e.jsx("td",{className:"border px-4 py-2 font-semibold",children:r.empresa?e.jsx(F,{href:route("empresas.seguimiento-tareas",r.empresa.id),className:"text-blue-600 hover:underline",children:N}):"Sin empresa"}),e.jsx("td",{className:"border px-4 py-2",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Título:"}),e.jsx("input",{name:"titulo",value:a.titulo,onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1"}),e.jsx("label",{className:"text-xs text-gray-500",children:"Estrategia:"}),e.jsx("textarea",{name:"estrategia",value:a.estrategia,onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1",rows:2})]})}),e.jsxs("td",{className:`border px-4 py-2 ${u}`,children:[e.jsx("input",{type:"date",name:"fecha_produccion",value:a.fecha_produccion,onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1"}),!w&&!a.fecha_nueva_produccion?e.jsx("button",{onClick:()=>S(!0),className:"mt-2 text-blue-500 hover:text-blue-700",children:"➕ Agregar nueva fecha"}):e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Nueva Fecha:"}),e.jsx("input",{type:"date",name:"fecha_nueva_produccion",value:a.fecha_nueva_produccion??"",onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1"}),e.jsx("label",{className:"text-xs text-gray-500",children:"Razón:"}),e.jsx("textarea",{name:"razon_produccion",value:a.razon_produccion??"",onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1",rows:2})]})]}),e.jsx("td",{className:`border px-4 py-2 text-center ${u}`,children:e.jsx(h,{status:a.estado_produccion,fieldName:"estado_produccion",value:"pendiente",onChange:d})}),e.jsx("td",{className:`border px-4 py-2 text-center ${u}`,children:e.jsx(h,{status:a.estado_produccion,fieldName:"estado_produccion",value:"completado",onChange:d})}),e.jsxs("td",{className:`border px-4 py-2 ${u}`,children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Asignado:"}),e.jsxs("select",{name:"user_produccion_id",value:a.user_produccion_id??"",onChange:j,className:"w-full rounded border px-2 py-1",children:[e.jsx("option",{value:"",children:"Seleccionar"}),g.map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))]})]}),e.jsxs("td",{className:`border px-4 py-2 ${m}`,children:[e.jsx("input",{type:"date",name:"fecha_edicion",value:a.fecha_edicion,onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1"}),!C&&!a.fecha_nueva_edicion?e.jsx("button",{onClick:()=>E(!0),className:"mt-2 text-blue-500 hover:text-blue-700",children:"➕ Agregar nueva fecha"}):e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Nueva Fecha:"}),e.jsx("input",{type:"date",name:"fecha_nueva_edicion",value:a.fecha_nueva_edicion??"",onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1"}),e.jsx("label",{className:"text-xs text-gray-500",children:"Razón:"}),e.jsx("textarea",{name:"razon_edicion",value:a.razon_edicion??"",onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1",rows:2})]})]}),e.jsx("td",{className:`border px-4 py-2 text-center ${m}`,children:e.jsx(h,{status:a.estado_edicion,fieldName:"estado_edicion",value:"pendiente",onChange:d})}),e.jsx("td",{className:`border px-4 py-2 text-center ${m}`,children:e.jsx(h,{status:a.estado_edicion,fieldName:"estado_edicion",value:"revision",onChange:d})}),e.jsx("td",{className:`border px-4 py-2 text-center ${m}`,children:e.jsx(h,{status:a.estado_edicion,fieldName:"estado_edicion",value:"completado",onChange:d})}),e.jsxs("td",{className:`border px-4 py-2 ${m}`,children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Asignado:"}),e.jsxs("select",{name:"user_edicion_id",value:a.user_edicion_id??"",onChange:j,className:"w-full rounded border px-2 py-1",children:[e.jsx("option",{value:"",children:"Seleccionar"}),p.map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))]})]}),e.jsxs("td",{className:`border px-4 py-2 ${c}`,children:[e.jsx("input",{type:"date",name:"fecha_entrega",value:a.fecha_entrega,onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1"}),!_&&!a.fecha_nueva_entrega?e.jsx("button",{onClick:()=>v(!0),className:"mt-2 text-blue-500 hover:text-blue-700",children:"➕ Agregar nueva fecha"}):e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Nueva Fecha:"}),e.jsx("input",{type:"date",name:"fecha_nueva_entrega",value:a.fecha_nueva_entrega??"",onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1"}),e.jsx("label",{className:"text-xs text-gray-500",children:"Razón:"}),e.jsx("textarea",{name:"razon_entrega",value:a.razon_entrega??"",onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1",rows:2})]})]}),e.jsx("td",{className:`border px-4 py-2 text-center ${c}`,children:e.jsx(h,{status:a.estado_entrega,fieldName:"estado_entrega",value:"pendiente",onChange:d})}),e.jsx("td",{className:`border px-4 py-2 text-center ${c}`,children:e.jsx(h,{status:a.estado_entrega,fieldName:"estado_entrega",value:"completado",onChange:d})}),e.jsx("td",{className:"border px-4 py-2",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Comentario:"}),e.jsx("textarea",{name:"comentario",value:a.comentario,onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1",rows:2}),e.jsx("label",{className:"text-xs text-gray-500",children:"Guión:"}),e.jsx("textarea",{name:"guion",value:a.guion,onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1",rows:2})]})})]})}function L({tareas:r=[],usersProduccion:g,usersEdicion:p,mensaje:N,mes:a,anio:i}){var n;const[w,S]=x.useState(""),[C,E]=x.useState("1"),_=new Date,v=[{value:"01",label:"Enero"},{value:"02",label:"Febrero"},{value:"03",label:"Marzo"},{value:"04",label:"Abril"},{value:"05",label:"Mayo"},{value:"06",label:"Junio"},{value:"07",label:"Julio"},{value:"08",label:"Agosto"},{value:"09",label:"Septiembre"},{value:"10",label:"Octubre"},{value:"11",label:"Noviembre"},{value:"12",label:"Diciembre"}],[d,t]=x.useState(a),[j,l]=x.useState(i),f=()=>{y.get(route("seguimiento-tareas-publicados"),{mes:d,anio:j})},u=(r??[]).reduce((s,o)=>{const b=o.semana??"0";return s[b]||(s[b]=[]),s[b].push(o),s},{}),m=Object.keys(u).filter(Boolean).map(Number).sort((s,o)=>s-o).map(String),c={writingMode:"vertical-rl",transform:"rotate(180deg)",height:"100px",width:"30px",padding:"0 4px",textAlign:"center",verticalAlign:"bottom"};return e.jsxs($,{children:[e.jsx(z,{title:"Tareas de Seguimiento"}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-4 flex items-center justify-between border-b pb-4",children:e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Videos Publicados"})}),e.jsxs("div",{className:"mb-4 flex items-center space-x-4",children:[e.jsx("select",{value:d,onChange:s=>t(s.target.value),className:"rounded border px-2 py-1",children:v.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))}),e.jsx("select",{value:j,onChange:s=>l(s.target.value),className:"rounded border px-2 py-1",children:Array.from({length:5},(s,o)=>_.getFullYear()-o).map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsx("button",{onClick:f,className:"rounded bg-blue-500 px-4 py-2 text-white hover:bg-blue-600",children:"Filtrar"})]}),e.jsxs("div",{className:"mb-6 rounded-lg bg-gray-100 p-4 text-center text-xl font-bold text-gray-800 shadow-sm",children:[((n=v.find(s=>s.value===a))==null?void 0:n.label)??"Mes"," ",i]}),r.length===0?e.jsx("div",{className:"mb-6",children:e.jsx("h3",{children:"No hay tareas para este mes."})}):e.jsxs("div",{children:[e.jsx("h2",{className:"mb-4 text-xl font-semibold",children:"Tareas de Seguimiento"}),m.map(s=>e.jsxs("div",{className:"mb-8",children:[e.jsxs("h3",{className:"mb-2 text-lg font-bold text-blue-700",children:["Semana ",s]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full border border-gray-300 bg-white",children:[e.jsxs("thead",{className:"bg-gray-100",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Empresa"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Título/Estrategia"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Fecha Producción"}),e.jsx("th",{className:"border px-4 py-2",colSpan:2,children:"Estado Producción"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Usuario Producción"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Fecha Edición"}),e.jsx("th",{className:"border px-4 py-2",colSpan:3,children:"Estado Edición"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Usuario Edición"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Fecha Entrega"}),e.jsx("th",{className:"border px-4 py-2",colSpan:2,children:"Estado Entrega"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Comentario/Guión"})]}),e.jsxs("tr",{children:[e.jsx("th",{className:"border bg-gray-200",style:c,children:"Pendiente"}),e.jsx("th",{className:"border bg-gray-200",style:c,children:"Completado"}),e.jsx("th",{className:"border bg-gray-200",style:c,children:"Pendiente"}),e.jsx("th",{className:"border bg-gray-200",style:c,children:"En revision"}),e.jsx("th",{className:"border bg-gray-200",style:c,children:"Completado"}),e.jsx("th",{className:"border bg-gray-200",style:c,children:"Pendiente"}),e.jsx("th",{className:"border bg-gray-200",style:c,children:"Publicado"})]})]}),e.jsx("tbody",{children:Array.isArray(u[s])&&u[s].map(o=>{var b;return e.jsx(A,{tarea:o,usersProduccion:g,usersEdicion:p,empresaNombre:((b=o.empresa)==null?void 0:b.name)??"Sin empresa"},o.id)})})]})})]},s))]})]})]})}export{L as default};
