import{j as e,r as m,$ as X,Y as T}from"./app-DWYhLQL6.js";import{A as G,B as A,d as J,L as K}from"./app-layout-p7K4X7eV.js";import{u as Q,P as U}from"./Paper-EniTK7He.js";import{u as Z}from"./index-BcECN-C9.js";import{S as B}from"./Snackbar-sfqlWhTR.js";import{A as ee}from"./Alert-DVZ0JWC1.js";import{G as R}from"./Grid-DU2EuT6q.js";import{C as re}from"./Card-8ZfkaAJ7.js";import{B as o}from"./Box-BbMU-_RR.js";import{T as c}from"./Typography-IkT196je.js";import{B as k}from"./Button-BrLf_Pls.js";import{T as te}from"./TextField-MHNYv_sC.js";import{I as j}from"./IconButton-BGvBFu85.js";import{S as oe}from"./Search-DU2LiQPG.js";import{T as ae}from"./TableContainer-DwTJ9q9t.js";import{T as ie,a as se,b as I,c as ne}from"./TableRow-DBOU2XrP.js";import{T as i}from"./TableCell-C5DOKis2.js";import{D as le}from"./DateRange-6QoYUtOF.js";import{C as me}from"./CalendarToday-zfC2SNRe.js";import{c as de}from"./createSvgIcon-C-V1FIKo.js";import{E as D}from"./Edit-y_0_0Hdp.js";import{D as z}from"./Delete-mfqLQQwu.js";import{a as ce}from"./TablePagination-Cc3mTfKz.js";import{D as pe,a as xe,b as he}from"./DialogTitle-BRc-au27.js";import{C as L}from"./Close-CWq84GBm.js";import{D as ge}from"./DialogActions-2fZYmJbN.js";import"./button-wMTuvAkw.js";import"./clsx-B-dksMZM.js";import"./avatar-C0bnmZQz.js";import"./createLucideIcon-DISkT-zV.js";import"./index-vDywYphy.js";import"./index-CvZMSx04.js";import"./index-C-qtZoBa.js";import"./settings-B1FLQ7wV.js";import"./app-logo-icon-HoYzQaBs.js";import"./DefaultPropsProvider-CHy6HlRv.js";import"./getThemeProps-DLKBaTjH.js";import"./useTimeout-CcjJ2cmE.js";import"./useSlot-CO4IlLCl.js";import"./TransitionGroupContext-D4TXwhqE.js";import"./ClickAwayListener--aFCBNkm.js";import"./Fade-BWgYys4A.js";import"./ownerDocument-DW-IO8s5.js";import"./Grow-IF_zPiYA.js";import"./createSimplePaletteValueFilter-WGi9SSDd.js";import"./Close-DmBjolgA.js";import"./useThemeProps-Bas4AH8z.js";import"./isMuiElement-D94hBNTL.js";import"./useId-o3zk_1yM.js";import"./ButtonBase-DpqQEAAf.js";import"./CircularProgress-Bo20HsGQ.js";import"./Select-DJEe7ust.js";import"./useFormControl-CsRgqpY5.js";import"./index-DtBJPI5W.js";import"./useSlotProps-CBCDIG0V.js";import"./List-DOdfdsGa.js";import"./Modal-N30Js5sT.js";import"./createChainedFunction-BO_9K8Jh.js";import"./Portal-Dt5KHSRP.js";import"./debounce-Be36O1Ab.js";import"./useControlled-5UsadrEY.js";import"./KeyboardArrowRight-Bg0hVIPP.js";import"./LastPage-BK5EUJI-.js";import"./MenuItem-Bm9YqGqc.js";import"./listItemTextClasses-Cw1PQWTE.js";import"./dividerClasses-BOZ5yH6J.js";const fe=de(e.jsx("path",{d:"M16.53 11.06 15.47 10l-4.88 4.88-2.12-2.12-1.06 1.06L10.59 17zM19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 16H5V8h14z"}));function _(g){return{monday:"Lunes",tuesday:"Martes",wednesday:"Miércoles",thursday:"Jueves",friday:"Viernes",saturday:"Sábado",sunday:"Domingo"}[g]||g}const Er=({companies:g,influencersByDay:l})=>{const[M,S]=m.useState(!1),[p,w]=m.useState(null),[W,f]=m.useState(null),[x,H]=m.useState(g),[y,q]=m.useState(""),[u,E]=m.useState(0),[h,O]=m.useState(10),t=Q(),s=Z(t.breakpoints.down("sm")),C=m.useMemo(()=>{const r=y.trim().toLowerCase();return r?x.filter(n=>{var a,d;return n.name.toLowerCase().includes(r)||((d=(a=n.category)==null?void 0:a.name)==null?void 0:d.toLowerCase().includes(r))}):x},[y,x]),P=m.useMemo(()=>C.slice(u*h,u*h+h),[C,u,h]),F=m.useMemo(()=>{const r={monday:0,tuesday:0,wednesday:0,thursday:0,friday:0,saturday:0};return x.forEach(n=>{const a=n.availability_days||[];new Set(a.map(b=>b.day_of_week)).forEach(b=>{r[b]!==void 0&&r[b]++})}),r},[x]);function V(r){w(r),S(!0)}async function Y(){var r;if(p){try{const a=await(await fetch(`/companies/${p.id}`,{method:"DELETE",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||""}})).json();f(a.success||"Compañía eliminada"),H(x.filter(d=>d.id!==p.id))}catch{f("Error al eliminar la compañía")}S(!1),w(null)}}function v(){S(!1),w(null)}const $=(r,n)=>{E(n)},N=r=>{O(parseInt(r.target.value,10)),E(0)};return e.jsxs(G,{children:[e.jsx(X,{title:"Empresas"}),e.jsx(B,{open:!!W,autoHideDuration:4e3,onClose:()=>f(null),anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(ee,{onClose:()=>f(null),severity:"success",sx:{width:"100%"},children:W})}),e.jsx(R,{container:!0,spacing:2,sx:{mb:3,mx:{xs:1,sm:2,md:3,lg:4,xl:6}},justifyContent:"center",children:Object.entries(F).map(([r,n])=>e.jsx(R,{item:!0,xs:6,sm:4,md:3,lg:2.4,xl:2,sx:{display:"flex",justifyContent:"center"},children:e.jsxs(re,{sx:{width:{xs:160,sm:170,md:190,lg:210,xl:230},height:"auto",minHeight:{xs:280,sm:300,md:320,lg:340,xl:360},maxWidth:{xs:160,sm:170,md:190,lg:210,xl:230},flexShrink:0,flexGrow:0,borderRadius:{xs:3,md:4},background:"linear-gradient(135deg, #a18cd1 10%, #66a6ff 100%)",border:"2px solid rgba(0,91,168,0.6)",boxShadow:{xs:"0 4px 12px rgba(37,117,252,0.15), 0 2px 4px rgba(0,0,0,0.1)",md:"0 8px 24px rgba(37,117,252,0.2), 0 4px 8px rgba(0,0,0,0.1)"},display:"flex",flexDirection:"column",alignItems:"center",p:{xs:1,sm:1.2,md:1.5},overflow:"visible","&:hover":{transform:{xs:"translateY(-4px) scale(1.02)",md:"translateY(-6px) scale(1.03)"},boxShadow:{xs:"0 12px 32px rgba(37,117,252,0.25), 0 6px 12px rgba(0,0,0,0.15)",md:"0 16px 48px rgba(37,117,252,0.3), 0 8px 16px rgba(0,0,0,0.2)"}}},children:[e.jsxs(o,{sx:{textAlign:"center",mb:{xs:1,md:1.5},width:"100%"},children:[e.jsx(c,{variant:"subtitle1",sx:{fontWeight:"bold",mb:{xs:.5,md:1},color:"white",letterSpacing:1.2,fontSize:{xs:"0.85rem",sm:"0.9rem",md:"1rem"},textShadow:"0 2px 8px rgba(0,0,0,0.3)"},children:_(r)}),e.jsxs(c,{variant:"h4",sx:{fontWeight:900,fontSize:{xs:"1.5rem",sm:"1.75rem",md:"2rem"},color:"white",textShadow:"0 3px 12px rgba(0,0,0,0.4)"},children:[n," ",e.jsx(o,{component:"span",sx:{fontSize:"0.85rem",fontWeight:600,color:"rgba(255,255,255,0.9)"},children:n===1?"Empresa":"Empresas"})]})]}),e.jsx(o,{sx:{width:"100%",flex:1,display:"flex",flexDirection:"column",gap:{xs:.5,sm:.6,md:.7},px:{xs:.5,sm:.7,md:1},overflowY:"auto",maxHeight:{xs:180,sm:200,md:220},"&::-webkit-scrollbar":{width:"4px"},"&::-webkit-scrollbar-thumb":{backgroundColor:t.palette.primary.dark,borderRadius:"2px"}},children:Array.isArray(l==null?void 0:l[r])&&l[r].length>0?l[r].map((a,d)=>e.jsx(o,{sx:{background:"rgba(255,255,255,0.95)",borderRadius:1,p:{xs:.5,sm:.6,md:.7},borderLeft:`3px solid ${t.palette.secondary.main}`,boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:e.jsxs(c,{variant:"caption",sx:{display:"flex",flexDirection:"column",color:t.palette.primary.main,fontSize:{xs:"0.65rem",sm:"0.7rem",md:"0.75rem"},fontWeight:600,lineHeight:1.3},children:[e.jsx(o,{component:"span",sx:{fontWeight:"bold"},children:a.influencer.split(" ")[0]}),e.jsx(o,{component:"span",sx:{color:t.palette.secondary.main,wordBreak:"break-word",whiteSpace:"normal"},children:a.empresa})]})},d)):e.jsx(c,{variant:"caption",sx:{visibility:"hidden",height:{xs:20,sm:25,md:30}},children:"Placeholder"})}),Array.isArray(l==null?void 0:l[r])&&l[r].length>4&&e.jsxs(c,{variant:"caption",sx:{fontSize:"0.6rem",color:"rgba(255,255,255,0.8)",fontStyle:"italic",mt:.5,textShadow:"0 1px 4px rgba(0,0,0,0.3)"},children:["+",l[r].length-4," más"]})]})},r))}),e.jsxs(o,{sx:{py:6,mx:{xs:0,md:4}},children:[e.jsxs(o,{sx:{mb:4,display:"flex",flexDirection:{xs:"column",md:"row"},gap:2,alignItems:{md:"center"},justifyContent:{md:"space-between"}},children:[e.jsx(k,{component:T,href:"/companies/create",variant:"contained",color:"primary",sx:{fontWeight:"bold"},startIcon:e.jsx(A,{}),children:"Crear nueva Empresa"}),e.jsx(te,{placeholder:"Buscar por nombre o categoría...",value:y,onChange:r=>q(r.target.value),size:"small",fullWidth:!0,sx:{maxWidth:320},InputProps:{startAdornment:e.jsx(j,{tabIndex:-1,children:e.jsx(oe,{})})}})]}),e.jsxs(ae,{component:U,sx:{borderRadius:2,boxShadow:3,overflowX:"auto",border:"1px solid #e0e0e0",background:t.palette.background.paper,mx:{xs:0,md:2}},children:[e.jsxs(ie,{stickyHeader:!0,sx:{minWidth:900},children:[e.jsx(se,{children:e.jsxs(I,{children:[e.jsx(i,{sx:{fontWeight:"bold",backgroundColor:t.palette.primary.main,color:t.palette.common.white,padding:s?"8px":"16px",fontSize:s?"0.875rem":"1rem"},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(A,{fontSize:"small"})," Nombre de la empresa"]})}),e.jsx(i,{sx:{fontWeight:"bold",backgroundColor:t.palette.primary.main,color:t.palette.common.white,padding:s?"8px":"16px",fontSize:s?"0.875rem":"1rem"},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(J,{fontSize:"small"})," Categoría"]})}),e.jsx(i,{sx:{fontWeight:"bold",backgroundColor:t.palette.primary.main,color:t.palette.common.white,padding:s?"8px":"16px",fontSize:s?"0.875rem":"1rem"},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(K,{fontSize:"small"})," Duración del contrato"]})}),e.jsx(i,{sx:{fontWeight:"bold",backgroundColor:t.palette.primary.main,color:t.palette.common.white,padding:s?"8px":"16px",fontSize:s?"0.875rem":"1rem"},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(le,{fontSize:"small"})," Fecha inicio"]})}),e.jsx(i,{sx:{fontWeight:"bold",backgroundColor:t.palette.primary.main,color:t.palette.common.white,padding:s?"8px":"16px",fontSize:s?"0.875rem":"1rem"},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(me,{fontSize:"small"})," Fecha fin"]})}),e.jsx(i,{sx:{fontWeight:"bold",backgroundColor:t.palette.primary.main,color:t.palette.common.white,padding:s?"8px":"16px",fontSize:s?"0.875rem":"1rem"},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(fe,{fontSize:"small"})," Días Disponibles"]})}),e.jsx(i,{sx:{fontWeight:"bold",backgroundColor:t.palette.primary.main,color:t.palette.common.white,padding:s?"8px":"16px",fontSize:s?"0.875rem":"1rem"},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(D,{fontSize:"small"})," / ",e.jsx(z,{fontSize:"small"})," Acciones"]})})]})}),e.jsxs(ne,{children:[P.length===0&&e.jsx(I,{children:e.jsx(i,{colSpan:7,align:"center",sx:{py:6,color:"text.secondary"},children:"No se encontraron compañías."})}),P.map(r=>{var n;return e.jsxs(I,{hover:!0,children:[e.jsx(i,{children:r.name}),e.jsx(i,{children:((n=r.category)==null?void 0:n.name)||e.jsx("span",{style:{color:"#aaa",fontStyle:"italic"},children:"Sin categoría"})}),e.jsx(i,{children:r.contract_duration}),e.jsx(i,{children:r.start_date||"-"}),e.jsx(i,{children:r.end_date||"-"}),e.jsx(i,{children:e.jsx(o,{sx:{display:"flex",flexDirection:"column",gap:.5},children:Array.isArray(r.availability_days)&&r.availability_days.length>0?r.availability_days.map((a,d)=>e.jsxs(o,{sx:{display:"inline-block",px:1,py:.5,borderRadius:1,fontSize:"0.75rem",fontWeight:600,bgcolor:a.turno==="mañana"?"blue.100":"yellow.100",color:a.turno==="mañana"?"blue.800":"yellow.800",border:"1px solid",borderColor:"grey.200"},children:[_(a.day_of_week),": ",a.start_time," - ",a.end_time," (",a.turno,")"]},d)):e.jsx(c,{variant:"body2",color:"text.secondary",fontStyle:"italic",children:"Sin disponibilidad"})})}),e.jsxs(i,{children:[e.jsx(j,{color:"primary",component:T,href:`/companies/${r.id}/edit`,"aria-label":"Editar",children:e.jsx(D,{})}),e.jsx(j,{color:"error",onClick:()=>V(r),"aria-label":"Eliminar",children:e.jsx(z,{})})]})]},r.id)})]})]}),e.jsx(ce,{component:"div",count:C.length,page:u,onPageChange:$,rowsPerPage:h,onRowsPerPageChange:N,rowsPerPageOptions:[5,10,25,50],labelRowsPerPage:"Filas por página"})]})]}),e.jsxs(pe,{open:M,onClose:v,maxWidth:"xs",fullWidth:!0,children:[e.jsxs(xe,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(c,{variant:"h6",children:"Confirmar eliminación"}),e.jsx(j,{onClick:v,children:e.jsx(L,{})})]}),e.jsx(he,{dividers:!0,children:e.jsxs(c,{children:["¿Estás seguro de que deseas eliminar la compañía ",e.jsx("b",{children:p==null?void 0:p.name}),"?"]})}),e.jsxs(ge,{children:[e.jsx(k,{onClick:v,color:"inherit",variant:"outlined",startIcon:e.jsx(L,{}),children:"Cancelar"}),e.jsx(k,{onClick:Y,color:"error",variant:"contained",startIcon:e.jsx(z,{}),children:"Eliminar"})]})]})]})};export{Er as default};
