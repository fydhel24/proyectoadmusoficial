import{r as o,a as h,j as e,$ as be}from"./app-CUaISujP.js";import{A as je,P as rr,B as ye,c as ve,b as Ce,d as ar}from"./app-layout-CWuB6NnO.js";import{l as Se}from"./lodash-CNXKIdpG.js";import{u as tr,T as c,P as we}from"./Typography-BXYVZiZC.js";import{u as ir}from"./index-UjFnLotG.js";import{C as V}from"./Container-D7VV_BeN.js";import{S as Ee}from"./Skeleton-BYfKkpzH.js";import{G as n}from"./Grid-D22HHTDy.js";import{B as s}from"./Box-F7bZ1tjM.js";import{F as ee}from"./Fade-ChnIJY1B.js";import{C as v}from"./Chip-3MHDmL7Q.js";import{S as or}from"./Slide-Bk05lrAy.js";import{A as sr}from"./Alert-C5OLpzZT.js";import{B as W}from"./Button-BnJ1HrMo.js";import{S as nr}from"./Stack-DTJ6fEPw.js";import{T as u}from"./TextField-k7btXKeC.js";import{I as lr}from"./InputAdornment-BGJDdqNA.js";import{S as dr}from"./Search-C72N3j8E.js";import{A as C}from"./Autocomplete-_ePhfL0R.js";import{A as cr}from"./Assignment-DPFhWYma.js";import{Z as re}from"./Zoom-2jsgxgEd.js";import{C as $}from"./Card-WOrh8z9Z.js";import{F as T,a as z}from"./Select-vcTzVEW7.js";import{R as I,a as x}from"./RadioGroup-pZFucle5.js";import{F as m}from"./FormControlLabel-GJI2qXqz.js";import{C as Fe}from"./Cancel-BMr9YuUk.js";import{S as ke}from"./Save-CFxGaTx-.js";import{A as pr}from"./Add-De3J4oTr.js";import{A as ur}from"./Avatar-B3oc0cGH.js";import{I as ae}from"./IconButton-C9CZ2MaG.js";import{C as _e}from"./Collapse-B0wk9zZQ.js";import{C as xr}from"./CalendarToday-B5CpGBSs.js";import{T as mr}from"./Tooltip-CS7sEpaO.js";import{E as hr}from"./Edit-BqoUF0Kc.js";import{b as j}from"./DefaultPropsProvider-DnyQ5W7l.js";import"./button-0Hij8kFa.js";import"./clsx-B-dksMZM.js";import"./avatar-vMY4vQMB.js";import"./createLucideIcon-XVNSMSUw.js";import"./index-DZ5Pi2z6.js";import"./index-b-iRS2c_.js";import"./index-JQPl0ewz.js";import"./settings-CLpIyV6T.js";import"./app-logo-icon-DxXq1G7b.js";import"./createSvgIcon-CsdeE9h-.js";import"./getThemeProps-DVd4S7h3.js";import"./useTimeout-BTm0asfU.js";import"./useThemeProps-DJqCDgEx.js";import"./isMuiElement-6h6e2Qkh.js";import"./TransitionGroupContext-Ci2WFGYL.js";import"./useSlot-CYEIGEy5.js";import"./ButtonBase-DE1CgUJq.js";import"./debounce-Be36O1Ab.js";import"./Modal-ZVwyIF_S.js";import"./ownerDocument-DW-IO8s5.js";import"./Portal-8nlpaEwd.js";import"./Close-B0CWLwSb.js";import"./useId-B2OWouFT.js";import"./CircularProgress-nCrY-oKD.js";import"./useControlled-QlBAzUVK.js";import"./usePreviousProps-CqJPJccm.js";import"./Popper-C5nG_1D4.js";import"./index-Coxc2Kyf.js";import"./useSlotProps-BLv6iqgZ.js";import"./List-C4LEDEwh.js";import"./Grow-B_EMGJuI.js";import"./SwitchBase-C0XU40cX.js";import"./FormGroup-CK6EsC9s.js";function Ma(){const[S,te]=o.useState([]),[D,ie]=o.useState([]),[L,oe]=o.useState([]),[R,B]=o.useState("aleatoria"),[se,ne]=o.useState([]),[U,G]=o.useState(""),[We,le]=o.useState(!0),[q,w]=o.useState(null),[Te,gr]=o.useState("dia"),[fr,br]=o.useState(new Date().toISOString().split("T")[0]),[E,Ie]=o.useState(""),[F,Re]=o.useState(""),[k,Ae]=o.useState(""),[de,H]=o.useState(null),[l,f]=o.useState({titulo:"",prioridad:"",descripcion:"",fecha:"",tipo_id:"",company_id:""}),[ze,Z]=o.useState(!1),[d,g]=o.useState({titulo:"",prioridad:"",descripcion:"",fecha:"",tipo_id:"",company_id:""}),[ce,K]=o.useState("no"),[pe,Q]=o.useState("no"),[jr,yr]=o.useState(null),[vr,Cr]=o.useState({estado:"",detalle:""}),[ue,xe]=o.useState({}),[J,_]=o.useState({}),[De,X]=o.useState(null),[Le,me]=o.useState(""),[M,Me]=o.useState({}),Pe=tr();ir(Pe.breakpoints.down("sm"));const b=async()=>{try{const[r,a,t,i]=await Promise.all([h.get("/tareas-con-asignaciones"),h.get("/api/tipos"),h.get("/api/companies"),h.get("/api/pasantes")]),A=r.data.filter(p=>{var y;return(y=p.asignados)==null?void 0:y.some(O=>{var N;return((N=O.estado)==null?void 0:N.toLowerCase().replace(/\s/g,""))==="en_revision"})});te(A),ie(a.data),oe(t.data),ne(i.data.data)}catch(r){console.error("Error al cargar datos:",r),w("Error al cargar datos.")}finally{le(!1)}},Oe=o.useCallback(async(r,a)=>{_(t=>({...t,[r]:!0}));try{await h.patch(`/asignaciones/${r}`,{estado:a}),await b()}catch(t){console.error("Error al actualizar estado:",t),w("No se pudo actualizar el estado")}finally{_(t=>({...t,[r]:!1}))}},[b]),Ne=o.useCallback(Se.debounce(async(r,a)=>{_(t=>({...t,[r]:!0}));try{await h.patch(`/asignaciones/${r}`,{detalle:a}),await b()}catch(t){console.error("Error al actualizar detalle:",t),w("No se pudo actualizar el detalle")}finally{_(t=>({...t,[r]:!1}))}},1e3),[b]),$e=o.useCallback(Se.debounce(async(r,a)=>{_(t=>({...t,[r]:!0}));try{await h.put(`/tareas/${r}`,{descripcion:a}),await b(),X(null)}catch(t){console.error("Error al actualizar descripci√≥n:",t),w("No se pudo actualizar la descripci√≥n")}finally{_(t=>({...t,[r]:!1}))}},1e3),[b]),Y=o.useMemo(()=>{new Date().toISOString().split("T")[0];let r=S;return S.filter(a=>a.asignados.some(t=>{var i;return((i=t.estado)==null?void 0:i.toLowerCase().replace(/\s/g,""))==="en_revision"})),E&&(r=r.filter(a=>a.titulo.toLowerCase().includes(E.toLowerCase()))),k&&(r=r.filter(a=>a.prioridad===k)),F&&(r=r.filter(a=>a.asignados.some(t=>t.user_name===F))),r},[S,E,k,F]),P=o.useMemo(()=>{const r={};return Y.forEach(a=>{a.asignados.forEach(t=>{const i=t.user_name;r[i]||(r[i]=[]),r[i].push(a)})}),r},[Y]),he=o.useMemo(()=>{const r=new Set;return S.forEach(a=>{a.asignados.forEach(t=>{r.add(t.user_name)})}),Array.from(r).sort()},[S]);o.useEffect(()=>{(async()=>{try{const[a,t,i,A]=await Promise.all([h.get("/tareas-con-asignaciones"),h.get("/api/tipos"),h.get("/api/companies"),h.get("/api/pasantes")]),p=a.data.filter(y=>{var O;return(O=y.asignados)==null?void 0:O.some(N=>{var fe;return((fe=N.estado)==null?void 0:fe.toLowerCase().replace(/\s/g,""))==="en_revision"})});console.log("üìå TAREAS EN REVISI√ìN:",p),te(p),ie(t.data),oe(i.data),ne(A.data.data)}catch(a){console.error("Error al cargar datos:",a),w("Hubo un error al cargar los datos. Por favor, intenta de nuevo.")}finally{le(!1)}})()},[]),o.useEffect(()=>{const r={};Object.keys(P).forEach(a=>{r[a]=!0}),xe(r)},[P]);const Be=r=>{xe(a=>({...a,[r]:!a[r]}))},Ue=r=>{var a,t;H(r.id),f({titulo:r.titulo,prioridad:r.prioridad,descripcion:r.descripcion,fecha:r.fecha,tipo_id:(a=r.tipo)!=null&&a.id?String(r.tipo.id):"",company_id:(t=r.company)!=null&&t.id?String(r.company.id):""}),Q(r.company?"si":"no")},Ge=()=>{H(null),f({titulo:"",prioridad:"",descripcion:"",fecha:"",tipo_id:"",company_id:""}),Q("no")},qe=async()=>{if(l.titulo.trim())try{const r={...l,tipo_id:l.tipo_id?Number(l.tipo_id):null,company_id:l.company_id?Number(l.company_id):null};await h.put(`/tareas/${de}`,r),H(null),b()}catch(r){console.error("Error al actualizar tarea:",r),w("Error al actualizar la tarea")}},He=()=>{Z(!0),g({titulo:"",prioridad:"",descripcion:"",fecha:new Date().toISOString().split("T")[0],tipo_id:"",company_id:""}),K("no")},Ze=()=>{Z(!1),g({titulo:"",prioridad:"",descripcion:"",fecha:"",tipo_id:"",company_id:""}),K("no"),B("aleatoria"),G("")},Ke=async()=>{if(d.titulo.trim())try{const r={...d,tipo_id:d.tipo_id?Number(d.tipo_id):null,company_id:d.company_id?Number(d.company_id):null,asignacion_aleatoria:R==="aleatoria",pasante_id:R==="manual"?Number(U):null};await h.post("/create/tareas",r),Z(!1),b(),B("aleatoria"),G("")}catch(r){console.error("Error al crear tarea:",r),w("Error al crear la tarea")}},ge=r=>{switch(r.toLowerCase()){case"alta":return"#FF1744";case"media":return"#FF9100";case"baja":return"#00E676";default:return"#9E9E9E"}},Qe=r=>{const a=["#1976d2","#1565c0","#0d47a1","#2196f3","#0288d1","#01579b","#03a9f4","#00b0ff","#0091ea","#3f51b5"],t=r.charCodeAt(0)%a.length;return a[t]},Je=r=>r.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2),Xe=Y.filter(r=>F?r.asignados.some(a=>a.user_name.includes(F)):!0).filter(r=>k?r.prioridad===k:!0).filter(r=>E?r.titulo.toLowerCase().includes(E.toLowerCase()):!0);if(We)return e.jsxs(je,{breadcrumbs:[{title:"Tareas",href:"/tareas"}],children:[e.jsx(be,{title:"Tareas"}),e.jsxs(V,{maxWidth:"xl",sx:{py:4},children:[e.jsx(Ee,{variant:"rectangular",height:60,sx:{mb:2,borderRadius:1}}),e.jsx(n,{container:!0,spacing:2,children:[...Array(7)].map((r,a)=>e.jsx(n,{item:!0,xs:12,sm:6,md:!0,children:e.jsx(Ee,{variant:"rectangular",height:400,sx:{borderRadius:2}})},a))})]})]});const Ye=r=>{X(r.id),me(r.descripcion||"")},Ve=`
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
`,er=r=>{Me(a=>({...a,[r]:!a[r]}))};return e.jsxs(je,{breadcrumbs:[{title:"Tareas",href:"/tareas"}],children:[e.jsx(be,{title:"Tareas"}),e.jsx("style",{children:Ve}),e.jsx(s,{sx:{background:"linear-gradient(135deg, #1976d2 0%, #0d47a1 100%)",color:"white",py:3,position:"relative",overflow:"hidden"},children:e.jsx(V,{maxWidth:"xl",sx:{position:"relative",zIndex:1},children:e.jsx(ee,{in:!0,timeout:800,children:e.jsxs(s,{display:"flex",alignItems:"center",gap:1,mb:2,children:[e.jsx(c,{variant:"h5",fontWeight:"bold",children:"üìÑ Tareas"}),e.jsx(v,{label:"En Revisi√≥n",color:"warning",variant:"outlined"})]})})})}),e.jsxs(V,{maxWidth:"xl",sx:{py:3},children:[q&&e.jsx(or,{direction:"down",in:!!q,children:e.jsx(sr,{severity:"error",sx:{mb:3,borderRadius:2},action:e.jsx(W,{color:"inherit",size:"small",onClick:b,children:"Reintentar"}),children:q})}),e.jsx(we,{elevation:0,sx:{p:3,mb:3,borderRadius:3,background:"linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%)",border:"1px solid rgba(0,0,0,0.05)",boxShadow:"0 4px 20px rgba(0,0,0,0.08)"},children:e.jsxs(nr,{spacing:3,children:[e.jsxs(s,{sx:{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap"},children:[e.jsx(s,{sx:{flexGrow:1}}),e.jsx(s,{sx:{display:"flex",gap:1}})]}),e.jsxs(n,{container:!0,spacing:2,children:[e.jsx(n,{item:!0,xs:12,md:4,children:e.jsx(u,{fullWidth:!0,placeholder:"Buscar tareas...",value:E,onChange:r=>Ie(r.target.value),InputProps:{startAdornment:e.jsx(lr,{position:"start",children:e.jsx(dr,{})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(n,{item:!0,xs:12,md:4,children:e.jsx(C,{options:he,getOptionLabel:r=>r,value:F||null,onChange:(r,a)=>Re(a||""),clearOnEscape:!0,sx:{minWidth:300},renderInput:r=>e.jsx(u,{...r,label:"üë§ Filtrar por Usuario",placeholder:"Filtrar por usuario",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,md:4,children:e.jsx(C,{options:["alta","media","baja"],getOptionLabel:r=>r.charAt(0).toUpperCase()+r.slice(1),value:k||null,onChange:(r,a)=>Ae(a||""),clearOnEscape:!0,sx:{minWidth:300},renderInput:r=>e.jsx(u,{...r,label:"‚ö° Filtrar por Prioridad",placeholder:"Filtrar por prioridad",fullWidth:!0})})})]}),e.jsxs(s,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(v,{icon:e.jsx(cr,{}),label:`${Xe.length} tareas de hoy`,color:"primary",variant:"outlined",sx:{fontWeight:"bold"}}),Te!=="dia"&&e.jsxs(e.Fragment,{children:[e.jsx(v,{icon:e.jsx(rr,{}),label:`${he.length} usuarios`,color:"primary",variant:"outlined",sx:{fontWeight:"bold"}}),e.jsx(v,{icon:e.jsx(ye,{}),label:`${new Set(S.map(r=>{var a;return(a=r.company)==null?void 0:a.name}).filter(Boolean)).size} empresas`,color:"primary",variant:"outlined",sx:{fontWeight:"bold"}})]})]})]})}),ze&&e.jsx(re,{in:!0,children:e.jsxs($,{sx:{mb:3,borderRadius:3,border:"2px solid #1976d2",boxShadow:"0 6px 24px rgba(25, 118, 210, 0.15)"},children:[e.jsxs(s,{sx:{p:3,background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",color:"white"},children:[e.jsx(c,{variant:"h5",fontWeight:"bold",children:"‚ú® Nueva Tarea para Hoy"}),e.jsx(c,{variant:"body2",sx:{opacity:.9},children:"Completa los campos para crear la tarea"})]}),e.jsx(s,{sx:{p:4,background:"white"},children:e.jsxs(n,{container:!0,spacing:3,children:[e.jsx(n,{item:!0,xs:12,children:e.jsx(C,{options:S,getOptionLabel:r=>`${r.titulo} - ${r.fecha}`,filterOptions:(r,{inputValue:a})=>r.filter(t=>t.titulo.toLowerCase().includes(a.toLowerCase())),onChange:(r,a)=>{a&&g(t=>({...t,titulo:a.titulo,descripcion:a.descripcion}))},renderInput:r=>e.jsx(u,{...r,label:"üîç Buscar tareas existentes",placeholder:"Escribe para buscar una tarea similar...",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(u,{label:"üìù T√≠tulo",value:d.titulo,onChange:r=>g({...d,titulo:r.target.value}),fullWidth:!0,required:!0})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(u,{label:"üìÖ Fecha",type:"date",value:d.fecha,onChange:r=>g({...d,fecha:r.target.value}),fullWidth:!0,InputLabelProps:{shrink:!0}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(C,{options:D,getOptionLabel:r=>r.nombre,value:D.find(r=>r.id===Number(d.tipo_id))||null,onChange:(r,a)=>g({...d,tipo_id:a?String(a.id):""}),sx:{minWidth:280},renderInput:r=>e.jsx(u,{...r,label:"üè∑Ô∏è Tipo de tarea",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(T,{component:"fieldset",children:[e.jsx(z,{children:"‚ö° Prioridad"}),e.jsxs(I,{row:!0,value:d.prioridad,onChange:r=>g({...d,prioridad:r.target.value}),children:[e.jsx(m,{value:"alta",control:e.jsx(x,{}),label:"Alta"}),e.jsx(m,{value:"media",control:e.jsx(x,{}),label:"Media"}),e.jsx(m,{value:"baja",control:e.jsx(x,{}),label:"Baja"})]})]})}),e.jsx(n,{item:!0,xs:12,children:e.jsxs(T,{component:"fieldset",children:[e.jsx(z,{children:"üë• Asignaci√≥n"}),e.jsxs(I,{row:!0,value:R,onChange:r=>B(r.target.value),children:[e.jsx(m,{value:"aleatoria",control:e.jsx(x,{}),label:"Aleatoria"}),e.jsx(m,{value:"manual",control:e.jsx(x,{}),label:"Manual"})]})]})}),R==="manual"&&e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(C,{options:se,getOptionLabel:r=>`${r.name} (${r.email})`,value:se.find(r=>String(r.id)===U)||null,onChange:(r,a)=>G(a?String(a.id):""),sx:{minWidth:300},renderInput:r=>e.jsx(u,{...r,label:"üßë‚Äçüíº Seleccionar Pasante",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(T,{component:"fieldset",children:[e.jsx(z,{children:"üè¢ ¬øAsignar empresa?"}),e.jsxs(I,{row:!0,value:ce,onChange:r=>{K(r.target.value),r.target.value==="no"&&g({...d,company_id:""})},children:[e.jsx(m,{value:"si",control:e.jsx(x,{}),label:"S√≠"}),e.jsx(m,{value:"no",control:e.jsx(x,{}),label:"No"})]})]})}),ce==="si"&&e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(C,{options:L,getOptionLabel:r=>r.nombre,value:L.find(r=>r.id===Number(d.company_id))||null,onChange:(r,a)=>g({...d,company_id:a?String(a.id):""}),sx:{minWidth:280},renderInput:r=>e.jsx(u,{...r,label:"üè¢ Seleccionar Empresa",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(u,{label:"üìÑ Descripci√≥n",multiline:!0,rows:3,value:d.descripcion,onChange:r=>g({...d,descripcion:r.target.value}),fullWidth:!0})}),e.jsxs(n,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:2},children:[e.jsx(W,{variant:"outlined",onClick:Ze,startIcon:e.jsx(Fe,{}),sx:{borderRadius:2,px:3,py:1,fontWeight:"bold",borderColor:"#9e9e9e",color:"#424242","&:hover":{backgroundColor:"#f5f5f5",borderColor:"#616161"}},children:"Cancelar"}),e.jsx(W,{variant:"contained",onClick:Ke,disabled:!d.titulo.trim()||R==="manual"&&!U,startIcon:e.jsx(ke,{}),sx:{borderRadius:2,px:3,py:1,fontWeight:"bold",background:"linear-gradient(45deg, #4caf50 0%, #2e7d32 100%)","&:hover":{background:"linear-gradient(45deg, #388e3c 0%, #1b5e20 100%)",transform:"scale(1.02)"},transition:"all 0.3s ease"},children:"Crear Tarea"})]})]})})]})}),de&&e.jsx(re,{in:!0,children:e.jsxs($,{sx:{mb:3,borderRadius:3,border:"3px solid #FF9100",boxShadow:"0 8px 32px rgba(255, 145, 0, 0.2)",overflow:"hidden"},children:[e.jsxs(s,{sx:{p:3,background:"linear-gradient(135deg, #FF9100 0%, #FF6F00 100%)",color:"white"},children:[e.jsx(c,{variant:"h5",fontWeight:"bold",sx:{display:"flex",alignItems:"center",gap:1},children:"‚úèÔ∏è Editar Tarea"}),e.jsx(c,{variant:"body2",sx:{opacity:.9,mt:.5},children:"Modifica los campos que necesites actualizar"})]}),e.jsx(s,{sx:{p:4,background:"linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%)"},children:e.jsxs(n,{container:!0,spacing:3,children:[e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(u,{fullWidth:!0,label:"üìù T√≠tulo de la tarea",value:l.titulo,onChange:r=>f({...l,titulo:r.target.value}),required:!0,sx:{"& .MuiOutlinedInput-root":{borderRadius:2,"&:hover":{borderColor:"#FF9100"}}}})}),e.jsx(n,{item:!0,xs:12,md:3,children:e.jsx(u,{type:"date",fullWidth:!0,label:"üìÖ Fecha",value:l.fecha,onChange:r=>f({...l,fecha:r.target.value}),InputLabelProps:{shrink:!0},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(n,{item:!0,xs:12,md:4,children:e.jsx(C,{options:D,getOptionLabel:r=>r.nombre,value:D.find(r=>r.id===Number(l.tipo_id))||null,onChange:(r,a)=>f({...l,tipo_id:a?String(a.id):""}),sx:{minWidth:300},renderInput:r=>e.jsx(u,{...r,label:"üè∑Ô∏è Tipo de tarea",placeholder:"Selecciona un tipo",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(T,{component:"fieldset",fullWidth:!0,children:[e.jsx(z,{component:"legend",sx:{fontWeight:"bold",mb:1,color:"#FF9100"},children:"‚ö° Prioridad"}),e.jsxs(I,{row:!0,value:l.prioridad,onChange:r=>f({...l,prioridad:r.target.value}),children:[e.jsx(m,{value:"alta",control:e.jsx(x,{sx:{color:"#FF1744","&.Mui-checked":{color:"#FF1744"}}}),label:"Alta"}),e.jsx(m,{value:"media",control:e.jsx(x,{sx:{color:"#FF9100","&.Mui-checked":{color:"#FF9100"}}}),label:"Media"}),e.jsx(m,{value:"baja",control:e.jsx(x,{sx:{color:"#00E676","&.Mui-checked":{color:"#00E676"}}}),label:"Baja"})]})]})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(T,{component:"fieldset",fullWidth:!0,children:[e.jsx(z,{component:"legend",sx:{fontWeight:"bold",mb:1,color:"#FF9100"},children:"üè¢ ¬øCambiar empresa?"}),e.jsxs(I,{row:!0,value:pe,onChange:r=>{Q(r.target.value),r.target.value==="no"&&f({...l,company_id:""})},children:[e.jsx(m,{value:"si",control:e.jsx(x,{}),label:"S√≠"}),e.jsx(m,{value:"no",control:e.jsx(x,{}),label:"No"})]})]})}),pe==="si"&&e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(C,{options:L,getOptionLabel:r=>r.nombre,value:L.find(r=>r.id===Number(l.company_id))||null,onChange:(r,a)=>f({...l,company_id:a?String(a.id):""}),sx:{minWidth:300},renderInput:r=>e.jsx(u,{...r,label:"üè¢ Empresa",placeholder:"Selecciona una empresa",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(u,{fullWidth:!0,multiline:!0,rows:3,label:"üìÑ Descripci√≥n",value:l.descripcion,onChange:r=>f({...l,descripcion:r.target.value}),placeholder:"Describe la tarea en detalle...",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(n,{item:!0,xs:12,children:e.jsxs(s,{sx:{display:"flex",gap:2,justifyContent:"flex-end"},children:[e.jsx(W,{variant:"outlined",startIcon:e.jsx(Fe,{}),onClick:Ge,sx:{borderRadius:2,minWidth:120},children:"Cancelar"}),e.jsx(W,{variant:"contained",startIcon:e.jsx(ke,{}),onClick:qe,disabled:!l.titulo.trim(),sx:{borderRadius:2,minWidth:120,background:"linear-gradient(45deg, #FF9100 0%, #FF6F00 100%)","&:hover":{background:"linear-gradient(45deg, #FF8F00 0%, #E65100 100%)"}},children:"Actualizar"})]})})]})})]})}),e.jsx(ee,{in:!0,children:e.jsx(s,{children:Object.keys(P).length===0?e.jsxs(we,{sx:{p:6,textAlign:"center",borderRadius:3,background:"linear-gradient(145deg, #f8f9fa 0%, #e9ecef 100%)"},children:[e.jsx(c,{variant:"h5",color:"text.secondary",sx:{mb:2},children:"üìù No hay tareas para hoy"}),e.jsx(c,{color:"text.secondary",sx:{mb:3},children:"No se encontraron tareas programadas para hoy"}),e.jsx(W,{variant:"contained",startIcon:e.jsx(pr,{}),onClick:()=>He(),sx:{borderRadius:2,background:"linear-gradient(45deg, #1976d2 0%, #0d47a1 100%)"},children:"Crear primera tarea"})]}):Object.entries(P).map(([r,a],t)=>e.jsx(ee,{in:!0,timeout:300+t*100,children:e.jsxs($,{sx:{mb:3,borderRadius:3,overflow:"hidden",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:3,background:"linear-gradient(135deg, #1976d2 0%, #2196f3 100%)",color:"white",cursor:"pointer","&:hover":{background:"linear-gradient(135deg, #1565c0 0%, #1976d2 100%)"},transition:"background 0.3s ease"},onClick:()=>Be(r),children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(ur,{sx:{bgcolor:"white",color:Qe(r),fontWeight:"bold",width:48,height:48},children:Je(r)}),e.jsxs(s,{children:[e.jsx(c,{variant:"h5",fontWeight:"bold",children:r}),e.jsxs(c,{variant:"body1",sx:{opacity:.9},children:[a.length," ",a.length===1?"tarea asignada":"tareas asignadas"]})]})]}),e.jsx(ae,{sx:{color:"white"},children:ue[r]?e.jsx(ve,{}):e.jsx(Ce,{})})]}),e.jsx(_e,{in:ue[r]??!0,children:e.jsx(s,{sx:{p:2},children:a.map((i,A)=>e.jsx(re,{in:!0,style:{transitionDelay:`${A*100}ms`},children:e.jsxs($,{sx:{mb:2,borderRadius:2,border:"1px solid rgba(0,0,0,0.1)",transition:"all 0.3s ease","&:hover":{boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},borderLeft:`6px solid ${ge(i.prioridad)}`,overflow:"hidden"},children:[e.jsxs(s,{onClick:()=>er(i.id),sx:{p:2,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",bgcolor:M[i.id]?j("#1976d2",.02):"transparent","&:hover":{bgcolor:j("#1976d2",.05)},transition:"background-color 0.2s ease"},children:[e.jsxs(s,{sx:{flexGrow:1},children:[e.jsx(c,{variant:"h6",fontWeight:"bold",sx:{mb:1,color:M[i.id]?"#1976d2":"text.primary"},children:i.titulo}),e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsx(v,{size:"small",label:i.prioridad.toUpperCase(),sx:{bgcolor:ge(i.prioridad),color:"white",fontWeight:"bold",fontSize:"0.75rem"}}),e.jsx(v,{size:"small",icon:e.jsx(xr,{fontSize:"small"}),label:i.fecha,variant:"outlined",color:"primary"}),i.tipo&&e.jsx(v,{size:"small",icon:e.jsx(ar,{fontSize:"small"}),label:i.tipo.nombre_tipo,variant:"outlined",color:"primary"}),i.company&&e.jsx(v,{size:"small",icon:e.jsx(ye,{fontSize:"small"}),label:i.company.name,variant:"outlined",color:"primary"})]})]}),e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(mr,{title:"Editar tarea",children:e.jsx(ae,{onClick:p=>{p.stopPropagation(),Ue(i)},size:"small",color:"primary",sx:{bgcolor:j("#1976d2",.1),"&:hover":{bgcolor:j("#1976d2",.2)}},children:e.jsx(hr,{fontSize:"small"})})}),e.jsx(ae,{size:"small",sx:{color:"#1976d2"},children:M[i.id]?e.jsx(ve,{}):e.jsx(Ce,{})})]})]}),e.jsx(_e,{in:M[i.id]??!1,children:e.jsx(s,{sx:{px:3,pb:3},children:e.jsxs(s,{sx:{borderTop:"1px solid rgba(0,0,0,0.1)",pt:2},children:[i.asignados.map(p=>e.jsxs(s,{sx:{mb:3,p:2,borderRadius:2,bgcolor:j("#1976d2",.02),border:"1px solid rgba(25, 118, 210, 0.1)"},children:[e.jsxs(s,{sx:{mb:2},children:[e.jsxs(c,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:"bold",display:"flex",alignItems:"center",gap:1},children:["üìä Estado de la tarea:",J[p.id]&&e.jsx(s,{sx:{width:16,height:16,border:"2px solid #1976d2",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}})]}),e.jsx(T,{component:"fieldset",size:"small",children:e.jsxs(I,{row:!0,value:p.estado,onChange:y=>Oe(p.id,y.target.value),sx:{gap:2,flexWrap:"wrap"},children:[e.jsx(m,{value:"pendiente",control:e.jsx(x,{size:"small",sx:{color:"#FF9100","&.Mui-checked":{color:"#FF9100"},"&:hover":{bgcolor:j("#FF9100",.1)}}}),label:e.jsx(c,{variant:"body2",sx:{fontSize:"0.875rem"},children:"Pendiente"})}),e.jsx(m,{value:"en_revision",control:e.jsx(x,{size:"small",sx:{color:"#2196F3","&.Mui-checked":{color:"#2196F3"},"&:hover":{bgcolor:j("#2196F3",.1)}}}),label:e.jsx(c,{variant:"body2",sx:{fontSize:"0.875rem"},children:"En revisi√≥n"})}),e.jsx(m,{value:"publicada",control:e.jsx(x,{size:"small",sx:{color:"#4CAF50","&.Mui-checked":{color:"#4CAF50"},"&:hover":{bgcolor:j("#4CAF50",.1)}}}),label:e.jsx(c,{variant:"body2",sx:{fontSize:"0.875rem"},children:"Publicada"})})]})})]}),e.jsxs(s,{sx:{mb:2},children:[e.jsxs(c,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:"bold",display:"flex",alignItems:"center",gap:1},children:["üìù Detalle del progreso:",J[p.id]&&e.jsx(c,{variant:"caption",color:"primary",sx:{fontStyle:"italic"},children:"Guardando..."})]}),e.jsx(u,{fullWidth:!0,size:"small",multiline:!0,rows:2,placeholder:"Escribe aqu√≠ los detalles del progreso...",defaultValue:p.detalle||"",onChange:y=>Ne(p.id,y.target.value),sx:{"& .MuiOutlinedInput-root":{borderRadius:2,bgcolor:"white","&:hover":{bgcolor:"white",borderColor:"#1976d2"},"&.Mui-focused":{bgcolor:"white",borderColor:"#1976d2"}}}})]})]},p.id)),e.jsxs(s,{sx:{mt:2},children:[e.jsxs(c,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:"bold",display:"flex",alignItems:"center",gap:1},children:["üìÑ Descripci√≥n de la tarea:",J[i.id]&&e.jsx(c,{variant:"caption",color:"primary",sx:{fontStyle:"italic"},children:"Guardando..."})]}),De===i.id?e.jsx(u,{fullWidth:!0,multiline:!0,rows:3,value:Le,onChange:p=>{me(p.target.value),$e(i.id,p.target.value)},onBlur:()=>X(null),autoFocus:!0,placeholder:"Describe la tarea en detalle...",sx:{"& .MuiOutlinedInput-root":{borderRadius:2,bgcolor:"white","&:hover":{borderColor:"#1976d2"}}}}):e.jsx(s,{onClick:()=>Ye(i),sx:{p:2,borderRadius:2,bgcolor:"white",border:"1px dashed rgba(25, 118, 210, 0.3)",cursor:"pointer",transition:"all 0.2s ease","&:hover":{bgcolor:j("#1976d2",.02),borderColor:"#1976d2",borderStyle:"solid"}},children:e.jsx(c,{variant:"body2",color:i.descripcion?"text.primary":"text.secondary",sx:{fontStyle:i.descripcion?"normal":"italic",lineHeight:1.5},children:i.descripcion||"Haz clic para agregar una descripci√≥n..."})})]})]})})})]})},i.id))})})]})},r))})})]})]})}export{Ma as default};
