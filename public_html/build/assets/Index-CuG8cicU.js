import{j as o,r as t,$ as Y,a as b}from"./app-CUaISujP.js";import{A as Z,P as U}from"./app-layout-CWuB6NnO.js";import{B as s}from"./Box-F7bZ1tjM.js";import{T as i}from"./Typography-BXYVZiZC.js";import{c as E}from"./createSvgIcon-CsdeE9h-.js";import{D as L}from"./Divider-DFO96sJa.js";import{S as x}from"./Stack-DTJ6fEPw.js";import{G as j}from"./Grow-B_EMGJuI.js";import{C as oo}from"./Chip-3MHDmL7Q.js";import{B as l}from"./Button-BnJ1HrMo.js";import{A as eo}from"./Add-De3J4oTr.js";import{M as B}from"./Modal-ZVwyIF_S.js";import{T as y}from"./TextField-k7btXKeC.js";import{I as ro}from"./InputAdornment-BGJDdqNA.js";import{S as to}from"./Search-C72N3j8E.js";import{G as O}from"./Grid-D22HHTDy.js";import{C as io}from"./Card-WOrh8z9Z.js";import{C as so}from"./CardContent-Cfc9Wxl5.js";import{A as P}from"./Avatar-B3oc0cGH.js";import{C as ao}from"./CardActions-CMJC6Ong.js";import{I as no}from"./IconButton-C9CZ2MaG.js";import{C as lo}from"./Close-Dux9YOWC.js";import{C as G}from"./CircularProgress-nCrY-oKD.js";import{A as po}from"./Autocomplete-_ePhfL0R.js";import{T as co}from"./Tooltip-CS7sEpaO.js";import{S as mo}from"./Snackbar-B7vsGb3O.js";import{A as xo}from"./Alert-C5OLpzZT.js";import"./button-0Hij8kFa.js";import"./clsx-B-dksMZM.js";import"./avatar-vMY4vQMB.js";import"./createLucideIcon-XVNSMSUw.js";import"./index-DZ5Pi2z6.js";import"./index-b-iRS2c_.js";import"./index-JQPl0ewz.js";import"./settings-CLpIyV6T.js";import"./app-logo-icon-DxXq1G7b.js";import"./DefaultPropsProvider-DnyQ5W7l.js";import"./dividerClasses-Bv3o9dJ8.js";import"./useThemeProps-DJqCDgEx.js";import"./getThemeProps-DVd4S7h3.js";import"./Fade-ChnIJY1B.js";import"./TransitionGroupContext-Ci2WFGYL.js";import"./useTimeout-BTm0asfU.js";import"./useSlot-CYEIGEy5.js";import"./ButtonBase-DE1CgUJq.js";import"./useId-B2OWouFT.js";import"./ownerDocument-DW-IO8s5.js";import"./Portal-8nlpaEwd.js";import"./Select-vcTzVEW7.js";import"./isMuiElement-6h6e2Qkh.js";import"./index-Coxc2Kyf.js";import"./useSlotProps-BLv6iqgZ.js";import"./List-C4LEDEwh.js";import"./debounce-Be36O1Ab.js";import"./useControlled-QlBAzUVK.js";import"./Close-B0CWLwSb.js";import"./usePreviousProps-CqJPJccm.js";import"./Popper-C5nG_1D4.js";import"./ClickAwayListener-CJ5v628k.js";const C=E(o.jsx("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m0 4c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3m6 12H6v-1.4c0-2 4-3.1 6-3.1s6 1.1 6 3.1z"})),v=E(o.jsx("path",{d:"M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12z"}));function je({users:N,tipos:_}){const[h,$]=t.useState(""),[D,S]=t.useState(!1),[F,T]=t.useState(!1),[p,w]=t.useState(""),[c,H]=t.useState(_),[a,A]=t.useState(null),[d,m]=t.useState([]),[Q,W]=t.useState(!1),[I,k]=t.useState(!1),[u,n]=t.useState({open:!1,message:"",severity:"success"}),V=N.filter(e=>e.name.toLowerCase().includes(h.toLowerCase())||e.email.toLowerCase().includes(h.toLowerCase())),q=()=>S(!0),z=()=>{S(!1),w("")},J=async()=>{if(p.trim())try{const e=await b.post("/tipos",{nombre_tipo:p});H(r=>[...r,e.data.tipo]),n({open:!0,message:"Tipo creado con éxito",severity:"success"}),z()}catch{n({open:!0,message:"Error al crear tipo",severity:"error"})}},K=async e=>{A(e),W(!0);try{const r=await b.get(`/tipos/${e.id}/tipos`);m(r.data.map(g=>g.id))}catch{m([])}W(!1),T(!0)},f=()=>{T(!1),A(null),m([])},M=e=>{m(r=>r.includes(e)?r.filter(g=>g!==e):[...r,e])},X=async()=>{if(a){k(!0);try{await b.put(`/tipos/${a.id}/tipos`,{tipos:d}),n({open:!0,message:"Tipos actualizados",severity:"success"}),f()}catch{n({open:!0,message:"Error al actualizar tipos",severity:"error"})}k(!1)}},R=["primary","secondary","success","error","warning","info"];return o.jsxs(Z,{breadcrumbs:[{title:"Tipos",href:"/tipos"}],children:[o.jsx(Y,{title:"Tipos"}),o.jsxs(s,{sx:{mb:4},children:[o.jsxs(i,{variant:"h4",fontWeight:700,gutterBottom:!0,color:"primary.main",sx:{letterSpacing:1},children:[o.jsx(C,{sx:{mr:1,verticalAlign:"middle",fontSize:36}}),"Gestión de Personal"]}),o.jsx(L,{sx:{mb:2}}),o.jsx(x,{direction:"row",spacing:2,alignItems:"center",flexWrap:"wrap",sx:{mb:2,gap:2},children:c.map((e,r)=>o.jsx(j,{in:!0,timeout:400+r*80,children:o.jsx(oo,{icon:o.jsx(v,{}),label:e.nombre_tipo,color:R[r%R.length],sx:{fontWeight:500,fontSize:15,borderRadius:2,boxShadow:2,px:2,py:1,mb:1}})},e.id))}),o.jsx(l,{variant:"contained",color:"primary",startIcon:o.jsx(eo,{}),onClick:q,sx:{ml:1,height:40,borderRadius:2,boxShadow:2,fontWeight:600,textTransform:"none"},children:"Nuevo Tipo"})]}),o.jsx(B,{open:D,onClose:z,closeAfterTransition:!0,BackdropProps:{timeout:500},children:o.jsxs(s,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",borderRadius:4,boxShadow:24,p:4,outline:"none"},children:[o.jsxs(i,{variant:"h6",fontWeight:700,gutterBottom:!0,color:"primary.main",children:[o.jsx(v,{sx:{mr:1,verticalAlign:"middle"}}),"Crear Nuevo Tipo"]}),o.jsx(y,{label:"Nombre del Tipo",variant:"outlined",fullWidth:!0,value:p,onChange:e=>w(e.target.value),sx:{mb:3}}),o.jsx(l,{variant:"contained",color:"primary",fullWidth:!0,onClick:J,disabled:!p.trim(),sx:{borderRadius:2,fontWeight:600},children:"Crear"})]})}),o.jsx(y,{label:"Buscar Personl",variant:"outlined",fullWidth:!0,value:h,onChange:e=>$(e.target.value),InputProps:{endAdornment:o.jsx(ro,{position:"end",children:o.jsx(to,{})})},sx:{mb:4,borderRadius:2,boxShadow:1}}),o.jsx(O,{container:!0,spacing:4,children:V.map((e,r)=>o.jsx(j,{in:!0,timeout:400+r*80,children:o.jsx(O,{item:!0,xs:12,sm:6,md:4,children:o.jsxs(io,{elevation:6,sx:{borderRadius:4,boxShadow:6,transition:"transform 0.2s","&:hover":{transform:"scale(1.025)",boxShadow:12},mb:2,bgcolor:"background.paper"},children:[o.jsx(so,{children:o.jsxs(x,{direction:"row",spacing:2,alignItems:"center",sx:{mb:1},children:[o.jsx(P,{sx:{bgcolor:"primary.main",width:48,height:48,fontWeight:700,fontSize:22,boxShadow:2},children:o.jsx(U,{fontSize:"large"})}),o.jsxs(s,{children:[o.jsx(i,{variant:"h6",fontWeight:700,color:"text.primary",children:e.name}),o.jsx(i,{variant:"body2",color:"text.secondary",children:e.email})]})]})}),o.jsx(ao,{sx:{pt:0},children:o.jsx(l,{variant:"outlined",color:"primary",onClick:()=>K(e),fullWidth:!0,sx:{borderRadius:2,fontWeight:600,textTransform:"none",py:1,letterSpacing:.5},startIcon:o.jsx(C,{}),children:"Gestionar Tipos"})})]})})},e.id))}),o.jsx(B,{open:F,onClose:f,closeAfterTransition:!0,BackdropProps:{timeout:500},children:o.jsxs(s,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:440,bgcolor:"background.paper",borderRadius:4,boxShadow:24,p:4,outline:"none"},children:[o.jsxs(s,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:[o.jsxs(i,{variant:"h6",fontWeight:700,color:"primary.main",children:[o.jsx(U,{sx:{mr:1,verticalAlign:"middle"}}),"Tipos de ",a==null?void 0:a.name]}),o.jsx(no,{onClick:f,children:o.jsx(lo,{})})]}),Q?o.jsx(s,{display:"flex",justifyContent:"center",py:4,children:o.jsx(G,{})}):o.jsxs(o.Fragment,{children:[o.jsx(po,{options:c.filter(e=>!d.includes(e.id)),getOptionLabel:e=>e.nombre_tipo,renderInput:e=>o.jsx(y,{...e,label:"Agregar tipo",variant:"outlined"}),renderOption:(e,r)=>t.createElement("li",{...e,key:r.id},r.nombre_tipo),onChange:(e,r)=>{r&&M(r.id)},sx:{mb:3},isOptionEqualToValue:(e,r)=>e.id===r.id,noOptionsText:"No hay tipos para agregar"}),o.jsx(L,{sx:{mb:2}}),o.jsx(i,{variant:"subtitle1",fontWeight:700,sx:{mb:1},children:"Tipos asignados"}),o.jsxs(x,{spacing:1,sx:{mb:2},children:[c.filter(e=>d.includes(e.id)).map((e,r)=>o.jsx(j,{in:!0,timeout:400+r*60,children:o.jsxs(s,{display:"flex",alignItems:"center",justifyContent:"space-between",sx:{border:"1px solid",borderColor:"primary.light",borderRadius:2,px:2,py:1,bgcolor:"primary.50",boxShadow:1},children:[o.jsxs(x,{direction:"row",alignItems:"center",spacing:1,children:[o.jsx(P,{sx:{bgcolor:"primary.light",width:32,height:32,fontSize:18},children:o.jsx(v,{fontSize:"small"})}),o.jsx(i,{fontWeight:600,children:e.nombre_tipo})]}),o.jsx(co,{title:"Quitar tipo",children:o.jsx(l,{variant:"contained",color:"error",size:"small",onClick:()=>M(e.id),sx:{borderRadius:2,fontWeight:600},children:"Quitar"})})]})},e.id)),c.filter(e=>d.includes(e.id)).length===0&&o.jsx(i,{variant:"body2",color:"text.secondary",align:"center",children:"No hay tipos asignados."})]}),o.jsx(l,{variant:"contained",color:"primary",onClick:X,disabled:I,fullWidth:!0,sx:{borderRadius:2,fontWeight:700,py:1.2,fontSize:16},startIcon:o.jsx(C,{}),children:I?o.jsx(G,{size:24}):"Guardar Cambios"})]})]})}),o.jsx(mo,{open:u.open,autoHideDuration:3e3,onClose:()=>n(e=>({...e,open:!1})),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:o.jsx(xo,{severity:u.severity,variant:"filled",sx:{width:"100%"},children:u.message})})]})}export{je as default};
