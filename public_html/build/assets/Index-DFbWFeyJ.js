import{j as e,r as t,$ as ee,a as h}from"./app-DWYhLQL6.js";import{A as re,P as L}from"./app-layout-p7K4X7eV.js";import{B as i}from"./Box-BbMU-_RR.js";import{T as s}from"./Typography-IkT196je.js";import{c as N}from"./createSvgIcon-C-V1FIKo.js";import{D as B}from"./Divider-_DokKI_g.js";import{S as u}from"./Stack-nT1jkqe3.js";import{G as b}from"./Grow-IF_zPiYA.js";import{C as oe}from"./Chip-Dd1dfm5j.js";import{I as O}from"./IconButton-BGvBFu85.js";import{D as te}from"./Delete-mfqLQQwu.js";import{B as p}from"./Button-BrLf_Pls.js";import{A as ie}from"./Add-C3coAMIP.js";import{M as E}from"./Modal-N30Js5sT.js";import{T as y}from"./TextField-MHNYv_sC.js";import{I as se}from"./InputAdornment-elME3r4g.js";import{S as ae}from"./Search-DU2LiQPG.js";import{G as P}from"./Grid-DU2EuT6q.js";import{C as ne}from"./Card-8ZfkaAJ7.js";import{C as le}from"./CardContent-JwUFqTB9.js";import{A as G}from"./Avatar-DoV_5ciI.js";import{C as pe}from"./CardActions-B9gcubhK.js";import{C as ce}from"./Close-CWq84GBm.js";import{C as D}from"./CircularProgress-Bo20HsGQ.js";import{A as me}from"./Autocomplete-V3kj0McP.js";import{T as de}from"./Tooltip-D9IkZOyx.js";import{S as xe}from"./Snackbar-sfqlWhTR.js";import{A as he}from"./Alert-DVZ0JWC1.js";import"./button-wMTuvAkw.js";import"./clsx-B-dksMZM.js";import"./avatar-C0bnmZQz.js";import"./createLucideIcon-DISkT-zV.js";import"./index-vDywYphy.js";import"./index-CvZMSx04.js";import"./index-C-qtZoBa.js";import"./settings-B1FLQ7wV.js";import"./app-logo-icon-HoYzQaBs.js";import"./DefaultPropsProvider-CHy6HlRv.js";import"./createSimplePaletteValueFilter-WGi9SSDd.js";import"./dividerClasses-BOZ5yH6J.js";import"./useThemeProps-Bas4AH8z.js";import"./getThemeProps-DLKBaTjH.js";import"./Paper-EniTK7He.js";import"./Fade-BWgYys4A.js";import"./TransitionGroupContext-D4TXwhqE.js";import"./useTimeout-CcjJ2cmE.js";import"./useSlot-CO4IlLCl.js";import"./ButtonBase-DpqQEAAf.js";import"./useId-o3zk_1yM.js";import"./ownerDocument-DW-IO8s5.js";import"./createChainedFunction-BO_9K8Jh.js";import"./Portal-Dt5KHSRP.js";import"./Select-DJEe7ust.js";import"./useFormControl-CsRgqpY5.js";import"./isMuiElement-D94hBNTL.js";import"./index-DtBJPI5W.js";import"./useSlotProps-CBCDIG0V.js";import"./List-DOdfdsGa.js";import"./debounce-Be36O1Ab.js";import"./useControlled-5UsadrEY.js";import"./Close-DmBjolgA.js";import"./usePreviousProps-VIxPXDBR.js";import"./Popper-BNtv9MeI.js";import"./ClickAwayListener--aFCBNkm.js";const C=N(e.jsx("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m0 4c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3m6 12H6v-1.4c0-2 4-3.1 6-3.1s6 1.1 6 3.1z"})),v=N(e.jsx("path",{d:"M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12z"}));function wr({users:_,tipos:$}){const[f,F]=t.useState(""),[H,S]=t.useState(!1),[q,T]=t.useState(!1),[c,w]=t.useState(""),[m,A]=t.useState($),[n,W]=t.useState(null),[d,x]=t.useState([]),[Q,k]=t.useState(!1),[I,z]=t.useState(!1),[g,a]=t.useState({open:!1,message:"",severity:"success"}),V=_.filter(r=>r.name.toLowerCase().includes(f.toLowerCase())||r.email.toLowerCase().includes(f.toLowerCase())),J=()=>S(!0),M=()=>{S(!1),w("")},K=async()=>{if(c.trim())try{const r=await h.post("/tipos",{nombre_tipo:c});A(o=>[...o,r.data.tipo]),a({open:!0,message:"Tipo creado con éxito",severity:"success"}),M()}catch{a({open:!0,message:"Error al crear tipo",severity:"error"})}},X=async r=>{W(r),k(!0);try{const o=await h.get(`/tipos/${r.id}/tipos`);x(o.data.map(l=>l.id))}catch{x([])}k(!1),T(!0)},j=()=>{T(!1),W(null),x([])},R=r=>{x(o=>o.includes(r)?o.filter(l=>l!==r):[...o,r])},Y=async()=>{if(n){z(!0);try{await h.put(`/tipos/${n.id}/tipos`,{tipos:d}),a({open:!0,message:"Tipos actualizados",severity:"success"}),j()}catch{a({open:!0,message:"Error al actualizar tipos",severity:"error"})}z(!1)}},U=["primary","secondary","success","error","warning","info"],Z=async r=>{if(window.confirm("¿Seguro que deseas eliminar este tipo?"))try{await h.delete(`/tipos/${r}`),A(o=>o.filter(l=>l.id!==r)),a({open:!0,message:"Tipo eliminado con éxito",severity:"success"})}catch{a({open:!0,message:"Error al eliminar tipo",severity:"error"})}};return e.jsxs(re,{breadcrumbs:[{title:"Tipos",href:"/tipos"}],children:[e.jsx(ee,{title:"Tipos"}),e.jsxs(i,{sx:{mb:4},children:[e.jsxs(s,{variant:"h4",fontWeight:700,gutterBottom:!0,color:"primary.main",sx:{letterSpacing:1},children:[e.jsx(C,{sx:{mr:1,verticalAlign:"middle",fontSize:36}}),"Gestión de Personal"]}),e.jsx(B,{sx:{mb:2}}),e.jsx(u,{direction:"row",spacing:2,alignItems:"center",flexWrap:"wrap",sx:{mb:2,gap:2},children:m.map((r,o)=>e.jsx(b,{in:!0,timeout:400+o*80,children:e.jsxs(i,{display:"flex",alignItems:"center",children:[e.jsx(oe,{icon:e.jsx(v,{}),label:r.nombre_tipo,color:U[o%U.length],sx:{fontWeight:500,fontSize:15,borderRadius:2,boxShadow:2,px:2,py:1,mb:1}}),e.jsx(O,{"aria-label":"Eliminar tipo",color:"error",size:"small",onClick:()=>Z(r.id),sx:{ml:1},children:e.jsx(te,{})})]})},r.id))}),e.jsx(p,{variant:"contained",color:"primary",startIcon:e.jsx(ie,{}),onClick:J,sx:{ml:1,height:40,borderRadius:2,boxShadow:2,fontWeight:600,textTransform:"none"},children:"Nuevo Tipo"})]}),e.jsx(E,{open:H,onClose:M,closeAfterTransition:!0,BackdropProps:{timeout:500},children:e.jsxs(i,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",borderRadius:4,boxShadow:24,p:4,outline:"none"},children:[e.jsxs(s,{variant:"h6",fontWeight:700,gutterBottom:!0,color:"primary.main",children:[e.jsx(v,{sx:{mr:1,verticalAlign:"middle"}}),"Crear Nuevo Tipo"]}),e.jsx(y,{label:"Nombre del Tipo",variant:"outlined",fullWidth:!0,value:c,onChange:r=>w(r.target.value),sx:{mb:3}}),e.jsx(p,{variant:"contained",color:"primary",fullWidth:!0,onClick:K,disabled:!c.trim(),sx:{borderRadius:2,fontWeight:600},children:"Crear"})]})}),e.jsx(y,{label:"Buscar Personl",variant:"outlined",fullWidth:!0,value:f,onChange:r=>F(r.target.value),InputProps:{endAdornment:e.jsx(se,{position:"end",children:e.jsx(ae,{})})},sx:{mb:4,borderRadius:2,boxShadow:1}}),e.jsx(P,{container:!0,spacing:4,children:V.map((r,o)=>e.jsx(b,{in:!0,timeout:400+o*80,children:e.jsx(P,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(ne,{elevation:6,sx:{borderRadius:4,boxShadow:6,transition:"transform 0.2s","&:hover":{transform:"scale(1.025)",boxShadow:12},mb:2,bgcolor:"background.paper"},children:[e.jsx(le,{children:e.jsxs(u,{direction:"row",spacing:2,alignItems:"center",sx:{mb:1},children:[e.jsx(G,{sx:{bgcolor:"primary.main",width:48,height:48,fontWeight:700,fontSize:22,boxShadow:2},children:e.jsx(L,{fontSize:"large"})}),e.jsxs(i,{children:[e.jsx(s,{variant:"h6",fontWeight:700,color:"text.primary",children:r.name}),e.jsx(s,{variant:"body2",color:"text.secondary",children:r.email})]})]})}),e.jsx(pe,{sx:{pt:0},children:e.jsx(p,{variant:"outlined",color:"primary",onClick:()=>X(r),fullWidth:!0,sx:{borderRadius:2,fontWeight:600,textTransform:"none",py:1,letterSpacing:.5},startIcon:e.jsx(C,{}),children:"Gestionar Tipos"})})]})})},r.id))}),e.jsx(E,{open:q,onClose:j,closeAfterTransition:!0,BackdropProps:{timeout:500},children:e.jsxs(i,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:440,bgcolor:"background.paper",borderRadius:4,boxShadow:24,p:4,outline:"none"},children:[e.jsxs(i,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:[e.jsxs(s,{variant:"h6",fontWeight:700,color:"primary.main",children:[e.jsx(L,{sx:{mr:1,verticalAlign:"middle"}}),"Tipos de ",n==null?void 0:n.name]}),e.jsx(O,{onClick:j,children:e.jsx(ce,{})})]}),Q?e.jsx(i,{display:"flex",justifyContent:"center",py:4,children:e.jsx(D,{})}):e.jsxs(e.Fragment,{children:[e.jsx(me,{options:m.filter(r=>!d.includes(r.id)),getOptionLabel:r=>r.nombre_tipo,renderInput:r=>e.jsx(y,{...r,label:"Agregar tipo",variant:"outlined"}),renderOption:(r,o)=>t.createElement("li",{...r,key:o.id},o.nombre_tipo),onChange:(r,o)=>{o&&R(o.id)},sx:{mb:3},isOptionEqualToValue:(r,o)=>r.id===o.id,noOptionsText:"No hay tipos para agregar"}),e.jsx(B,{sx:{mb:2}}),e.jsx(s,{variant:"subtitle1",fontWeight:700,sx:{mb:1},children:"Tipos asignados"}),e.jsxs(u,{spacing:1,sx:{mb:2},children:[m.filter(r=>d.includes(r.id)).map((r,o)=>e.jsx(b,{in:!0,timeout:400+o*60,children:e.jsxs(i,{display:"flex",alignItems:"center",justifyContent:"space-between",sx:{border:"1px solid",borderColor:"primary.light",borderRadius:2,px:2,py:1,bgcolor:"primary.50",boxShadow:1},children:[e.jsxs(u,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(G,{sx:{bgcolor:"primary.light",width:32,height:32,fontSize:18},children:e.jsx(v,{fontSize:"small"})}),e.jsx(s,{fontWeight:600,children:r.nombre_tipo})]}),e.jsx(de,{title:"Quitar tipo",children:e.jsx(p,{variant:"contained",color:"error",size:"small",onClick:()=>R(r.id),sx:{borderRadius:2,fontWeight:600},children:"Quitar"})})]})},r.id)),m.filter(r=>d.includes(r.id)).length===0&&e.jsx(s,{variant:"body2",color:"text.secondary",align:"center",children:"No hay tipos asignados."})]}),e.jsx(p,{variant:"contained",color:"primary",onClick:Y,disabled:I,fullWidth:!0,sx:{borderRadius:2,fontWeight:700,py:1.2,fontSize:16},startIcon:e.jsx(C,{}),children:I?e.jsx(D,{size:24}):"Guardar Cambios"})]})]})}),e.jsx(xe,{open:g.open,autoHideDuration:3e3,onClose:()=>a(r=>({...r,open:!1})),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(he,{severity:g.severity,variant:"filled",sx:{width:"100%"},children:g.message})})]})}export{wr as default};
