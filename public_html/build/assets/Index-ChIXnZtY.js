import{j as e,q as B,r as p,v as G,$ as le,U as de,m as L}from"./app-hmuC0z_W.js";import{A as ce,B as xe,P as ue}from"./app-layout-tfxOdOKB.js";import{D as pe}from"./Delete-XrUhzWCn.js";import{E as he}from"./Edit-BRh_CxWN.js";import{c as me}from"./createSvgIcon-DmtCSiy2.js";import{P as fe}from"./PictureAsPdf-DVLbu-7F.js";import{S as ge}from"./Search-BGzkUUj0.js";import{T as be}from"./TrendingUp-DdCTmQC8.js";import{B as a}from"./Box-4C9-OmNb.js";import{T as n}from"./Typography-D9aOS4L9.js";import{F as _}from"./Fade-CwyH9ByJ.js";import{G as o}from"./Grid-B8p_XyNn.js";import{C as h}from"./Card-DF9nCZsV.js";import{C as I}from"./CardContent-C53nuT2n.js";import{G as je}from"./Grow-CwDNX7JD.js";import{R as U,B as ve,C as ye,X as Ce,Y as Se,T as H,a as we,P as _e,b as Ie,c as ke}from"./PieChart-GeTHi4RA.js";import{T as g}from"./TextField-C5FPbCxz.js";import{I as qe}from"./InputAdornment-DSMijJF8.js";import{B as k}from"./Button-CI4PvYH9.js";import{T as Re}from"./TableContainer-DfD3xtBG.js";import{T as We,a as Pe,b as q,c as Ee}from"./TableRow-CqlzVxMY.js";import{T as i}from"./TableCell-CmdScgSd.js";import{C as Te}from"./Chip-Dcvl53u6.js";import{I as Y}from"./IconButton-5suIbhPZ.js";import{M as ze}from"./Modal-B3L5jhwL.js";import{F as R,I as W,S as P}from"./Select-BXe5PBU8.js";import{M as b}from"./MenuItem-BrmMwhAd.js";import"./button-BdWLbofJ.js";import"./clsx-B-dksMZM.js";import"./avatar-SH5xSAMo.js";import"./createLucideIcon-B2A0n4jm.js";import"./index-BeDZ4tg0.js";import"./index-B2CGEqEW.js";import"./index-CDmN9uZR.js";import"./settings-B81NYrWU.js";import"./app-logo-icon-DF-2vurZ.js";import"./DefaultPropsProvider-B9G9mrQg.js";import"./createSimplePaletteValueFilter-BLiQVDB3.js";import"./TransitionGroupContext-zx_Mae6Z.js";import"./useThemeProps-D5Z9mzbb.js";import"./getThemeProps-Ci1Myslq.js";import"./isMuiElement-DUef8CkO.js";import"./useTimeout-CyHmLoFO.js";import"./index-CgN0HgEe.js";import"./useSlot-b8oj5fjv.js";import"./useId-CIKGyZXY.js";import"./ButtonBase-CKxFeLN_.js";import"./CircularProgress-DbGwbuXF.js";import"./ownerDocument-DW-IO8s5.js";import"./Portal-3qAPjvvz.js";import"./index-CPN-dXc6.js";import"./useSlotProps-B7GeVvJr.js";import"./List-e32Tbcmu.js";import"./debounce-Be36O1Ab.js";import"./useControlled-D8uUDMf0.js";import"./listItemTextClasses-BuwBTG13.js";import"./dividerClasses-DyS1-ewh.js";const De=me(e.jsx("path",{d:"M20 2H4c-1 0-2 .9-2 2v3.01c0 .72.43 1.34 1 1.69V20c0 1.1 1.1 2 2 2h14c.9 0 2-.9 2-2V8.7c.57-.35 1-.97 1-1.69V4c0-1.1-1-2-2-2m-5 12H9v-2h6zm5-7H4V4l16-.02z"})),$=["#6366f1","#8b5cf6","#06b6d4","#10b981","#f59e0b","#ef4444"],Nr=()=>{const{seguimientos:m,seguimientosAll:E,users:v,paquetes:y,filters:V}=B().props,[T,z]=p.useState(!1),[C,D]=p.useState(!1),[M,F]=p.useState(null),{data:d,setData:l,post:K,put:X,reset:A}=G({nombre_empresa:"",id_user:v.length>0?v[0].id:0,id_paquete:y.length>0?y[0].id:0,estado:"",fecha_inicio:"",fecha_fin:"",descripcion:""}),[S,J]=p.useState(V.search||""),u=p.useMemo(()=>{const r=E??m.data,t=r.length,c=new Set(r.map(s=>s.id_user)).size,j=new Set(r.map(s=>s.id_paquete)).size,oe=r.reduce((s,x)=>{const f=x.usuario.name;return s[f]=(s[f]||0)+1,s},{}),ie=Object.entries(oe).map(([s,x])=>({name:s.split(" ").slice(0,2).join(" "),seguimientos:x})),ae=r.reduce((s,x)=>{var O;const f=((O=x.paquete)==null?void 0:O.nombre_paquete)||"Sin paquete";return s[f]=(s[f]||0)+1,s},{}),ne=Object.entries(ae).map(([s,x])=>({name:s,value:x}));return{totalSeguimientos:t,totalUsuarios:c,totalPaquetes:j,barData:ie,pieData:ne}},[E,m.data]),Q=r=>{const t=r.target.value;J(t),L.get(route("seguimiento-empresa.index"),{search:t},{replace:!0,preserveState:!0})},Z=r=>{r?(D(!0),F(r.id),l({nombre_empresa:r.nombre_empresa,id_user:r.id_user,id_paquete:r.id_paquete,estado:r.estado,fecha_inicio:r.fecha_inicio,fecha_fin:r.fecha_fin||"",descripcion:r.descripcion||""})):(D(!1),F(null),A()),z(!0)},w=()=>{z(!1),A()},ee=r=>{r.preventDefault();const t=()=>{w(),window.location.reload()};C&&M?X(route("seguimiento-empresa.update",M),{onSuccess:t}):K(route("seguimiento-empresa.store"),{onSuccess:t})},{delete:re}=G(),te=r=>{confirm("¿Estás seguro de que deseas eliminar este seguimiento?")&&re(route("seguimiento-empresa.destroy",r))},se=()=>e.jsx("nav",{"aria-label":"Page navigation",children:e.jsx("ul",{className:"inline-flex items-center -space-x-px",children:m.links.map((r,t)=>e.jsx("li",{children:r.url===null?e.jsx("span",{className:`rounded-lg border border-gray-300 bg-white px-4 py-2 leading-tight text-gray-500 ${r.active?"border-indigo-300 bg-indigo-50 text-indigo-600":""}`,dangerouslySetInnerHTML:{__html:r.label}}):e.jsx("button",{onClick:()=>L.get(r.url,{search:S},{preserveState:!0}),className:`rounded-lg border border-gray-300 bg-white px-4 py-2 leading-tight text-gray-500 transition-colors duration-200 hover:bg-gray-50 hover:text-gray-700 ${r.active?"border-indigo-300 bg-indigo-50 text-indigo-600":""}`,dangerouslySetInnerHTML:{__html:r.label}})},t))})}),N=p.useMemo(()=>{const r={};return m.data.forEach(t=>{const c=t.usuario.id;r[c]||(r[c]={user:t.usuario,seguimientos:[]}),r[c].seguimientos.push(t)}),Object.values(r)},[m.data]);return e.jsxs(ce,{user:B().props.auth.user,header:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"rounded-lg bg-gradient-to-r from-indigo-500 to-purple-600 p-2",children:e.jsx(be,{className:"text-white"})}),e.jsx("h2",{className:"bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-2xl font-bold text-transparent",children:"Seguimiento de Empresas"})]}),children:[e.jsx(le,{title:"Seguimiento de Empresas"}),e.jsx("div",{children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2,bgcolor:"#f5f7fa",px:3,py:2,borderRadius:2,boxShadow:1,mb:2},children:[e.jsx("img",{src:"https://cdn-icons-png.flaticon.com/512/3135/3135715.png",alt:"Empresas",width:40,height:40,style:{borderRadius:"50%",background:"#fff",padding:4,boxShadow:"0 2px 8px #eee"}}),e.jsx(n,{variant:"h5",sx:{fontWeight:700,color:"#1a237e",letterSpacing:1,textShadow:"0 1px 2px #e3e3e3"},children:"Seguimiento de tus Empresas Activas"})]})}),e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[e.jsx(_,{in:!0,timeout:800,children:e.jsxs(o,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(o,{item:!0,xs:12,sm:6,md:4,children:e.jsx(h,{sx:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",transition:"transform 0.3s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:"0 12px 24px rgba(102, 126, 234, 0.3)"}},children:e.jsx(I,{children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx(n,{variant:"h4",sx:{fontWeight:"bold",mb:1},children:u.totalSeguimientos}),e.jsx(n,{variant:"body2",sx:{opacity:.9},children:"Total Seguimientos"})]}),e.jsx(xe,{sx:{fontSize:40,opacity:.8}})]})})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:4,children:e.jsx(h,{sx:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",color:"white",transition:"transform 0.3s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:"0 12px 24px rgba(240, 147, 251, 0.3)"}},children:e.jsx(I,{children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx(n,{variant:"h4",sx:{fontWeight:"bold",mb:1},children:u.totalUsuarios}),e.jsx(n,{variant:"body2",sx:{opacity:.9},children:"Ejecutivos Activos"})]}),e.jsx(ue,{sx:{fontSize:40,opacity:.8}})]})})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:4,children:e.jsx(h,{sx:{background:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",color:"white",transition:"transform 0.3s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:"0 12px 24px rgba(79, 172, 254, 0.3)"}},children:e.jsx(I,{children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx(n,{variant:"h4",sx:{fontWeight:"bold",mb:1},children:u.totalPaquetes}),e.jsx(n,{variant:"body2",sx:{opacity:.9},children:"Paquetes Diferentes"})]}),e.jsx(De,{sx:{fontSize:40,opacity:.8}})]})})})})]})}),e.jsx(je,{in:!0,timeout:1200,children:e.jsxs(o,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(o,{item:!0,xs:12,md:8,children:e.jsxs(h,{sx:{p:3,background:"linear-gradient(145deg, #ffffff 0%, #f8fafc 100%)",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",borderRadius:"16px"},children:[e.jsx(n,{variant:"h6",sx:{mb:3,fontWeight:"bold",color:"#374151"},children:"Seguimientos por Ejecutivo"}),e.jsx(U,{width:"100%",height:300,children:e.jsxs(ve,{data:u.barData,children:[e.jsx(ye,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(Ce,{dataKey:"name",tick:{fontSize:12}}),e.jsx(Se,{tick:{fontSize:12}}),e.jsx(H,{contentStyle:{backgroundColor:"rgba(55, 65, 81, 0.95)",border:"none",borderRadius:"8px",color:"white"}}),e.jsx(we,{dataKey:"seguimientos",fill:"url(#colorGradient)",radius:[4,4,0,0]}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#6366f1",stopOpacity:.9}),e.jsx("stop",{offset:"95%",stopColor:"#8b5cf6",stopOpacity:.7})]})})]})})]})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsxs(h,{sx:{p:3,background:"linear-gradient(145deg, #ffffff 0%, #f8fafc 100%)",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",borderRadius:"16px"},children:[e.jsx(n,{variant:"h6",sx:{mb:3,fontWeight:"bold",color:"#374151"},children:"Distribución por Paquetes"}),e.jsx(U,{width:"100%",height:300,children:e.jsxs(_e,{children:[e.jsx(Ie,{data:u.pieData,cx:"50%",cy:"50%",innerRadius:40,outerRadius:100,paddingAngle:3,dataKey:"value",children:u.pieData.map((r,t)=>e.jsx(ke,{fill:$[t%$.length]},`cell-${t}`))}),e.jsx(H,{contentStyle:{backgroundColor:"rgba(55, 65, 81, 0.95)",border:"none",borderRadius:"8px",color:"white"}})]})})]})})]})}),e.jsx(_,{in:!0,timeout:1400,children:e.jsxs(h,{sx:{overflow:"hidden",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",borderRadius:"16px"},children:[e.jsx(a,{sx:{p:3,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},children:e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:2},children:[e.jsx(g,{label:"Buscar...",variant:"outlined",value:S,onChange:Q,sx:{width:{xs:"100%",sm:"350px"},"& .MuiOutlinedInput-root":{backgroundColor:"rgba(255,255,255,0.1)","& fieldset":{borderColor:"rgba(255,255,255,0.3)"},"&:hover fieldset":{borderColor:"rgba(255,255,255,0.5)"},"&.Mui-focused fieldset":{borderColor:"rgba(255,255,255,0.7)"}},"& .MuiInputLabel-root":{color:"rgba(255,255,255,0.8)"},"& .MuiInputBase-input":{color:"white"}},InputProps:{startAdornment:e.jsx(qe,{position:"start",children:e.jsx(ge,{sx:{color:"rgba(255,255,255,0.7)"}})})}}),e.jsx(a,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:e.jsx(k,{variant:"outlined",startIcon:e.jsx(fe,{}),onClick:()=>{const r=route("seguimiento-empresa.pdf",{search:S});window.open(r,"_blank")},sx:{borderColor:"rgba(255,255,255,0.3)",color:"white","&:hover":{borderColor:"rgba(255,255,255,0.5)",backgroundColor:"rgba(255,255,255,0.1)"}},children:"Generar PDF"})})]})}),e.jsx(Re,{sx:{backgroundColor:"white"},children:e.jsxs(We,{sx:{minWidth:650},children:[e.jsx(Pe,{children:e.jsxs(q,{sx:{backgroundColor:"#f8fafc"},children:[e.jsx(i,{sx:{fontWeight:"bold",color:"#374151",fontSize:"0.95rem"},children:"Usuario"}),e.jsx(i,{sx:{fontWeight:"bold",color:"#374151",fontSize:"0.95rem"},children:"Empresa"}),e.jsx(i,{sx:{fontWeight:"bold",color:"#374151",fontSize:"0.95rem"},children:"Paquete"}),e.jsx(i,{sx:{fontWeight:"bold",color:"#374151",fontSize:"0.95rem"},children:"Estado"}),e.jsx(i,{sx:{fontWeight:"bold",color:"#374151",fontSize:"0.95rem"},children:"Fecha Inicio"}),e.jsx(i,{sx:{fontWeight:"bold",color:"#374151",fontSize:"0.95rem"},children:"Fecha Fin"}),e.jsx(i,{sx:{fontWeight:"bold",color:"#374151",fontSize:"0.95rem"},children:"Acciones"})]})}),e.jsx(Ee,{children:N.length>0?N.map(r=>e.jsx(de.Fragment,{children:r.seguimientos.map((t,c)=>{var j;return e.jsxs(q,{sx:{"&:hover":{backgroundColor:"#f8fafc",transform:"scale(1.001)",transition:"all 0.2s ease"}},children:[c===0?e.jsx(i,{component:"th",scope:"row",rowSpan:r.seguimientos.length,sx:{borderRight:"3px solid #6366f1",backgroundColor:"#f0f4ff",fontWeight:"bold",color:"#374151"},children:r.user.name}):null,e.jsx(i,{sx:{color:"#374151"},children:t.nombre_empresa}),e.jsx(i,{sx:{color:"#374151"},children:(j=t.paquete)==null?void 0:j.nombre_paquete}),e.jsx(i,{children:e.jsx(Te,{label:"En proceso",sx:{background:"linear-gradient(135deg, #ff9800 0%, #f57c00 100%)",color:"white",fontWeight:"bold",borderRadius:"20px"}})}),e.jsx(i,{sx:{color:"#374151"},children:t.fecha_inicio}),e.jsx(i,{sx:{color:"#6b7280"},children:t.fecha_fin||"N/A"}),e.jsx(i,{children:e.jsxs(a,{sx:{display:"flex",gap:1},children:[e.jsx(Y,{onClick:()=>Z(t),sx:{color:"#6366f1","&:hover":{backgroundColor:"#e0e7ff",transform:"scale(1.1)"}},children:e.jsx(he,{})}),e.jsx(Y,{onClick:()=>te(t.id),sx:{color:"#ef4444","&:hover":{backgroundColor:"#fef2f2",transform:"scale(1.1)"}},children:e.jsx(pe,{})})]})})]},t.id)})},r.user.id)):e.jsx(q,{children:e.jsx(i,{colSpan:7,align:"center",sx:{py:4,color:"#6b7280"},children:e.jsx(n,{variant:"h6",children:"No se encontraron seguimientos."})})})})]})}),e.jsx(a,{sx:{p:3,display:"flex",justifyContent:"center",backgroundColor:"#fafbfc"},children:se()})]})})]})}),e.jsx(ze,{open:T,onClose:w,children:e.jsx(_,{in:T,children:e.jsx(a,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:"95%",sm:650},maxHeight:"90vh",overflow:"auto",bgcolor:"background.paper",borderRadius:"20px",boxShadow:"0 20px 60px rgba(0,0,0,0.15)",p:0},children:e.jsxs(a,{component:"form",onSubmit:ee,sx:{display:"flex",flexDirection:"column"},children:[e.jsx(a,{sx:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",p:3,borderRadius:"20px 20px 0 0"},children:e.jsx(n,{variant:"h5",component:"h2",sx:{fontWeight:"bold",textAlign:"center"},children:C?"✏️ Editar Seguimiento":"➕ Crear Seguimiento"})}),e.jsx(a,{sx:{p:4},children:e.jsxs(o,{container:!0,spacing:3,children:[e.jsx(o,{item:!0,xs:12,children:e.jsx(g,{fullWidth:!0,label:"Nombre de Empresa",value:d.nombre_empresa,onChange:r=>l("nombre_empresa",r.target.value),required:!0,variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:"12px"}}})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsxs(R,{fullWidth:!0,required:!0,children:[e.jsx(W,{children:"Usuario"}),e.jsx(P,{value:d.id_user,label:"Usuario",onChange:r=>l("id_user",r.target.value),variant:"outlined",sx:{borderRadius:"12px"},children:v.map(r=>e.jsx(b,{value:r.id,children:r.name},r.id))})]})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsxs(R,{fullWidth:!0,required:!0,children:[e.jsx(W,{children:"Paquete"}),e.jsx(P,{value:d.id_paquete,label:"Paquete",onChange:r=>l("id_paquete",r.target.value),variant:"outlined",sx:{borderRadius:"12px"},children:y.map(r=>e.jsx(b,{value:r.id,children:r.nombre_paquete},r.id))})]})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsxs(R,{fullWidth:!0,required:!0,children:[e.jsx(W,{children:"Estado"}),e.jsxs(P,{value:d.estado,label:"Estado",onChange:r=>l("estado",r.target.value),variant:"outlined",sx:{borderRadius:"12px"},children:[e.jsx(b,{value:"En proceso",children:"En proceso"}),e.jsx(b,{value:"Finalizado",children:"Finalizado"}),e.jsx(b,{value:"Cancelado",children:"Cancelado"})]})]})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(g,{fullWidth:!0,label:"Fecha de Inicio",type:"date",value:d.fecha_inicio,onChange:r=>l("fecha_inicio",r.target.value),required:!0,InputLabelProps:{shrink:!0},variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:"12px"}}})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(g,{fullWidth:!0,label:"Fecha de Fin",type:"date",value:d.fecha_fin,onChange:r=>l("fecha_fin",r.target.value),InputLabelProps:{shrink:!0},variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:"12px"}}})}),e.jsx(o,{item:!0,xs:12,children:e.jsx(g,{fullWidth:!0,label:"Descripción",value:d.descripcion,onChange:r=>l("descripcion",r.target.value),multiline:!0,minRows:2,variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:"12px"}}})})]})}),e.jsxs(a,{sx:{display:"flex",justifyContent:"flex-end",gap:2,p:3,borderTop:"1px solid #f3f4f6",borderRadius:"0 0 20px 20px",background:"#f8fafc"},children:[e.jsx(k,{onClick:w,color:"secondary",variant:"outlined",children:"Cancelar"}),e.jsx(k,{type:"submit",variant:"contained",color:"primary",children:C?"Guardar Cambios":"Crear Seguimiento"})]})]})})})})]})};export{Nr as default};
