import{v as te,r as o,j as e,$ as ae}from"./app-gcPa0s22.js";import{A as le}from"./app-layout-CO_KMSKV.js";import{L as k,P as re,F as oe}from"./pen-line-D-utcuGh.js";import{C as ne}from"./circle-alert-8IBHvfxb.js";import{C as ie}from"./circle-check-big-BMSjRIsl.js";import{B as L}from"./building-2-3QrfMzjI.js";import{V as de}from"./video-2CSQ7Q2x.js";import{P as ce}from"./plus-sLjRNJrt.js";import{C as _}from"./calendar-DFxnBbAc.js";import{S as me}from"./save-D23HWHm-.js";import{S as xe}from"./search-Cnh9SG2M.js";import{F as ue}from"./filter-DIOZ3Juz.js";import{X as he}from"./avatar-DEAtloF7.js";import{E as pe}from"./external-link-CjOIEJ5Y.js";import{T as ge}from"./trash-2-Dll7edYP.js";import"./button-DWmv4xKc.js";import"./clsx-B-dksMZM.js";import"./index-8qmTPeiK.js";import"./index-C3PMNp9i.js";import"./index-BZXrUZ9C.js";import"./createLucideIcon-DtIvEspD.js";import"./settings-COpbVc2A.js";import"./app-logo-icon-TNEIzHJ2.js";import"./createSvgIcon-Bvn2cbuR.js";import"./DefaultPropsProvider-D0UdZHkc.js";const C=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],F=10;function Ge({empresas:x,registros:A}){const M=new Date,V=C[M.getMonth()],X=M.toISOString().split("T")[0],{data:j,setData:u,post:K,reset:H,processing:P}=te({company_id:"",link:"",detalle:"",mes:V,fecha:X}),[U,R]=o.useState(""),[N,D]=o.useState(null),[E,S]=o.useState(A),[h,B]=o.useState(""),[v,I]=o.useState(""),[y,q]=o.useState(""),[w,p]=o.useState(1),[O,Q]=o.useState(!1),[n,T]=o.useState(()=>{const s={};return A.forEach(t=>{var a,l,i;s[t.id]={company_id:t.company.id,link:t.link.link,detalle:t.link.detalle||"",mes:t.mes,fecha:((a=t.fecha)==null?void 0:a.slice(0,10))||"",comprobante_id:((i=(l=t.comprobante)==null?void 0:l.id)==null?void 0:i.toString())||""}}),s}),g=o.useMemo(()=>E.filter(s=>{const t=s.company.name.toLowerCase().includes(h.toLowerCase())||s.link.link.toLowerCase().includes(h.toLowerCase())||(s.link.detalle||"").toLowerCase().includes(h.toLowerCase()),a=!v||s.mes===v,l=!y||s.company.id.toString()===y;return t&&a&&l}),[E,h,v,y]),$=o.useMemo(()=>{const s=(w-1)*F;return g.slice(s,s+F)},[g,w]),G=Math.ceil(g.length/F),W=s=>{const t=x.find(a=>a.name===s);return t?t.id.toString():""},c=s=>{D(s),setTimeout(()=>D(null),3e3)},Y=()=>{B(""),I(""),q(""),p(1)},Z=s=>{s.preventDefault(),K(route("company-links.store"),{onSuccess:t=>{H(),R(""),c("âœ… Registro creado correctamente");const a=t.props.flash.nuevoRegistro;a&&(S(l=>[a,...l]),T(l=>({...l,[a.id]:{company_id:a.company_id,link:a.link.link,detalle:a.link.detalle||"",mes:a.mes,fecha:a.fecha,comprobante_id:a.comprobante_id||""}})))},onError:()=>{c("âŒ Error al crear el registro")}}),window.location.reload()},b=(s,t,a)=>{T(l=>({...l,[s]:{...l[s],[t]:a}}))},f=async s=>{var a;const t=n[s];if(t)try{const l=await fetch(route("company-links.update",s),{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((a=document.querySelector('meta[name="csrf-token"]'))==null?void 0:a.getAttribute("content"))||"",Accept:"application/json"},body:JSON.stringify({company_id:t.company_id,mes:t.mes,fecha:t.fecha,link:t.link,detalle:t.detalle})});if(!l.ok){const d=await l.text();console.error(`Error HTTP ${l.status}:`,d),c("âŒ Error al guardar");return}const i=await l.json();c(i.message||"âœ… Guardado correctamente"),S(d=>d.map(m=>m.id===s?{...m,company_id:t.company_id,mes:t.mes,fecha:t.fecha,link:{...m.link,link:t.link,detalle:t.detalle}}:m))}catch(l){console.error("Error al guardar inline:",l),c("âŒ Error al guardar: "+l.message)}},ee=async s=>{var t;if(confirm("Â¿EstÃ¡s seguro de que deseas eliminar este registro?"))try{if((await fetch(route("company-links.destroy",s),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},body:JSON.stringify({_method:"DELETE"})})).ok){S(i=>i.filter(d=>d.id!==s));const l={...n};delete l[s],T(l),c("ðŸ—‘ Registro eliminado correctamente")}else throw new Error("Error en la respuesta")}catch{c("âŒ Error al eliminar")}},se=s=>{p(s),window.scrollTo({top:0,behavior:"smooth"})};return e.jsxs(le,{children:[e.jsx(ae,{title:"Links por Empresa"}),e.jsx("div",{className:"bg-gradient-to-br from-blue-600 via-blue-700 to-indigo-800 text-white shadow-2xl",children:e.jsx("div",{className:"px-6 py-10",children:e.jsxs("div",{className:"mb-4 flex items-center gap-4",children:[e.jsx("div",{className:"rounded-2xl bg-white/20 p-3 backdrop-blur-sm",children:e.jsx(k,{className:"h-10 w-10"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold tracking-tight",children:"GestiÃ³n de Links"}),e.jsx("p",{className:"mt-2 text-xl text-blue-100",children:"Administra los enlaces y comprobantes de cada empresa"})]})]})})}),e.jsxs("div",{className:"min-h-screen space-y-8 bg-gradient-to-br from-gray-50 to-blue-50/30 p-6",children:[N&&e.jsx("div",{className:"animate-in slide-in-from-right fixed top-4 right-4 z-50 duration-300",children:e.jsx("div",{className:`rounded-xl border-l-4 p-4 shadow-2xl backdrop-blur-sm ${N.includes("âŒ")?"border-red-500 bg-red-50/90 text-red-800":"border-green-500 bg-green-50/90 text-green-800"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[N.includes("âŒ")?e.jsx(ne,{className:"h-5 w-5"}):e.jsx(ie,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:N})]})})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-3",children:[e.jsx("div",{className:"group rounded-2xl border border-blue-100/50 bg-white/80 p-6 shadow-lg backdrop-blur-sm transition-all hover:scale-105 hover:shadow-2xl",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 p-4 shadow-lg",children:e.jsx(L,{className:"h-7 w-7 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Empresas"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:x.length})]})]})}),e.jsx("div",{className:"group rounded-2xl border border-green-100/50 bg-white/80 p-6 shadow-lg backdrop-blur-sm transition-all hover:scale-105 hover:shadow-2xl",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"rounded-xl bg-gradient-to-br from-green-500 to-green-600 p-4 shadow-lg",children:e.jsx(k,{className:"h-7 w-7 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Links"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:E.length})]})]})}),e.jsx("div",{className:"group rounded-2xl border border-purple-100/50 bg-white/80 p-6 shadow-lg backdrop-blur-sm transition-all hover:scale-105 hover:shadow-2xl",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"rounded-xl bg-gradient-to-br from-purple-500 to-purple-600 p-4 shadow-lg",children:e.jsx(de,{className:"h-7 w-7 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Videos Activos"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:g.length})]})]})})]}),e.jsxs("div",{className:"overflow-hidden rounded-2xl border border-gray-200/50 bg-white/80 shadow-2xl backdrop-blur-sm",children:[e.jsx("div",{className:"border-b border-blue-200/50 bg-gradient-to-r from-blue-50/80 to-indigo-50/80 px-8 py-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"rounded-xl bg-blue-600 p-3",children:e.jsx(ce,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-900",children:"Agregar Nuevo Link"}),e.jsx("p",{className:"mt-1 text-blue-700",children:"Completa la informaciÃ³n para registrar un nuevo enlace"})]})]})}),e.jsxs("form",{onSubmit:Z,className:"p-8",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-gray-700",children:[e.jsx(L,{className:"h-5 w-5 text-blue-600"}),"Empresa *"]}),e.jsx("input",{list:"empresa-list",className:"w-full rounded-xl border-2 border-gray-200 p-4 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20",value:U,onChange:s=>{const t=s.target.value;R(t);const a=W(t);u("company_id",a)},required:!0,placeholder:"Selecciona una empresa..."}),e.jsx("datalist",{id:"empresa-list",children:x.map(s=>e.jsx("option",{value:s.name},s.id))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-gray-700",children:[e.jsx(_,{className:"h-5 w-5 text-blue-600"}),"Mes *"]}),e.jsxs("select",{className:"w-full rounded-xl border-2 border-gray-200 p-4 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20",value:j.mes,onChange:s=>u("mes",s.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Seleccione mes"}),C.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-gray-700",children:[e.jsx(_,{className:"h-5 w-5 text-blue-600"}),"Fecha *"]}),e.jsx("input",{type:"date",className:"w-full rounded-xl border-2 border-gray-200 p-4 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20",value:j.fecha,onChange:s=>u("fecha",s.target.value),required:!0})]}),e.jsx("div",{className:"md:col-span-2 lg:col-span-3",children:e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row",children:[e.jsxs("div",{className:"w-full space-y-2 md:w-1/3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-gray-700",children:[e.jsx(k,{className:"h-5 w-5 text-blue-600"}),"Link *"]}),e.jsx("input",{type:"url",className:"w-full rounded-xl border-2 border-gray-200 p-4 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20",value:j.link,onChange:s=>u("link",s.target.value),required:!0,placeholder:"https://www.tiktok.com/"})]}),e.jsxs("div",{className:"w-full space-y-2 md:w-2/3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-gray-700",children:[e.jsx(re,{className:"h-5 w-5 text-blue-600"}),"Detalle"]}),e.jsx("textarea",{className:"w-full resize-none rounded-xl border-2 border-gray-200 p-4 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20",rows:4,value:j.detalle,onChange:s=>u("detalle",s.target.value),placeholder:"DescripciÃ³n adicional del contenido (opcional)"})]})]})})]}),e.jsx("div",{className:"mt-8 flex justify-end",children:e.jsxs("button",{type:"submit",disabled:P,className:"flex items-center gap-3 rounded-xl bg-gradient-to-r from-blue-600 to-blue-700 px-8 py-4 font-bold text-white shadow-xl transition-all duration-200 hover:scale-105 hover:from-blue-700 hover:to-blue-800 hover:shadow-2xl disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx(me,{className:"h-5 w-5"}),P?"Guardando...":"Guardar Link"]})})]})]}),e.jsxs("div",{className:"overflow-hidden rounded-2xl border border-gray-200/50 bg-white/80 shadow-2xl backdrop-blur-sm",children:[e.jsxs("div",{className:"border-b border-blue-200/50 bg-gradient-to-r from-blue-50/80 to-indigo-50/80 px-8 py-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"rounded-xl bg-blue-600 p-3",children:e.jsx(oe,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-blue-900",children:"Registros Existentes"}),e.jsxs("p",{className:"text-blue-700",children:["Mostrando ",$.length," de ",g.length," registros"]})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row",children:[e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"absolute top-1/2 left-3 h-5 w-5 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar por empresa, link o detalle...",className:"w-full rounded-xl border-2 border-gray-200 py-3 pr-4 pl-10 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20 sm:w-80",value:h,onChange:s=>{B(s.target.value),p(1)}})]}),e.jsxs("button",{onClick:()=>Q(!O),className:"flex items-center gap-2 rounded-xl border-2 border-gray-200 px-4 py-3 text-sm font-medium transition-all hover:bg-gray-50",children:[e.jsx(ue,{className:"h-4 w-4"}),"Filtros"]})]})]}),O&&e.jsx("div",{className:"mt-6 rounded-xl bg-white/50 p-6 backdrop-blur-sm",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Filtrar por empresa"}),e.jsxs("select",{className:"w-full rounded-lg border-2 border-gray-200 p-3 text-sm",value:y,onChange:s=>{q(s.target.value),p(1)},children:[e.jsx("option",{value:"",children:"Todas las empresas"}),x.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Filtrar por mes"}),e.jsxs("select",{className:"w-full rounded-lg border-2 border-gray-200 p-3 text-sm",value:v,onChange:s=>{I(s.target.value),p(1)},children:[e.jsx("option",{value:"",children:"Todos los meses"}),C.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:Y,className:"flex items-center gap-2 rounded-lg bg-gray-100 px-4 py-3 text-sm font-medium text-gray-700 transition-all hover:bg-gray-200",children:[e.jsx(he,{className:"h-4 w-4"}),"Limpiar filtros"]})})]})})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-blue-50",children:[e.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),"Empresa"]})}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-4 w-4"}),"Link"]})}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700",children:"Detalle"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4"}),"Mes"]})}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700",children:"Fecha"}),e.jsx("th",{className:"px-6 py-4 text-center text-sm font-bold text-gray-700",children:"Acciones"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:$.map((s,t)=>{var a,l,i,d,m,J,z;return e.jsxs("tr",{className:`transition-all duration-200 hover:bg-blue-50/50 ${t%2===0?"bg-white":"bg-gray-50/50"}`,children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("select",{className:"w-full rounded-lg border-2 border-gray-200 p-3 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20",value:((a=n[s.id])==null?void 0:a.company_id)||"",onChange:r=>b(s.id,"company_id",r.target.value),onBlur:()=>f(s.id),children:x.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"url",className:"flex-1 rounded-lg border-2 border-gray-200 p-3 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20",value:((l=n[s.id])==null?void 0:l.link)||"",onChange:r=>b(s.id,"link",r.target.value),onBlur:()=>f(s.id)}),((i=n[s.id])==null?void 0:i.link)&&e.jsx("a",{href:(d=n[s.id])==null?void 0:d.link,target:"_blank",rel:"noopener noreferrer",className:"rounded-lg p-3 text-blue-600 transition-all hover:bg-blue-50 hover:text-blue-800",children:e.jsx(pe,{className:"h-4 w-4"})})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"text",className:"w-full rounded-lg border-2 border-gray-200 p-3 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20",value:((m=n[s.id])==null?void 0:m.detalle)||"",onChange:r=>b(s.id,"detalle",r.target.value),onBlur:()=>f(s.id),placeholder:"Detalle..."})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("select",{className:"w-full rounded-lg border-2 border-gray-200 p-3 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20",value:((J=n[s.id])==null?void 0:J.mes)||"",onChange:r=>b(s.id,"mes",r.target.value),onBlur:()=>f(s.id),children:C.map(r=>e.jsx("option",{value:r,children:r},r))})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"date",className:"w-full rounded-lg border-2 border-gray-200 p-3 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20",value:((z=n[s.id])==null?void 0:z.fecha)||"",onChange:r=>b(s.id,"fecha",r.target.value),onBlur:()=>f(s.id)})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("button",{onClick:()=>ee(s.id),className:"rounded-lg bg-red-100 p-2 text-red-600 transition-all hover:bg-red-200",title:"Eliminar",children:e.jsx(ge,{className:"h-5 w-5"})})})]},s.id)})})]}),e.jsxs("div",{className:"flex items-center justify-between border-t border-gray-200 bg-white/50 p-6 backdrop-blur-sm",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["PÃ¡gina ",w," de ",G]}),e.jsx("div",{className:"flex items-center gap-3",children:Array.from({length:G},(s,t)=>e.jsx("button",{onClick:()=>se(t+1),className:`rounded-lg px-4 py-2 transition-all ${w===t+1?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-blue-50"}`,children:t+1},t+1))})]})]})]})]})]})}export{Ge as default};
