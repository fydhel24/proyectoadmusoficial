import{q as oe,r as h,v as k,m as R,j as e,$ as te}from"./app-CD9E-bbZ.js";import{A as ae,B as N}from"./app-layout-COwF5H6b.js";import{A as D}from"./Add-B9lRJRZT.js";import{C as se}from"./CalendarToday-H0XV7elc.js";import{R as ie,C as ne,a as le}from"./react-confetti-DYk4aKdK.js";import{C as de}from"./CheckCircle-CqIGrnbs.js";import{E as ce}from"./Edit-Djcb_1T9.js";import{P as pe}from"./Phone-nOBATC9t.js";import{S as xe}from"./Search-CgZJaBxY.js";import{T as me}from"./TrendingUp-a35fjufg.js";import{S as ue}from"./Snackbar-CGButpq0.js";import{A as he}from"./Alert-BG_3imF8.js";import{B as t}from"./Box-CVcGMSkq.js";import{A as H}from"./Avatar-CZd4mcNo.js";import{T as s}from"./Typography-By0alPKt.js";import{T as f}from"./TextField-9oMor64V.js";import{I as A}from"./InputAdornment-BeoegRXQ.js";import{I as w}from"./IconButton-DiPGKdqW.js";import{B as y}from"./Button-B5LXeRdv.js";import{G as l}from"./Grid-DalPBddd.js";import{P as fe}from"./Pagination-Bfg2FCZS.js";import{M as ge}from"./Modal-CYSRzaAf.js";import{F as M,I as O,S as B}from"./Select-DUF6zo7n.js";import{M as G}from"./MenuItem-Bj0PPdB2.js";import{C as be}from"./Card-BUwfrOBr.js";import{C as je}from"./CardContent-BpClt2Zs.js";import{C as L}from"./Chip-BO00Q2Ng.js";import{L as ve}from"./LinearProgress-Bt-KrxuD.js";import{D as Ce}from"./Divider-BuOrBC2S.js";import{C as Se}from"./CardActions-j6pztAjk.js";import{T as W}from"./Tooltip-CH9oRG6h.js";import{G as ye}from"./index-1v_uY7ka.js";import"./button-CWGkIcSi.js";import"./clsx-B-dksMZM.js";import"./avatar-Bo5hNCtX.js";import"./createLucideIcon-BFnm19S_.js";import"./index-CNZc9TiR.js";import"./index-D22x5rVx.js";import"./index-QyWvuade.js";import"./settings-B4pFMSEE.js";import"./app-logo-icon-UzDlmedp.js";import"./createSvgIcon-D4wZ9zWM.js";import"./DefaultPropsProvider-C5q1CRrr.js";import"./useTimeout-CXA11xA-.js";import"./useSlot-DQUc0rSZ.js";import"./ClickAwayListener-DZzzNoZS.js";import"./Fade-DiQplUui.js";import"./Grow-DEjLYDfa.js";import"./Close-Axz_85dQ.js";import"./useId-D0rV9K7u.js";import"./ButtonBase-C8IFws74.js";import"./CircularProgress-bOfxmVe8.js";import"./useThemeProps-CGKOtPNv.js";import"./getThemeProps-BRGNcVpE.js";import"./isMuiElement-Bs_62ecA.js";import"./index-iUL8l8GP.js";import"./LastPage-FpI_Pigp.js";import"./useControlled-FXAG56O-.js";import"./Portal-B5VJs0Qr.js";import"./useSlotProps-SlUmAtSs.js";import"./List-D0VMBB5k.js";import"./debounce-Be36O1Ab.js";import"./listItemTextClasses-2pnXth07.js";import"./dividerClasses-Bt0KY5G0.js";import"./Popper-BXfmLLmL.js";const we=["Sin exito","En proceso","Completado"],_e={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600,bgcolor:"background.paper",boxShadow:24,p:4,borderRadius:"12px",maxHeight:"90vh",overflowY:"auto"},Ee=o=>{switch(o){case"Completado":return{color:"success",bg:"#e8f5e8",text:"#2e7d32"};case"En proceso":return{color:"warning",bg:"#fff3e0",text:"#ef6c00"};case"Sin exito":return{color:"error",bg:"#ffebee",text:"#c62828"};default:return{color:"default",bg:"#f5f5f5",text:"#666"}}},Ie=o=>{switch(o){case"Completado":return 100;case"En proceso":return 50;case"Sin exito":return 25;default:return 0}},ze=({seguimiento:o,onEdit:x,onFinalize:g,onCancel:p,disabled:i})=>{var j;const m=Ee(o.estado),v=Ie(o.estado),[b,_]=h.useState(!1);return e.jsxs(be,{sx:{height:"100%",display:"flex",flexDirection:"column",borderRadius:3,boxShadow:"0 4px 20px rgba(0,0,0,0.08)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",border:"1px solid rgba(0,0,0,0.05)",position:"relative",overflow:"hidden",minWidth:0,wordBreak:"break-word","&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 30px rgba(0,0,0,0.12)"}},children:[e.jsx(t,{sx:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",p:2,color:"white"},children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(H,{sx:{bgcolor:"rgba(255,255,255,0.2)",width:40,height:40},children:e.jsx(N,{})}),e.jsxs(t,{sx:{flexGrow:1},children:[e.jsx(s,{variant:"h6",sx:{fontWeight:600,fontSize:"1.1rem",lineHeight:1.2,textShadow:"0 1px 2px rgba(0,0,0,0.1)"},children:o.nombre_empresa}),e.jsx(s,{variant:"body2",sx:{opacity:.9,fontSize:"0.85rem"},children:(j=o.paquete)==null?void 0:j.nombre_paquete})]})]})}),e.jsxs(je,{sx:{flexGrow:1,p:2.5},children:[e.jsxs(t,{sx:{mb:2.5},children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsx(s,{variant:"body2",color:"text.secondary",fontWeight:500,children:"Estado del proyecto"}),e.jsx(L,{label:o.estado,size:"small",sx:{bgcolor:m.bg,color:m.text,fontWeight:600,fontSize:"0.75rem"}})]}),e.jsx(ve,{variant:"determinate",value:v,sx:{height:6,borderRadius:3,bgcolor:"rgba(0,0,0,0.08)","& .MuiLinearProgress-bar":{borderRadius:3,bgcolor:m.text}}})]}),e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:1.5},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(se,{sx:{fontSize:18,color:"text.secondary"}}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Inicio:"}),e.jsx(s,{variant:"body2",fontWeight:500,children:new Date(o.fecha_inicio).toLocaleDateString("es-ES")})]}),o.celular&&e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(pe,{sx:{fontSize:18,color:"text.secondary"}}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Contacto:"}),e.jsx(s,{variant:"body2",fontWeight:500,children:o.celular})]})]})]}),e.jsx(Ce,{}),e.jsxs(Se,{sx:{p:2,justifyContent:"space-between"},children:[e.jsx(t,{sx:{display:"flex",gap:1},children:o.estado!=="Completado"&&o.estado!=="Sin exito"&&e.jsxs(e.Fragment,{children:[e.jsx(W,{title:"Editar empresa",children:e.jsx(w,{size:"small",onClick:()=>x(o),disabled:i,sx:{bgcolor:"primary.main",color:"white","&:hover":{bgcolor:"primary.dark"}},children:e.jsx(ce,{fontSize:"small"})})}),e.jsx(W,{title:"Completar contrato",children:e.jsx(w,{size:"small",onClick:()=>g(o),disabled:i,sx:{bgcolor:"success.main",color:"white","&:hover":{bgcolor:"success.dark"}},children:e.jsx(de,{fontSize:"small"})})}),e.jsx(W,{title:"Cancelar empresa",children:e.jsx(w,{size:"small",onClick:()=>p(o),disabled:i,sx:{bgcolor:"error.main",color:"white","&:hover":{bgcolor:"error.dark"}},children:e.jsx(ye,{fontSize:"small"})})})]})}),(o.estado==="Sin exito"||o.estado==="Completado")&&e.jsx(L,{label:o.estado==="Sin exito"?"Cancelado":"Completado",size:"small",sx:{bgcolor:m.bg,color:m.text,fontWeight:600}})]})]})},Br=()=>{const{seguimientos:o,paquetes:x,auth:g,filters:p}=oe().props,i=o,[m,v]=h.useState(!1),[b,_]=h.useState(!1),[j,E]=h.useState(null),[n,q]=h.useState((p==null?void 0:p.search)||""),[T,I]=h.useState(!1),P=new Date().toISOString().slice(0,10),{data:u,setData:d,post:$,put:V,reset:F,processing:C,errors:a}=k({nombre_empresa:"",id_user:g.user.id,id_paquete:x.length>0?x[0].id:0,estado:"En proceso",fecha_inicio:P,fecha_fin:"",descripcion:"",celular:""}),{put:Y,processing:U}=k(),{put:J,processing:K}=k();h.useEffect(()=>{const r=setTimeout(()=>{n!==(p==null?void 0:p.search)&&R.get(route("seguimiento-empresa-vendedor.index"),{search:n},{preserveState:!0,preserveScroll:!0,replace:!0})},500);return()=>clearTimeout(r)},[n]);const z=r=>{r?(_(!0),E(r),d({nombre_empresa:r.nombre_empresa,id_user:r.id_user,id_paquete:r.id_paquete,estado:r.estado,fecha_inicio:r.fecha_inicio,fecha_fin:r.fecha_fin||"",descripcion:r.descripcion||"",celular:r.celular||""})):(_(!1),E(null),F(),d({nombre_empresa:"",id_user:g.user.id,id_paquete:x.length>0?x[0].id:0,estado:"En proceso",fecha_inicio:P,fecha_fin:"",descripcion:"",celular:""})),v(!0)},S=()=>{v(!1),E(null),F()},Q=r=>{r.preventDefault(),b&&j?V(route("seguimiento-empresa-vendedor.update",j.id),{onSuccess:()=>{S()},onError:c=>{console.error("Error al actualizar:",c)}}):$(route("seguimiento-empresa-vendedor.store"),{onSuccess:()=>{S()},onError:c=>{console.error("Error al crear:",c)}})},X=r=>{confirm("Â¿EstÃ¡s seguro de que deseas completar este contrato?")&&Y(route("seguimiento-empresa-vendedor.finalize",r.id),{onSuccess:()=>{I(!0)},onError:c=>{console.error("Error al finalizar:",c)}})},Z=r=>{confirm("Â¿EstÃ¡s seguro de que deseas cancelar esta empresa?")&&J(route("seguimiento-empresa-vendedor.cancel",r.id),{onSuccess:()=>{},onError:c=>{console.error("Error al cancelar:",c)}})},ee=(r,c)=>{R.get(route("seguimiento-empresa-vendedor.index"),{page:c,search:n},{preserveState:!0,preserveScroll:!0})},re=()=>{q(""),R.get(route("seguimiento-empresa-vendedor.index"),{},{preserveState:!0,preserveScroll:!0,replace:!0})};return e.jsxs(ae,{user:g.user,header:e.jsx("h2",{className:"text-xl leading-tight font-semibold text-gray-800",children:"Seguimiento de Empresas"}),children:[e.jsx(te,{title:"Seguimiento de Empresas"}),T&&e.jsx(ie,{width:window.innerWidth,height:window.innerHeight,numberOfPieces:300,recycle:!1}),e.jsx(ue,{open:T,autoHideDuration:4e3,onClose:()=>I(!1),anchorOrigin:{vertical:"top",horizontal:"center"},children:e.jsx(he,{elevation:6,variant:"filled",onClose:()=>I(!1),severity:"success",icon:e.jsx(ne,{fontSize:"inherit"}),sx:{fontSize:18,alignItems:"center"},children:"Â¡Felicidades! Has finalizado un contrato exitosamente ðŸŽ‰"})}),e.jsxs(t,{sx:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",p:4,borderRadius:3,mb:4,position:"relative",overflow:"hidden"},children:[e.jsx(t,{sx:{position:"relative",zIndex:1},children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:3,mb:2},children:[e.jsx(H,{sx:{width:60,height:60,bgcolor:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)"},children:e.jsx(me,{sx:{fontSize:32}})}),e.jsxs(t,{children:[e.jsx(s,{variant:"h4",sx:{fontWeight:700,textShadow:"0 2px 4px rgba(0,0,0,0.3)",mb:.5},children:"Seguimiento de Empresas"}),e.jsx(s,{variant:"h6",sx:{opacity:.9,fontWeight:400},children:"Gestiona y monitorea tus contratos activos"})]})]})}),e.jsx(t,{sx:{position:"absolute",top:-20,right:-20,width:150,height:150,borderRadius:"50%",bgcolor:"rgba(255,255,255,0.1)",opacity:.5}}),e.jsx(t,{sx:{position:"absolute",bottom:-30,left:-30,width:100,height:100,borderRadius:"50%",bgcolor:"rgba(255,255,255,0.1)",opacity:.3}})]}),e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:[e.jsxs(t,{sx:{mb:4},children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,gap:2},children:[e.jsx(f,{placeholder:"Buscar por empresa, celular o paquete...",value:n,onChange:r=>q(r.target.value),sx:{flexGrow:1,maxWidth:500,"& .MuiOutlinedInput-root":{borderRadius:3,bgcolor:"white","&:hover":{boxShadow:"0 4px 20px rgba(0,0,0,0.08)"}}},InputProps:{startAdornment:e.jsx(A,{position:"start",children:e.jsx(xe,{})}),endAdornment:n&&e.jsx(A,{position:"end",children:e.jsx(w,{"aria-label":"limpiar bÃºsqueda",onClick:re,edge:"end",size:"small",children:e.jsx(le,{})})})}}),e.jsx(y,{variant:"contained",startIcon:e.jsx(D,{}),onClick:()=>z(),sx:{borderRadius:3,px:3,py:1.5,textTransform:"none",fontWeight:600,background:"linear-gradient(45deg, #667eea 30%, #764ba2 90%)",boxShadow:"0 4px 20px rgba(102, 126, 234, 0.3)","&:hover":{background:"linear-gradient(45deg, #5a67d8 30%, #6b46c1 90%)",boxShadow:"0 6px 25px rgba(102, 126, 234, 0.4)"}},children:"Nueva Empresa"})]}),e.jsxs(s,{variant:"body2",color:"text.secondary",sx:{mb:3},children:["Mostrando ",i.data.length," de ",i.total," empresas",n&&` (filtrado por: "${n}")`]})]}),e.jsx(l,{container:!0,spacing:3,sx:{mb:4,display:"flex",alignItems:"center",justifyContent:"center"},children:i.data.map(r=>e.jsx(l,{item:!0,xs:12,sm:6,lg:4,sx:{display:"flex"},children:e.jsx(ze,{seguimiento:r,onEdit:z,onFinalize:X,onCancel:Z,disabled:C||U||K})},r.id))}),i.data.length===0&&e.jsxs(t,{sx:{textAlign:"center",py:8,bgcolor:"white",borderRadius:3,boxShadow:"0 4px 20px rgba(0,0,0,0.08)"},children:[e.jsx(N,{sx:{fontSize:80,color:"text.secondary",mb:2}}),e.jsx(s,{variant:"h5",color:"text.primary",fontWeight:600,mb:1,children:n?"No se encontraron empresas":"No hay empresas registradas"}),e.jsx(s,{variant:"body1",color:"text.secondary",mb:3,children:n?"Intenta con diferentes tÃ©rminos de bÃºsqueda":'Crea tu primera empresa haciendo clic en "Nueva Empresa"'}),!n&&e.jsx(y,{variant:"contained",startIcon:e.jsx(D,{}),onClick:()=>z(),sx:{borderRadius:3,px:4,py:1.5,textTransform:"none",fontWeight:600,background:"linear-gradient(45deg, #667eea 30%, #764ba2 90%)"},children:"Crear Primera Empresa"})]}),i.last_page>1&&e.jsx(t,{sx:{display:"flex",justifyContent:"center",mt:4},children:e.jsx(fe,{count:i.last_page,page:i.current_page,onChange:ee,color:"primary",showFirstButton:!0,showLastButton:!0,sx:{"& .MuiPaginationItem-root":{borderRadius:2}}})})]})}),e.jsx(ge,{open:m,onClose:S,children:e.jsxs(t,{sx:_e,component:"form",onSubmit:Q,children:[e.jsx(s,{variant:"h6",component:"h2",mb:3,fontWeight:600,children:b?"Editar Empresa":"Crear Nueva Empresa"}),e.jsxs(l,{container:!0,spacing:3,children:[e.jsx(l,{item:!0,xs:12,children:e.jsx(f,{fullWidth:!0,label:"Nombre de Empresa",value:u.nombre_empresa,onChange:r=>d("nombre_empresa",r.target.value),required:!0,error:!!a.nombre_empresa,helperText:a.nombre_empresa,sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(f,{fullWidth:!0,label:"Celular",value:u.celular,onChange:r=>d("celular",r.target.value),placeholder:"Ej: +591 70000000",error:!!a.celular,helperText:a.celular,sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(l,{item:!0,xs:12,children:e.jsxs(M,{fullWidth:!0,required:!0,error:!!a.id_paquete,children:[e.jsx(O,{children:"Paquete"}),e.jsx(B,{value:u.id_paquete,label:"Paquete",onChange:r=>d("id_paquete",r.target.value),sx:{borderRadius:2},children:x.map(r=>e.jsx(G,{value:r.id,children:r.nombre_paquete},r.id))}),a.id_paquete&&e.jsx(s,{variant:"caption",color:"error",sx:{mt:.5,ml:1.5},children:a.id_paquete})]})}),e.jsx(l,{item:!0,xs:12,children:e.jsxs(M,{fullWidth:!0,required:!0,error:!!a.estado,children:[e.jsx(O,{children:"Estado"}),e.jsx(B,{value:u.estado,label:"Estado",onChange:r=>d("estado",r.target.value),sx:{borderRadius:2},children:we.map(r=>e.jsx(G,{value:r,children:r},r))}),a.estado&&e.jsx(s,{variant:"caption",color:"error",sx:{mt:.5,ml:1.5},children:a.estado})]})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(f,{fullWidth:!0,label:"Fecha de Inicio",type:"date",value:u.fecha_inicio,onChange:r=>d("fecha_inicio",r.target.value),InputLabelProps:{shrink:!0},required:!0,error:!!a.fecha_inicio,helperText:a.fecha_inicio,sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(f,{fullWidth:!0,label:"DescripciÃ³n",multiline:!0,rows:4,value:u.descripcion,onChange:r=>d("descripcion",r.target.value),placeholder:"Describe detalles del seguimiento, contactos, notas importantes...",error:!!a.descripcion,helperText:a.descripcion,sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),b&&e.jsx(l,{item:!0,xs:12,children:e.jsx(f,{fullWidth:!0,label:"Fecha de Fin",type:"date",value:u.fecha_fin,onChange:r=>d("fecha_fin",r.target.value),InputLabelProps:{shrink:!0},error:!!a.fecha_fin,helperText:a.fecha_fin||"Solo completar si el seguimiento ya ha finalizado",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})})]}),e.jsxs(t,{sx:{display:"flex",justifyContent:"flex-end",mt:4,gap:2},children:[e.jsx(y,{onClick:S,variant:"outlined",disabled:C,sx:{borderRadius:2,px:3,py:1,textTransform:"none",fontWeight:500},children:"Cancelar"}),e.jsx(y,{type:"submit",variant:"contained",disabled:C,sx:{borderRadius:2,px:3,py:1,textTransform:"none",fontWeight:600,background:"linear-gradient(45deg, #667eea 30%, #764ba2 90%)","&:hover":{background:"linear-gradient(45deg, #5a67d8 30%, #6b46c1 90%)"}},children:C?"Procesando...":b?"Guardar Cambios":"Crear Empresa"})]})]})})]})};export{Br as default};
