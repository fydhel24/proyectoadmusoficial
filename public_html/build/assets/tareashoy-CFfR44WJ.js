import{r as s,a as j,j as e,$ as he}from"./app-BS78KgI9.js";import{A as je,c as ge,b as be,d as tr,B as ir}from"./app-layout-DXAC2WAv.js";import{l as fe}from"./lodash-CPr34kv5.js";import{u as sr,T as m,P as ve}from"./Typography-CcX01ihT.js";import{u as or}from"./index-Vlg2qeMU.js";import{C as ee}from"./Container-C0tUgWAO.js";import{S as ye}from"./Skeleton-CQvgX6d8.js";import{G as n}from"./Grid-rYS9TwvK.js";import{B as o}from"./Box-DUIKlT8z.js";import{F as re}from"./Fade-FGt6R6vx.js";import{B as y}from"./Button-DqXQBeNq.js";import{A as ae}from"./Add--ainIzPA.js";import{S as nr}from"./Slide-BJETzD5t.js";import{A as lr}from"./Alert-B4Vyu2Ut.js";import{S as dr}from"./Stack-D-Gkkt_v.js";import{T as p}from"./TextField-CvGdJWCa.js";import{I as cr}from"./InputAdornment-BT-QByY7.js";import{S as pr}from"./Search-0IMiUOv4.js";import{A as C}from"./Autocomplete-CHiLwGpf.js";import{Z as te}from"./Zoom-sbauqwfM.js";import{C as N}from"./Card-Cu_cYAkA.js";import{F as S,a as T,I as ur,S as xr}from"./Select-9OsFqQh0.js";import{R as E,a as u}from"./RadioGroup-k_8zM7ga.js";import{F as x}from"./FormControlLabel-CLdvIqrW.js";import{C as Ce}from"./Cancel-DP0BWe5k.js";import{S as Se}from"./Save-CWrtrFzm.js";import{A as mr}from"./Avatar-Bg0t12nq.js";import{I as W}from"./IconButton-CZ7CUvid.js";import{C as we}from"./Collapse-C4kprWT0.js";import{C as L}from"./Chip-co4ExwZU.js";import{C as hr}from"./CalendarToday-me7VNsZg.js";import{T as ie}from"./Tooltip-IWvH1ko8.js";import{E as jr}from"./Edit-07f2nKEV.js";import{D as gr}from"./Delete-BBGxcFmB.js";import{S as br}from"./SwapHoriz-C2pFgN47.js";import{M as fr}from"./MenuItem-D3GBDHMT.js";import{F as vr}from"./Fab-YqvAyP3a.js";import{b as g}from"./DefaultPropsProvider-Dk6HDr1M.js";import"./button-oAFDZpeO.js";import"./clsx-B-dksMZM.js";import"./avatar-BWsYigjR.js";import"./createLucideIcon-D-6WHVmO.js";import"./index-Qic-rRyU.js";import"./index--gTV4hvx.js";import"./index-DBd0QHkk.js";import"./settings-DV0Bctrx.js";import"./app-logo-icon-GUvtkzgu.js";import"./createSvgIcon-12aY9Ngm.js";import"./getThemeProps--CMPU-9n.js";import"./useTimeout-oSTK7AfQ.js";import"./useThemeProps-hgA8uWgq.js";import"./isMuiElement-w8fP3KeW.js";import"./useId-DZf0Wwsg.js";import"./ButtonBase-DLk8W6EL.js";import"./CircularProgress-DHT395bS.js";import"./debounce-Be36O1Ab.js";import"./Modal-BH4F5tNL.js";import"./useSlot-DerHgNuN.js";import"./Portal-CCwm8dqL.js";import"./Close-CzLUv769.js";import"./useControlled-wSjlUgLl.js";import"./usePreviousProps-D-3arf61.js";import"./Popper-DnDfq_y6.js";import"./index-BZb61BhM.js";import"./useSlotProps-Cf7xKLKx.js";import"./List-ctjg6MFH.js";import"./Grow-CxMvSjLL.js";import"./SwitchBase-D7t7AbaY.js";import"./FormGroup-CipON7Nh.js";import"./listItemTextClasses-CBB9ZnPp.js";import"./dividerClasses-893dsvZ6.js";function La(){const[k,Ee]=s.useState([]),[F,ke]=s.useState([]),[I,_e]=s.useState([]),[O,Te]=s.useState([]),[We,se]=s.useState(!0),[U,b]=s.useState(null),[z,Fe]=s.useState(""),[P,Ie]=s.useState(""),[A,ze]=s.useState(""),[oe,B]=s.useState(!1),[d,f]=s.useState({titulo:"",prioridad:"",descripcion:"",fecha:"",tipo_id:"",company_id:""}),[_,M]=s.useState("aleatoria"),[$,G]=s.useState(""),[ne,H]=s.useState("no"),[q,Z]=s.useState(null),[c,v]=s.useState({titulo:"",prioridad:"",descripcion:"",fecha:"",tipo_id:"",company_id:""}),[le,K]=s.useState("no"),[Pe,Q]=s.useState(null),[R,J]=s.useState(null),[de,ce]=s.useState({}),[pe,Ae]=s.useState({}),[Re,w]=s.useState({}),[De,X]=s.useState(null),[Ne,ue]=s.useState(""),Le=sr();or(Le.breakpoints.down("sm"));const h=s.useCallback(async()=>{se(!0),b(null);try{const[r,a,t,i]=await Promise.all([j.get("/tareas-con-asignaciones"),j.get("/api/tipos"),j.get("/api/companies"),j.get("/api/pasantes")]);Ee(r.data),ke(a.data),_e(t.data),Te(i.data.data)}catch(r){console.error("Error al cargar datos:",r),b("Hubo un error al cargar los datos. Por favor, intenta de nuevo.")}finally{se(!1)}},[]),Oe=s.useCallback(async(r,a)=>{w(t=>({...t,[r]:!0}));try{await j.patch(`/asignaciones/${r}`,{estado:a}),await h()}catch(t){console.error("Error al actualizar estado:",t),b("No se pudo actualizar el estado")}finally{w(t=>({...t,[r]:!1}))}},[h]),Ue=s.useCallback(fe.debounce(async(r,a)=>{w(t=>({...t,[r]:!0}));try{await j.patch(`/asignaciones/${r}`,{detalle:a}),await h()}catch(t){console.error("Error al actualizar detalle:",t),b("No se pudo actualizar el detalle")}finally{w(t=>({...t,[r]:!1}))}},1e3),[h]),Be=s.useCallback(fe.debounce(async(r,a)=>{w(t=>({...t,[r]:!0}));try{await j.patch(`/tareas/${r}/descripcion`,{descripcion:a}),await h(),X(null)}catch(t){console.error("Error al actualizar descripci√≥n:",t),b("No se pudo actualizar la descripci√≥n")}finally{w(t=>({...t,[r]:!1}))}},1e3),[h]),xe=s.useMemo(()=>{const r=new Date().toISOString().split("T")[0];let a=k.filter(t=>t.fecha===r);return z&&(a=a.filter(t=>t.titulo.toLowerCase().includes(z.toLowerCase()))),A&&(a=a.filter(t=>t.prioridad===A)),P&&(a=a.filter(t=>t.asignados.some(i=>i.user_name===P))),a},[k,z,A,P]),D=s.useMemo(()=>{const r={};return xe.forEach(a=>{a.asignados.forEach(t=>{const i=t.user_name;r[i]||(r[i]=[]),r[i].push(a)})}),r},[xe]),Me=s.useMemo(()=>{const r=new Set;return k.forEach(a=>{a.asignados.forEach(t=>{r.add(t.user_name)})}),Array.from(r).sort()},[k]);s.useEffect(()=>{h()},[h]),s.useEffect(()=>{const r={};Object.keys(D).forEach(a=>{r[a]=!0}),ce(r)},[D]);const $e=r=>{ce(a=>({...a,[r]:!a[r]}))},Ge=r=>{Ae(a=>({...a,[r]:!a[r]}))},He=r=>{var a,t;Z(r.id),v({titulo:r.titulo,prioridad:r.prioridad,descripcion:r.descripcion,fecha:r.fecha,tipo_id:(a=r.tipo)!=null&&a.id?String(r.tipo.id):"",company_id:(t=r.company)!=null&&t.id?String(r.company.id):""}),K(r.company?"si":"no")},qe=()=>{Z(null),v({titulo:"",prioridad:"",descripcion:"",fecha:"",tipo_id:"",company_id:""}),K("no")},Ze=async()=>{if(c.titulo.trim())try{const r={...c,tipo_id:c.tipo_id?Number(c.tipo_id):null,company_id:c.company_id?Number(c.company_id):null};await j.put(`/tareas/${q}`,r),Z(null),h()}catch(r){console.error("Error al actualizar tarea:",r),b("Error al actualizar la tarea")}},Ke=async r=>{if(confirm("¬øEst√°s seguro de que deseas eliminar esta tarea?"))try{await j.delete(`/tareas/${r}`),h()}catch(a){console.error("Error al eliminar tarea:",a),b("Error al eliminar la tarea")}},Y=()=>{B(!0),f({titulo:"",prioridad:"",descripcion:"",fecha:new Date().toISOString().split("T")[0],tipo_id:"",company_id:""}),H("no")},Qe=()=>{B(!1),f({titulo:"",prioridad:"",descripcion:"",fecha:"",tipo_id:"",company_id:""}),H("no"),M("aleatoria"),G("")},Je=async()=>{if(d.titulo.trim())try{const r={...d,tipo_id:d.tipo_id?Number(d.tipo_id):null,company_id:d.company_id?Number(d.company_id):null,asignacion_aleatoria:_==="aleatoria",pasante_id:_==="manual"?Number($):null};console.log("üü¶ Payload que se env√≠a al backend:",r),await j.post("/create/tareas",r),B(!1),h(),M("aleatoria"),G("")}catch(r){console.error("Error al crear tarea:",r),b("Error al crear la tarea")}},Xe=async r=>{if(R)try{const a=k.find(i=>i.id===r);if(!a||!a.asignados.length)return;const t=a.asignados[0].id;await j.delete(`/asignaciones/reasignar/${t}`,{data:{user_id:R}}).then(i=>{console.log(i.data.message)}).catch(i=>{console.error("Error al reasignar:",i)}),Q(null),J(null),h()}catch(a){console.error("Error al cambiar pasante:",a),b("Error al cambiar el pasante")}},Ye=r=>{X(r.id),ue(r.descripcion||"")},me=r=>{switch(r.toLowerCase()){case"alta":return"#FF1744";case"media":return"#FF9100";case"baja":return"#00E676";default:return"#9E9E9E"}},Ve=r=>{const a=["#1976d2","#1565c0","#0d47a1","#2196f3","#0288d1","#01579b","#03a9f4","#00b0ff","#0091ea","#3f51b5"],t=r.charCodeAt(0)%a.length;return a[t]},er=r=>r.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2),rr=`
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    `;return We?e.jsxs(je,{breadcrumbs:[{title:"Tareas",href:"/tareas"}],children:[e.jsx(he,{title:"Tareas"}),e.jsxs(ee,{maxWidth:"xl",sx:{py:4},children:[e.jsx(ye,{variant:"rectangular",height:60,sx:{mb:2,borderRadius:1}}),e.jsx(n,{container:!0,spacing:2,children:[...Array(7)].map((r,a)=>e.jsx(n,{item:!0,xs:12,sm:6,md:!0,children:e.jsx(ye,{variant:"rectangular",height:400,sx:{borderRadius:2}})},a))})]})]}):e.jsxs(je,{breadcrumbs:[{title:"Tareas",href:"/tareas"}],children:[e.jsx(he,{title:"Tareas"}),e.jsx("style",{children:rr}),e.jsx(o,{sx:{background:"linear-gradient(135deg, #1976d2 0%, #0d47a1 100%)",color:"white",py:3,position:"relative",overflow:"hidden"},children:e.jsx(ee,{maxWidth:"xl",sx:{position:"relative",zIndex:1},children:e.jsx(re,{in:!0,timeout:800,children:e.jsxs(o,{children:[e.jsx(m,{variant:"h4",fontWeight:"bold",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:"üìÖ Tareas de Hoy"}),e.jsx(m,{variant:"subtitle1",sx:{opacity:.9},children:"Gestiona y edita tus tareas del d√≠a de manera eficiente"}),e.jsxs(o,{sx:{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap"},children:[e.jsx(o,{sx:{flexGrow:1}}),e.jsx(o,{sx:{display:"flex",gap:1},children:e.jsx(y,{variant:"contained",onClick:Y,startIcon:e.jsx(ae,{}),sx:{borderRadius:2,background:"linear-gradient(45deg, #1976d2 0%, #0d47a1 100%)","&:hover":{background:"linear-gradient(45deg, #1565c0 0%, #0a3880 100%)"},px:3,py:1},children:"Nueva Tarea Para Hoy"})})]})]})})})}),e.jsxs(ee,{maxWidth:"xl",sx:{py:3},children:[U&&e.jsx(nr,{direction:"down",in:!!U,children:e.jsx(lr,{severity:"error",sx:{mb:3,borderRadius:2},action:e.jsx(y,{color:"inherit",size:"small",onClick:h,children:"Reintentar"}),children:U})}),e.jsx(ve,{elevation:0,sx:{p:3,mb:3,borderRadius:3,background:"linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%)",border:"1px solid rgba(0,0,0,0.05)",boxShadow:"0 4px 20px rgba(0,0,0,0.08)"},children:e.jsx(dr,{spacing:3,children:e.jsxs(n,{container:!0,spacing:2,children:[e.jsx(n,{item:!0,xs:12,md:4,children:e.jsx(p,{fullWidth:!0,placeholder:"Buscar tareas...",value:z,onChange:r=>Fe(r.target.value),InputProps:{startAdornment:e.jsx(cr,{position:"start",children:e.jsx(pr,{})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(n,{item:!0,xs:12,md:4,children:e.jsx(C,{options:Me,getOptionLabel:r=>r,value:P||null,onChange:(r,a)=>Ie(a||""),clearOnEscape:!0,sx:{minWidth:300},renderInput:r=>e.jsx(p,{...r,label:"üë§ Filtrar por Usuario",placeholder:"Filtrar por usuario",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,md:4,children:e.jsx(C,{options:["alta","media","baja"],getOptionLabel:r=>r.charAt(0).toUpperCase()+r.slice(1),value:A||null,onChange:(r,a)=>ze(a||""),clearOnEscape:!0,sx:{minWidth:300},renderInput:r=>e.jsx(p,{...r,label:"‚ö° Filtrar por Prioridad",placeholder:"Filtrar por prioridad",fullWidth:!0})})})]})})}),oe&&e.jsx(te,{in:!0,children:e.jsxs(N,{sx:{mb:3,borderRadius:3,border:"2px solid #1976d2",boxShadow:"0 6px 24px rgba(25, 118, 210, 0.15)"},children:[e.jsxs(o,{sx:{p:3,background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",color:"white"},children:[e.jsx(m,{variant:"h5",fontWeight:"bold",children:"‚ú® Nueva Tarea para Hoy"}),e.jsx(m,{variant:"body2",sx:{opacity:.9},children:"Completa los campos para crear la tarea"})]}),e.jsx(o,{sx:{p:4,background:"white"},children:e.jsxs(n,{container:!0,spacing:3,children:[e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(p,{label:"üìù T√≠tulo",value:d.titulo,onChange:r=>f({...d,titulo:r.target.value}),fullWidth:!0,required:!0})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(p,{label:"üìÖ Fecha",type:"date",value:d.fecha,onChange:r=>f({...d,fecha:r.target.value}),fullWidth:!0,InputLabelProps:{shrink:!0}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(C,{options:F,getOptionLabel:r=>r.nombre,value:F.find(r=>r.id===Number(d.tipo_id))||null,onChange:(r,a)=>f({...d,tipo_id:a?String(a.id):""}),sx:{minWidth:280},renderInput:r=>e.jsx(p,{...r,label:"üè∑Ô∏è Tipo de tarea",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(S,{component:"fieldset",children:[e.jsx(T,{children:"‚ö° Prioridad"}),e.jsxs(E,{row:!0,value:d.prioridad,onChange:r=>f({...d,prioridad:r.target.value}),children:[e.jsx(x,{value:"alta",control:e.jsx(u,{}),label:"Alta"}),e.jsx(x,{value:"media",control:e.jsx(u,{}),label:"Media"}),e.jsx(x,{value:"baja",control:e.jsx(u,{}),label:"Baja"})]})]})}),e.jsx(n,{item:!0,xs:12,children:e.jsxs(S,{component:"fieldset",children:[e.jsx(T,{children:"üë• Asignaci√≥n"}),e.jsxs(E,{row:!0,value:_,onChange:r=>M(r.target.value),children:[e.jsx(x,{value:"aleatoria",control:e.jsx(u,{}),label:"Aleatoria"}),e.jsx(x,{value:"manual",control:e.jsx(u,{}),label:"Manual"})]})]})}),_==="manual"&&e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(C,{options:O,getOptionLabel:r=>`${r.name} (${r.email})`,value:O.find(r=>String(r.id)===$)||null,onChange:(r,a)=>G(a?String(a.id):""),sx:{minWidth:300},renderInput:r=>e.jsx(p,{...r,label:"üßë‚Äçüíº Seleccionar Pasante",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(S,{component:"fieldset",children:[e.jsx(T,{children:"üè¢ ¬øAsignar empresa?"}),e.jsxs(E,{row:!0,value:ne,onChange:r=>{H(r.target.value),r.target.value==="no"&&f({...d,company_id:""})},children:[e.jsx(x,{value:"si",control:e.jsx(u,{}),label:"S√≠"}),e.jsx(x,{value:"no",control:e.jsx(u,{}),label:"No"})]})]})}),ne==="si"&&e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(C,{options:I,getOptionLabel:r=>r.nombre||r.name||"",value:I.find(r=>r.id===Number(d.company_id))||null,onChange:(r,a)=>f({...d,company_id:a?String(a.id):""}),sx:{minWidth:300},renderInput:r=>e.jsx(p,{...r,label:"üè¢ Seleccionar Empresa",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(p,{label:"üìÑ Descripci√≥n",multiline:!0,rows:3,value:d.descripcion,onChange:r=>f({...d,descripcion:r.target.value}),fullWidth:!0})}),e.jsxs(n,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:2},children:[e.jsx(y,{variant:"outlined",onClick:Qe,startIcon:e.jsx(Ce,{}),sx:{borderRadius:2,px:3,py:1},children:"Cancelar"}),e.jsx(y,{variant:"contained",onClick:Je,disabled:!d.titulo.trim()||_==="manual"&&!$,startIcon:e.jsx(Se,{}),sx:{borderRadius:2,px:3,py:1,background:"linear-gradient(45deg, #4caf50 0%, #2e7d32 100%)","&:hover":{background:"linear-gradient(45deg, #388e3c 0%, #1b5e20 100%)"}},children:"Crear Tarea"})]})]})})]})}),q&&e.jsx(te,{in:!0,children:e.jsxs(N,{sx:{mb:3,borderRadius:3,border:"3px solid #FF9100",boxShadow:"0 8px 32px rgba(255, 145, 0, 0.2)"},children:[e.jsx(o,{sx:{p:3,background:"linear-gradient(135deg, #FF9100 0%, #FF6F00 100%)",color:"white"},children:e.jsx(m,{variant:"h5",fontWeight:"bold",children:"‚úèÔ∏è Editar Tarea"})}),e.jsx(o,{sx:{p:4},children:e.jsxs(n,{container:!0,spacing:3,children:[e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(p,{fullWidth:!0,label:"üìù T√≠tulo",value:c.titulo,onChange:r=>v({...c,titulo:r.target.value}),required:!0})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(p,{type:"date",fullWidth:!0,label:"üìÖ Fecha",value:c.fecha,onChange:r=>v({...c,fecha:r.target.value}),InputLabelProps:{shrink:!0}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(C,{options:F,getOptionLabel:r=>r.nombre,value:F.find(r=>r.id===Number(c.tipo_id))||null,onChange:(r,a)=>v({...c,tipo_id:a?String(a.id):""}),renderInput:r=>e.jsx(p,{...r,label:"üè∑Ô∏è Tipo de tarea",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(S,{component:"fieldset",fullWidth:!0,children:[e.jsx(T,{children:"‚ö° Prioridad"}),e.jsxs(E,{row:!0,value:c.prioridad,onChange:r=>v({...c,prioridad:r.target.value}),children:[e.jsx(x,{value:"alta",control:e.jsx(u,{}),label:"Alta"}),e.jsx(x,{value:"media",control:e.jsx(u,{}),label:"Media"}),e.jsx(x,{value:"baja",control:e.jsx(u,{}),label:"Baja"})]})]})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(S,{component:"fieldset",fullWidth:!0,children:[e.jsx(T,{children:"üè¢ ¬øCambiar empresa?"}),e.jsxs(E,{row:!0,value:le,onChange:r=>{K(r.target.value),r.target.value==="no"&&v({...c,company_id:""})},children:[e.jsx(x,{value:"si",control:e.jsx(u,{}),label:"S√≠"}),e.jsx(x,{value:"no",control:e.jsx(u,{}),label:"No"})]})]})}),le==="si"&&e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(C,{options:I,getOptionLabel:r=>r.nombre||r.name||"",value:I.find(r=>r.id===Number(c.company_id))||null,onChange:(r,a)=>v({...c,company_id:a?String(a.id):""}),sx:{minWidth:300},renderInput:r=>e.jsx(p,{...r,label:"üè¢ Seleccionar Empresa",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,multiline:!0,rows:3,label:"üìÑ Descripci√≥n",value:c.descripcion,onChange:r=>v({...c,descripcion:r.target.value})})}),e.jsx(n,{item:!0,xs:12,children:e.jsxs(o,{sx:{display:"flex",gap:2,justifyContent:"flex-end"},children:[e.jsx(y,{variant:"outlined",startIcon:e.jsx(Ce,{}),onClick:qe,children:"Cancelar"}),e.jsx(y,{variant:"contained",startIcon:e.jsx(Se,{}),onClick:Ze,disabled:!c.titulo.trim(),sx:{background:"linear-gradient(45deg, #FF9100 0%, #FF6F00 100%)"},children:"Actualizar"})]})})]})})]})}),e.jsx(re,{in:!0,children:e.jsx(o,{children:Object.keys(D).length===0?e.jsxs(ve,{sx:{p:6,textAlign:"center",borderRadius:3},children:[e.jsx(m,{variant:"h5",color:"text.secondary",sx:{mb:2},children:"üìù No hay tareas para hoy"}),e.jsx(y,{variant:"contained",startIcon:e.jsx(ae,{}),onClick:Y,children:"Crear primera tarea"})]}):Object.entries(D).map(([r,a],t)=>e.jsx(re,{in:!0,timeout:300+t*100,children:e.jsxs(N,{sx:{mb:3,borderRadius:3,overflow:"hidden"},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:3,background:"linear-gradient(135deg, #1976d2 0%, #2196f3 100%)",color:"white",cursor:"pointer"},onClick:()=>$e(r),children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(mr,{sx:{bgcolor:"white",color:Ve(r),fontWeight:"bold",width:48,height:48},children:er(r)}),e.jsxs(o,{children:[e.jsx(m,{variant:"h5",fontWeight:"bold",children:r}),e.jsxs(m,{variant:"body1",sx:{opacity:.9},children:[a.length," ",a.length===1?"tarea asignada":"tareas asignadas"]})]})]}),e.jsx(W,{sx:{color:"white"},children:de[r]?e.jsx(ge,{}):e.jsx(be,{})})]}),e.jsx(we,{in:de[r]??!0,children:e.jsx(o,{sx:{p:2},children:a.map((i,ar)=>e.jsx(te,{in:!0,style:{transitionDelay:`${ar*100}ms`},children:e.jsxs(N,{sx:{mb:2,borderRadius:2,border:"1px solid rgba(0,0,0,0.1)",borderLeft:`6px solid ${me(i.prioridad)}`},children:[e.jsxs(o,{onClick:()=>Ge(i.id),sx:{p:2,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between","&:hover":{bgcolor:g("#1976d2",.05)}},children:[e.jsxs(o,{sx:{flexGrow:1},children:[e.jsx(m,{variant:"h6",fontWeight:"bold",sx:{mb:1},children:i.titulo}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsx(L,{size:"small",label:i.prioridad.toUpperCase(),sx:{bgcolor:me(i.prioridad),color:"white",fontWeight:"bold"}}),e.jsx(L,{size:"small",icon:e.jsx(hr,{fontSize:"small"}),label:i.fecha,variant:"outlined",color:"primary"}),i.tipo&&e.jsx(L,{size:"small",icon:e.jsx(tr,{fontSize:"small"}),label:i.tipo.nombre_tipo,variant:"outlined",color:"primary"}),i.company&&e.jsx(L,{size:"small",icon:e.jsx(ir,{fontSize:"small"}),label:i.company.name,variant:"outlined",color:"primary"})]})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ie,{title:"npm runr tarea",children:e.jsx(W,{onClick:l=>{l.stopPropagation(),He(i)},size:"small",sx:{bgcolor:g("#1976d2",.1),"&:hover":{bgcolor:g("#1976d2",.2)}},children:e.jsx(jr,{fontSize:"small"})})}),e.jsx(ie,{title:"Eliminar tarea",children:e.jsx(W,{onClick:l=>{l.stopPropagation(),Ke(i.id)},size:"small",color:"error",sx:{bgcolor:g("#f44336",.1),"&:hover":{bgcolor:g("#f44336",.2)}},children:e.jsx(gr,{fontSize:"small"})})}),e.jsx(ie,{title:"Cambiar pasante",children:e.jsx(W,{onClick:l=>{l.stopPropagation(),Q(i.id)},size:"small",sx:{bgcolor:g("#4caf50",.1),"&:hover":{bgcolor:g("#4caf50",.2)}},children:e.jsx(br,{fontSize:"small"})})}),e.jsx(W,{size:"small",sx:{color:"#1976d2"},children:pe[i.id]?e.jsx(ge,{}):e.jsx(be,{})})]})]}),i.id===Pe&&e.jsxs(o,{sx:{p:3,bgcolor:g("#4caf50",.05),borderTop:"1px solid rgba(0,0,0,0.1)"},children:[e.jsx(m,{variant:"h6",sx:{mb:2,color:"#4caf50",fontWeight:"bold"},children:"üîÑ Cambiar Pasante"}),e.jsxs(S,{fullWidth:!0,size:"small",sx:{mb:2},children:[e.jsx(ur,{children:"Nuevo Pasante"}),e.jsx(xr,{value:R??"",onChange:l=>J(Number(l.target.value)),label:"Nuevo Pasante",children:O.map(l=>e.jsxs(fr,{value:l.id,children:[l.name," (",l.email,")"]},l.id))})]}),e.jsxs(o,{sx:{display:"flex",gap:2},children:[e.jsx(y,{variant:"outlined",onClick:()=>{Q(null),J(null)},size:"small",children:"Cancelar"}),e.jsx(y,{variant:"contained",onClick:()=>Xe(i.id),disabled:!R,size:"small",sx:{bgcolor:"#4caf50","&:hover":{bgcolor:"#388e3c"}},children:"Confirmar cambio"})]})]}),e.jsx(we,{in:pe[i.id]??!1,children:e.jsx(o,{sx:{px:3,pb:3},children:e.jsxs(o,{sx:{borderTop:"1px solid rgba(0,0,0,0.1)",pt:2},children:[i.asignados.map(l=>e.jsxs(o,{sx:{mb:3,p:2,borderRadius:2,bgcolor:g("#1976d2",.02),border:"1px solid rgba(25, 118, 210, 0.1)"},children:[e.jsxs(o,{sx:{mb:2},children:[e.jsxs(m,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:"bold"},children:["üìä Estado de la tarea:",Re[l.id]&&e.jsx(o,{component:"span",sx:{ml:1,display:"inline-block",width:16,height:16,border:"2px solid #1976d2",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}})]}),e.jsx(S,{component:"fieldset",size:"small",children:e.jsxs(E,{row:!0,value:l.estado,onChange:V=>Oe(l.id,V.target.value),sx:{gap:2,flexWrap:"wrap"},children:[e.jsx(x,{value:"pendiente",control:e.jsx(u,{size:"small"}),label:"Pendiente"}),e.jsx(x,{value:"en_revision",control:e.jsx(u,{size:"small"}),label:"En revisi√≥n"}),e.jsx(x,{value:"publicada",control:e.jsx(u,{size:"small"}),label:"Publicada"})]})})]}),e.jsxs(o,{sx:{mb:2},children:[e.jsxs(m,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:"bold"},children:["üìù Detalle del progreso del Pasante: ",l.user_name]}),e.jsx(p,{fullWidth:!0,size:"small",multiline:!0,rows:2,placeholder:"Escribe aqu√≠ los detalles del progreso...",defaultValue:l.detalle||"",onChange:V=>Ue(l.id,V.target.value),sx:{"& .MuiOutlinedInput-root":{borderRadius:2,bgcolor:"white"}}})]})]},l.id)),e.jsxs(o,{sx:{mt:2},children:[e.jsx(m,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:"bold"},children:"üìÑ Descripci√≥n de la tarea:"}),De===i.id?e.jsx(p,{fullWidth:!0,multiline:!0,rows:3,value:Ne,onChange:l=>{ue(l.target.value),Be(i.id,l.target.value)},onBlur:()=>X(null),autoFocus:!0,placeholder:"Describe la tarea en detalle..."}):e.jsx(o,{onClick:()=>Ye(i),sx:{p:2,borderRadius:2,bgcolor:"white",border:"1px dashed rgba(25, 118, 210, 0.3)",cursor:"pointer","&:hover":{bgcolor:g("#1976d2",.02),borderColor:"#1976d2"}},children:e.jsx(m,{variant:"body2",color:i.descripcion?"text.primary":"text.secondary",sx:{fontStyle:i.descripcion?"normal":"italic"},children:i.descripcion||"Haz clic para agregar una descripci√≥n..."})})]})]})})})]})},i.id))})})]})},r))})}),!oe&&!q&&e.jsx(vr,{color:"primary",onClick:Y,sx:{position:"fixed",bottom:24,right:24,background:"linear-gradient(45deg, #4caf50 0%, #2e7d32 100%)","&:hover":{background:"linear-gradient(45deg, #388e3c 0%, #1b5e20 100%)",transform:"scale(1.1)"},transition:"all 0.3s ease",zIndex:1e3},children:e.jsx(ae,{})})]})]})}export{La as default};
