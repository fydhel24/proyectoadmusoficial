import{v as Z,r as o,j as e,$ as G,Y as Q}from"./app-Dbgm1Cys.js";import{A as Y}from"./app-layout-BAqUiGdq.js";import{M as J,T as K,l as f,a as X,L as A}from"./leaflet-DF9BCG28.js";import{B as m}from"./Button-BTFeeAot.js";import{D as ee,a as ae,b as se}from"./DialogTitle-Dn-kJldk.js";import{T as E}from"./Typography-DV0OPWt3.js";import{D as te}from"./DialogActions-BgIOAlzo.js";import{u as re}from"./hooks-C--HfQwg.js";import{P as ne}from"./Popup-BAB_fKuu.js";import"./button-VUfDAUvM.js";import"./clsx-B-dksMZM.js";import"./avatar-CB9tcgro.js";import"./createLucideIcon-grKkd-q6.js";import"./index-CvjcBXYl.js";import"./index-Ci46V7cr.js";import"./index-xbONrzeD.js";import"./settings-D32I6i9y.js";import"./app-logo-icon-DhrIv1Jp.js";import"./createSvgIcon-DHN1nQ4X.js";import"./DefaultPropsProvider-C9c97xQp.js";import"./createSimplePaletteValueFilter-Coilo4Ac.js";import"./useId-eWo_Aqxx.js";import"./ButtonBase-C8RYyFwR.js";import"./useTimeout-D_mZ0IGP.js";import"./TransitionGroupContext-BDv0Q03s.js";import"./CircularProgress-YcpOOkO7.js";import"./useSlot-DWWib5Ir.js";import"./Fade-CGfXJtdA.js";import"./Modal-B0qY02xU.js";import"./ownerDocument-DW-IO8s5.js";import"./Portal-CAglvsds.js";const F=A.icon({iconUrl:"/Gflores/ubicacion.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});A.Marker.prototype.options.icon=F;const le={lat:-16.5871,lng:-68.0855},ie=13;function qe({categories:P,paquetes:U}){const{data:t,setData:l,post:R,processing:j,errors:r}=Z({name:"",company_category_id:"",contract_duration:"",description:"",direccion:"",start_date:"",end_date:"",celular:"",contrato:null,monto_mensual:"",logo:null,availability:[{day_of_week:1,start_time:"",end_time:"",turno:"mañana",cantidad:null}],crear_usuario:!1,influencer:"si",paquete_id:""}),[x,v]=o.useState(""),[y,N]=o.useState([]),[w,_]=o.useState(!1),[C,O]=o.useState(null),[k,T]=o.useState(null),q=()=>{l("availability",[...t.availability,{day_of_week:1,start_time:"",end_time:"",turno:"mañana",cantidad:null}])},S=(a,s,n)=>{const c=[...t.availability];c[a]={...c[a],[s]:n},l("availability",c)},$=a=>{t.availability.length!==1&&l("availability",t.availability.filter((s,n)=>n!==a))},z=a=>{a.preventDefault(),R("/companies")},[B,p]=o.useState(!1),[i,h]=o.useState(null),[L,u]=o.useState(""),I=()=>{if(u(""),p(!0),t.direccion){const[a,s]=t.direccion.split(",").map(Number);h(new f.LatLng(a,s))}},M=()=>{p(!1)},V=()=>{if(!i){u("Por favor seleccione una ubicación en el mapa");return}const a=Number(i.lat.toFixed(6)),s=Number(i.lng.toFixed(6));l("direccion",`${a},${s}`),p(!1),u("")};function H(){const a=re({dblclick(s){s.originalEvent.preventDefault();const{lat:n,lng:c}=s.latlng,d=new f.LatLng(Number(n.toFixed(6)),Number(c.toFixed(6)));h(d),u("")}});return o.useEffect(()=>{i&&a.setView(i,a.getZoom())},[i]),i?e.jsx(X,{position:i,icon:F,children:e.jsx(ne,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{children:"Ubicación seleccionada"}),e.jsxs("small",{children:[i.lat.toFixed(6),", ",i.lng.toFixed(6)]})]})})}):null}const D=async a=>{if(a.trim()){_(!0);try{const n=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(a)}&limit=5`)).json();N(n)}catch(s){console.error("Error searching location:",s)}finally{_(!1)}}},W=a=>{const s=new f.LatLng(Number(a.lat),Number(a.lon));h(s),N([]),v("")};return e.jsxs(Y,{children:[e.jsx(G,{title:"Crear Empresa"}),e.jsxs("div",{className:"mx-auto max-w-3xl rounded-xl bg-gradient-to-br from-white via-blue-50 to-blue-100 p-8 shadow-2xl ring-1 ring-blue-100",children:[e.jsx("h1",{className:"mb-6 text-center text-3xl font-extrabold text-blue-700",children:"Crear nueva Empresa"}),e.jsxs("form",{onSubmit:z,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nombre de la Empresa"}),e.jsx("input",{type:"text",className:"mt-2 w-full rounded-md border border-gray-300 p-3 shadow transition focus:border-blue-500 focus:ring-2 focus:ring-blue-300 focus:outline-none",value:t.name,onChange:a=>l("name",a.target.value)}),r.name&&e.jsx("div",{className:"mt-1 text-red-600",children:r.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Categoría"}),e.jsxs("select",{className:"mt-2 w-full rounded-md border border-gray-300 p-3 shadow transition focus:border-blue-500 focus:ring-2 focus:ring-blue-300 focus:outline-none",value:t.company_category_id,onChange:a=>l("company_category_id",a.target.value),children:[e.jsx("option",{value:"",children:"Seleccione una categoría"}),P.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),r.company_category_id&&e.jsx("div",{className:"mt-1 text-red-600",children:r.company_category_id})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Duración del contrato"}),e.jsx("input",{type:"text",className:"mt-2 w-full rounded-md border border-gray-300 p-3 shadow transition focus:border-blue-500 focus:ring-2 focus:ring-blue-300 focus:outline-none",value:t.contract_duration,onChange:a=>l("contract_duration",a.target.value)}),r.contract_duration&&e.jsx("div",{className:"mt-1 text-red-600",children:r.contract_duration})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Fecha de inicio"}),e.jsx("input",{type:"date",className:"mt-2 w-full rounded-md border border-gray-300 p-3 shadow transition focus:border-blue-500 focus:ring-2 focus:ring-blue-300 focus:outline-none",value:t.start_date,onChange:a=>l("start_date",a.target.value)}),r.start_date&&e.jsx("div",{className:"mt-1 text-red-600",children:r.start_date})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Fecha de fin"}),e.jsx("input",{type:"date",className:"mt-2 w-full rounded-md border border-gray-300 p-3 shadow transition focus:border-blue-500 focus:ring-2 focus:ring-blue-300 focus:outline-none",value:t.end_date,onChange:a=>l("end_date",a.target.value)}),r.end_date&&e.jsx("div",{className:"mt-1 text-red-600",children:r.end_date})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Dirección",e.jsx("span",{className:"ml-1 text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",className:"mt-2 w-full rounded-md border border-gray-300 p-3 shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none",value:t.direccion,placeholder:"Seleccione una ubicación en el mapa",readOnly:!0}),e.jsx(m,{variant:"contained",color:"primary",onClick:I,children:"Seleccionar Ubicación"})]}),r.direccion&&e.jsx("div",{className:"mt-1 text-red-600",children:r.direccion})]}),e.jsxs(ee,{open:B,onClose:M,maxWidth:"md",fullWidth:!0,children:[e.jsxs(ae,{children:["Seleccionar Ubicación",e.jsx(E,{variant:"caption",component:"div",color:"textSecondary",children:"Haga clic en el mapa para seleccionar la ubicación"})]}),e.jsxs(se,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",className:"w-full rounded-md border border-gray-300 p-2",placeholder:"Buscar ubicación...",value:x,onChange:a=>v(a.target.value),onKeyPress:a=>{a.key==="Enter"&&(a.preventDefault(),D(x))}}),e.jsx(m,{onClick:()=>D(x),variant:"contained",disabled:w,children:w?"Buscando...":"Buscar"})]}),y.length>0&&e.jsx("div",{className:"mt-2 max-h-40 overflow-y-auto rounded-md border border-gray-200",children:y.map((a,s)=>e.jsx("div",{className:"cursor-pointer border-b border-gray-200 p-2 hover:bg-gray-100",onClick:()=>W(a),children:a.display_name},s))})]}),e.jsxs(J,{center:i||le,zoom:ie,style:{height:"400px",width:"100%"},doubleClickZoom:!1,className:"rounded-lg border border-gray-300 shadow-md",children:[e.jsx(K,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),e.jsx(H,{})]}),L&&e.jsx(E,{color:"error",className:"mt-2 text-center",children:L})]}),e.jsxs(te,{children:[e.jsx(m,{onClick:M,color:"secondary",children:"Cancelar"}),e.jsx(m,{onClick:V,color:"primary",disabled:!i,children:"Guardar Ubicación"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"¿Es influencer?"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",name:"influencer",value:"si",checked:t.influencer==="si",onChange:()=>l("influencer","si"),className:"form-radio"}),e.jsx("span",{className:"ml-2",children:"Sí"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",name:"influencer",value:"no",checked:t.influencer==="no",onChange:()=>l("influencer","no"),className:"form-radio"}),e.jsx("span",{className:"ml-2",children:"No"})]})]}),r.influencer&&e.jsx("div",{className:"mt-1 text-red-600",children:r.influencer})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Paquete"}),e.jsxs("select",{className:"w-full rounded-md border border-gray-300 p-3 shadow transition focus:border-blue-500 focus:ring-2 focus:ring-blue-300 focus:outline-none",value:t.paquete_id,onChange:a=>l("paquete_id",a.target.value),children:[e.jsx("option",{value:"",children:"Seleccione un paquete"}),U.map(a=>e.jsx("option",{value:a.id,children:a.nombre_paquete},a.id))]}),r.paquete_id&&e.jsx("div",{className:"mt-1 text-red-600",children:r.paquete_id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Descripción"}),e.jsx("textarea",{className:"mt-2 w-full rounded-md border border-gray-300 p-3 shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none",value:t.description,onChange:a=>l("description",a.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Celular"}),e.jsx("input",{type:"text",className:"mt-2 w-full rounded-md border border-gray-300 p-3 shadow transition focus:border-blue-500 focus:ring-2 focus:ring-blue-300 focus:outline-none",value:t.celular,onChange:a=>{const s=a.target.value;/^\d*$/.test(s)&&l("celular",s)}}),r.celular&&e.jsx("div",{className:"mt-1 text-red-600",children:r.celular})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Monto Mensual"}),e.jsx("input",{type:"text",className:"mt-2 w-full rounded-md border border-gray-300 p-3 shadow transition focus:border-blue-500 focus:ring-2 focus:ring-blue-300 focus:outline-none",value:t.monto_mensual,onChange:a=>{const s=a.target.value;/^\d*\.?\d*$/.test(s)&&l("monto_mensual",s)}}),r.monto_mensual&&e.jsx("div",{className:"mt-1 text-red-600",children:r.monto_mensual})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-8 p-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-lg border p-4 shadow transition hover:shadow-md",children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold",children:"Subir contrato (PDF)"}),e.jsxs("label",{className:"flex h-20 w-full cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed transition hover:border-blue-500",children:[e.jsx("span",{className:"text-gray-600",children:"Haz clic o arrastra un archivo PDF aquí"}),e.jsx("input",{type:"file",accept:"application/pdf",className:"hidden",onChange:a=>{var n;const s=((n=a.target.files)==null?void 0:n[0])||null;l("contrato",s),T(s?URL.createObjectURL(s):null)}})]}),k&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"mb-2 text-sm font-medium text-gray-700",children:"Vista previa:"}),e.jsx("embed",{src:k,type:"application/pdf",width:"100%",height:"400px",className:"rounded border"})]})]}),e.jsxs("div",{className:"rounded-lg border p-4 shadow transition hover:shadow-md",children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold",children:"Subir logo (imagen)"}),e.jsxs("label",{className:"flex h-20 w-full cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed transition hover:border-green-500",children:[e.jsx("span",{className:"text-gray-600",children:"Haz clic o arrastra una imagen aquí"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:a=>{var n;const s=((n=a.target.files)==null?void 0:n[0])||null;l("logo",s),O(s?URL.createObjectURL(s):null)}})]}),C&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"mb-2 text-sm font-medium text-gray-700",children:"Vista previa:"}),e.jsx("img",{src:C,alt:"Vista previa del logo",className:"max-h-48 w-full rounded border object-contain"})]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox",checked:t.crear_usuario,onChange:a=>l("crear_usuario",a.target.checked)}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"¿Desea crear usuario para esta empresa?"})]})}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Días de disponibilidad"}),t.availability.map((a,s)=>e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsxs("div",{className:"grid w-full max-w-3xl grid-cols-1 gap-4 md:grid-cols-4",children:[e.jsxs("select",{className:"col-span-1 w-full rounded-md border border-gray-300 p-3 shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none",value:a.day_of_week,onChange:n=>S(s,"day_of_week",parseInt(n.target.value)),children:[e.jsx("option",{value:1,children:"Lunes"}),e.jsx("option",{value:2,children:"Martes"}),e.jsx("option",{value:3,children:"Miércoles"}),e.jsx("option",{value:4,children:"Jueves"}),e.jsx("option",{value:5,children:"Viernes"}),e.jsx("option",{value:6,children:"Sabado"})]}),e.jsxs("select",{className:"col-span-1 w-full rounded-md border border-gray-300 p-3 shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none",value:a.turno,onChange:n=>{const c=n.target.value;let d="",b="";c==="mañana"?(d="09:30",b="13:00"):(d="14:00",b="18:00");const g=[...t.availability];g[s]={...g[s],turno:c,start_time:d,end_time:b},l("availability",g)},children:[e.jsx("option",{value:"mañana",children:"Mañana"}),e.jsx("option",{value:"tarde",children:"Tarde"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"sr-only",children:"Cantidad"}),e.jsx("input",{type:"number",min:"0",className:"mt-2 w-full rounded-md border border-gray-300 p-3 shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none",placeholder:"Cantidad",value:a.cantidad??"",onChange:n=>S(s,"cantidad",n.target.value===""?null:parseInt(n.target.value,10))})]}),e.jsx("div",{className:"col-span-1 flex items-center justify-center",children:e.jsx("button",{type:"button",className:"text-xl font-bold text-red-600",onClick:()=>$(s),disabled:t.availability.length===1,title:"Eliminar este día",children:"×"})})]})},s)),e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx("button",{type:"button",onClick:q,className:"font-semibold text-blue-600",children:"+ Añadir otro día"})}),Object.keys(r).filter(a=>a.startsWith("availability")).map(a=>e.jsx("div",{className:"text-center text-red-600",children:r[a]},a))]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(Q,{href:"/companies",className:"rounded-md bg-gray-300 px-6 py-2 text-gray-700 transition-colors duration-150 hover:bg-gray-400",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"rounded-md bg-blue-600 px-6 py-2 text-white shadow transition hover:bg-blue-700 focus:ring-2 focus:ring-blue-400 focus:outline-none",disabled:j,children:j?"Creando...":"Crear"})]})]})]})]})}export{qe as default};
