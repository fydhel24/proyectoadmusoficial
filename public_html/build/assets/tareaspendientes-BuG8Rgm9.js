import{r as n,a as j,j as e,$ as V,U as X}from"./app-Dbgm1Cys.js";import{A as Y,B as Z}from"./app-layout-BAqUiGdq.js";import{d as P}from"./debounce-Be36O1Ab.js";import{B as p}from"./Box-DQwU6ab8.js";import{C as z}from"./Container-C115-IaE.js";import{T as d,P as v}from"./Typography-DV0OPWt3.js";import{S as ee}from"./Stack-Ca9bThSC.js";import{T as B}from"./TextField-5zhBnjR1.js";import{I as re}from"./InputAdornment-DdRzzvh-.js";import{S as ae}from"./Search-CK-RKLAz.js";import{F as R,I as M,S as I}from"./Select-hahDP7Ot.js";import{M as c}from"./MenuItem-CGqV-Z3h.js";import{T as te}from"./TableContainer-cShv4u9g.js";import{T as se,a as oe,b as C,c as ie}from"./TableRow-ClLqV3OE.js";import{T as o}from"./TableCell-Ct1vAfOh.js";import{C as m}from"./Chip-BsRV8ZK6.js";import{F as ne}from"./FolderOutlined-CzZ6E66L.js";import{C as le}from"./CalendarToday-IRsxQvcI.js";import{C as de}from"./Collapse-AWKRBFgY.js";import{R as ce,a as S}from"./RadioGroup-BEsa7xNX.js";import{F as T}from"./FormControlLabel-BAAB5OjA.js";import{P as pe}from"./Pagination-RTANfe-N.js";import{b}from"./DefaultPropsProvider-C9c97xQp.js";import{f as me}from"./format-C6wJrPT2.js";import"./button-VUfDAUvM.js";import"./clsx-B-dksMZM.js";import"./avatar-CB9tcgro.js";import"./createLucideIcon-grKkd-q6.js";import"./index-CvjcBXYl.js";import"./index-Ci46V7cr.js";import"./index-xbONrzeD.js";import"./settings-D32I6i9y.js";import"./app-logo-icon-DhrIv1Jp.js";import"./createSvgIcon-DHN1nQ4X.js";import"./useThemeProps-Dvn6hw4m.js";import"./getThemeProps-BPJZLYIt.js";import"./createSimplePaletteValueFilter-Coilo4Ac.js";import"./useSlot-DWWib5Ir.js";import"./TransitionGroupContext-BDv0Q03s.js";import"./useId-eWo_Aqxx.js";import"./isMuiElement-RS1jyFm5.js";import"./index-CECcEVPL.js";import"./useSlotProps-D7EUFeiz.js";import"./List-3R_JF87K.js";import"./ownerDocument-DW-IO8s5.js";import"./Modal-B0qY02xU.js";import"./useTimeout-D_mZ0IGP.js";import"./Portal-CAglvsds.js";import"./Fade-CGfXJtdA.js";import"./Grow-CTlXSWlK.js";import"./useControlled-BHst7y9U.js";import"./ButtonBase-C8RYyFwR.js";import"./listItemTextClasses-DSl55GLA.js";import"./dividerClasses-DzL4-8Pp.js";import"./SwitchBase-Bq6EUGnf.js";import"./FormGroup-DOEP5dGb.js";import"./LastPage-Cv8ePsW2.js";const xe=[{title:"Mis Tareas",href:"/pasante/mistareas"}],W=l=>{if(!l)return"#9E9E9E";switch(l.toLowerCase()){case"alta":return"#FF1744";case"media":return"#FF9100";case"baja":return"#00E676";default:return"#9E9E9E"}},he=l=>{if(!l)return"default";switch(l.toLowerCase()){case"publicada":return"success";case"en_revision":return"primary";case"pendiente":return"warning";default:return"default"}};function gr({tareas:l,total:w,perPage:k,currentPage:A}){const[t,x]=n.useState(l),[L,ue]=n.useState(null),[f,$]=n.useState(""),[h,D]=n.useState(""),[g,_]=n.useState(""),[u,G]=n.useState(""),[O,E]=n.useState(A),q=n.useCallback(P(async(r,a)=>{var s;try{await j.patch(`/tareas/actualizar-estado/${r}`,{detalle:a,estado:((s=t.find(i=>i.id===r))==null?void 0:s.estado)||"pendiente"})}catch(i){console.error("Error al guardar el detalle:",i)}},1e3),[t]),H=async(r,a)=>{var s;try{await j.patch(`/tareas/actualizar-estado/${r}`,{estado:a,detalle:((s=t.find(i=>i.id===r))==null?void 0:s.detalle)||""}),x(t.map(i=>i.id===r?{...i,estado:a}:i))}catch(i){console.error("Error al actualizar el estado:",i)}},N=(r,a)=>{x(t.map(s=>s.id===r?{...s,detalle:a}:s)),q(r,a)},y=n.useCallback(P(async(r,a)=>{try{const s=await j.get("/tareaspendientes",{params:{search:r,priority:a.priority,status:a.status,type:a.type,page:a.page}});x(s.data.tareas),s.data.total!==w&&E(1)}catch(s){console.error("Error al buscar tareas:",s)}},500),[]),U=r=>{const a=r.target.value;$(a),y(a,{priority:h,status:g,type:u,page:1})},F=(r,a)=>{switch(r){case"priority":D(a);break;case"status":_(a);break;case"type":G(a);break}y(f,{priority:r==="priority"?a:h,status:r==="status"?a:g,type:r==="type"?a:u,page:1})},J=(r,a)=>{E(a),y(f,{priority:h,status:g,type:u,page:a})},K=Array.from(new Set((t==null?void 0:t.map(r=>{var a;return(a=r.tarea.tipo)==null?void 0:a.nombre_tipo}).filter(Boolean))||[])),Q=async()=>{try{const r=await j.get("/tareaspendientes",{params:{search:"",priority:"",status:"",type:"",page:1}});x(r.data.tareas)}catch(r){console.error("Error al cargar tareas:",r)}};return n.useEffect(()=>{Q()},[]),e.jsxs(Y,{breadcrumbs:xe,children:[e.jsx(V,{title:"Mis Tareas"}),e.jsx(p,{sx:{background:"linear-gradient(135deg, #1976d2 0%, #0d47a1 100%)",color:"white",py:3,position:"relative",overflow:"hidden"},children:e.jsx(z,{maxWidth:"xl",sx:{position:"relative",zIndex:1},children:e.jsx(d,{variant:"h4",fontWeight:"bold",children:"ðŸ“‹ Tareas Pendientes"})})}),e.jsxs(z,{maxWidth:"xl",sx:{py:4},children:[e.jsx(v,{sx:{p:2,mb:3},children:e.jsx(ee,{spacing:2,children:e.jsxs(p,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(B,{placeholder:"Buscar tareas...",value:f,onChange:U,sx:{flexGrow:1},InputProps:{startAdornment:e.jsx(re,{position:"start",children:e.jsx(ae,{})})}}),e.jsxs(R,{sx:{minWidth:120},children:[e.jsx(M,{children:"Prioridad"}),e.jsxs(I,{value:h,onChange:r=>F("priority",r.target.value),label:"Prioridad",children:[e.jsx(c,{value:"",children:"Todas"}),e.jsx(c,{value:"alta",children:"Alta"}),e.jsx(c,{value:"media",children:"Media"}),e.jsx(c,{value:"baja",children:"Baja"})]})]}),e.jsxs(R,{sx:{minWidth:120},children:[e.jsx(M,{children:"Tipo"}),e.jsxs(I,{value:u,onChange:r=>F("type",r.target.value),label:"Tipo",children:[e.jsx(c,{value:"",children:"Todos"}),K.map(r=>e.jsx(c,{value:r,children:r},r))]})]})]})})}),e.jsx(te,{component:v,sx:{borderRadius:2,boxShadow:2},children:e.jsxs(se,{children:[e.jsx(oe,{children:e.jsxs(C,{sx:{bgcolor:b("#1976d2",.05)},children:[e.jsx(o,{children:"TÃ­tulo"}),e.jsx(o,{children:"Tipo"}),e.jsx(o,{children:"Empresa"}),e.jsx(o,{children:"Fecha"}),e.jsx(o,{children:"Prioridad"}),e.jsx(o,{children:"Estado"})]})}),e.jsx(ie,{children:t==null?void 0:t.map(r=>e.jsxs(X.Fragment,{children:[e.jsxs(C,{sx:{"&:hover":{bgcolor:b("#1976d2",.02)},borderLeft:`4px solid ${W(r.tarea.prioridad)}`},children:[e.jsx(o,{children:e.jsx(d,{variant:"subtitle2",fontWeight:"medium",children:r.tarea.titulo})}),e.jsx(o,{children:r.tarea.tipo&&e.jsx(m,{icon:e.jsx(ne,{sx:{fontSize:16}}),label:r.tarea.tipo.nombre_tipo,size:"small",sx:{bgcolor:b("#1976d2",.1),color:"primary.main"}})}),e.jsx(o,{children:r.tarea.company&&e.jsx(m,{icon:e.jsx(Z,{fontSize:"small"}),label:r.tarea.company.name,size:"small",variant:"outlined"})}),e.jsx(o,{children:e.jsx(m,{icon:e.jsx(le,{fontSize:"small"}),label:me(new Date(r.fecha),"dd/MM/yyyy"),size:"small",variant:"outlined"})}),e.jsx(o,{children:e.jsx(m,{label:r.tarea.prioridad,size:"small",sx:{bgcolor:W(r.tarea.prioridad),color:"white"}})}),e.jsx(o,{children:e.jsx(m,{label:r.estado||"Sin estado",color:he(r.estado),size:"small"})})]}),e.jsx(C,{children:e.jsx(o,{colSpan:7,sx:{py:0},children:e.jsx(de,{in:L===r.id,children:e.jsxs(p,{sx:{p:3},children:[e.jsx(d,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"DescripciÃ³n:"}),e.jsx(d,{variant:"body2",sx:{mb:3},children:r.tarea.descripcion}),e.jsxs(p,{sx:{p:2,bgcolor:b("#1976d2",.05),borderRadius:2},children:[e.jsx(d,{variant:"subtitle2",sx:{mb:2,fontWeight:"bold",color:"primary.main"},children:"Estado de la tarea"}),e.jsxs(ce,{row:!0,value:r.estado||"pendiente",onChange:a=>H(r.id,a.target.value),sx:{mb:2},children:[e.jsx(T,{value:"pendiente",control:e.jsx(S,{color:"warning"}),label:"Pendiente"}),e.jsx(T,{value:"en_revision",control:e.jsx(S,{color:"primary"}),label:"En RevisiÃ³n"}),e.jsx(T,{value:"publicada",control:e.jsx(S,{color:"success"}),label:"publicada"})]}),e.jsx(B,{fullWidth:!0,multiline:!0,rows:2,variant:"outlined",placeholder:"Agregar detalles o comentarios sobre la tarea...",value:r.detalle||"",onChange:a=>N(r.id,a.target.value),sx:{"& .MuiOutlinedInput-root":{bgcolor:"white"}}})]})]})})})},`detail-${r.id}`)]},r.id))})]})}),(t==null?void 0:t.length)===0&&e.jsxs(v,{sx:{p:6,textAlign:"center",borderRadius:3,background:"linear-gradient(145deg, #f8f9fa 0%, #e9ecef 100%)"},children:[e.jsx(d,{variant:"h5",color:"text.secondary",sx:{mb:2},children:"ðŸ“ No tienes tareas asignadas"}),e.jsx(d,{color:"text.secondary",children:"Por el momento no hay tareas asignadas para ti"})]}),(t==null?void 0:t.length)>0&&e.jsx(p,{sx:{mt:3,display:"flex",justifyContent:"center"},children:e.jsx(pe,{count:Math.ceil(w/k),page:O,onChange:J,color:"primary",showFirstButton:!0,showLastButton:!0})})]})]})}export{gr as default};
