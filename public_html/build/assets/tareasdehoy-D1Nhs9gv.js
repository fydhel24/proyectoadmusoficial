import{r as s,a as j,j as e,$ as me}from"./app-CUaISujP.js";import{A as he,c as je,b as ge,d as ar,B as tr}from"./app-layout-CWuB6NnO.js";import{l as be}from"./lodash-CNXKIdpG.js";import{u as ir,T as m,P as fe}from"./Typography-BXYVZiZC.js";import{u as sr}from"./index-UjFnLotG.js";import{C as ee}from"./Container-D7VV_BeN.js";import{S as ve}from"./Skeleton-BYfKkpzH.js";import{G as n}from"./Grid-D22HHTDy.js";import{B as o}from"./Box-F7bZ1tjM.js";import{F as re}from"./Fade-ChnIJY1B.js";import{B as f}from"./Button-BnJ1HrMo.js";import{A as ae}from"./Add-De3J4oTr.js";import{S as or}from"./Slide-Bk05lrAy.js";import{A as nr}from"./Alert-C5OLpzZT.js";import{S as lr}from"./Stack-DTJ6fEPw.js";import{T as p}from"./TextField-k7btXKeC.js";import{I as dr}from"./InputAdornment-BGJDdqNA.js";import{S as cr}from"./Search-C72N3j8E.js";import{A as C}from"./Autocomplete-_ePhfL0R.js";import{Z as te}from"./Zoom-2jsgxgEd.js";import{C as N}from"./Card-WOrh8z9Z.js";import{F as S,a as T,I as pr,S as ur}from"./Select-vcTzVEW7.js";import{R as w,a as u}from"./RadioGroup-pZFucle5.js";import{F as x}from"./FormControlLabel-GJI2qXqz.js";import{C as ye}from"./Cancel-BMr9YuUk.js";import{S as Ce}from"./Save-CFxGaTx-.js";import{A as xr}from"./Avatar-B3oc0cGH.js";import{I as D}from"./IconButton-C9CZ2MaG.js";import{C as Se}from"./Collapse-B0wk9zZQ.js";import{C as L}from"./Chip-3MHDmL7Q.js";import{C as mr}from"./CalendarToday-B5CpGBSs.js";import{T as Ee}from"./Tooltip-CS7sEpaO.js";import{E as hr}from"./Edit-BqoUF0Kc.js";import{S as jr}from"./SwapHoriz-C-mxlvoe.js";import{M as gr}from"./MenuItem-bfQTmTsC.js";import{F as br}from"./Fab-CjDS7-Nb.js";import{b as y}from"./DefaultPropsProvider-DnyQ5W7l.js";import"./button-0Hij8kFa.js";import"./clsx-B-dksMZM.js";import"./avatar-vMY4vQMB.js";import"./createLucideIcon-XVNSMSUw.js";import"./index-DZ5Pi2z6.js";import"./index-b-iRS2c_.js";import"./index-JQPl0ewz.js";import"./settings-CLpIyV6T.js";import"./app-logo-icon-DxXq1G7b.js";import"./createSvgIcon-CsdeE9h-.js";import"./getThemeProps-DVd4S7h3.js";import"./useTimeout-BTm0asfU.js";import"./useThemeProps-DJqCDgEx.js";import"./isMuiElement-6h6e2Qkh.js";import"./TransitionGroupContext-Ci2WFGYL.js";import"./useId-B2OWouFT.js";import"./ButtonBase-DE1CgUJq.js";import"./CircularProgress-nCrY-oKD.js";import"./debounce-Be36O1Ab.js";import"./Modal-ZVwyIF_S.js";import"./ownerDocument-DW-IO8s5.js";import"./useSlot-CYEIGEy5.js";import"./Portal-8nlpaEwd.js";import"./Close-B0CWLwSb.js";import"./useControlled-QlBAzUVK.js";import"./usePreviousProps-CqJPJccm.js";import"./Popper-C5nG_1D4.js";import"./index-Coxc2Kyf.js";import"./useSlotProps-BLv6iqgZ.js";import"./List-C4LEDEwh.js";import"./Grow-B_EMGJuI.js";import"./SwitchBase-C0XU40cX.js";import"./FormGroup-CK6EsC9s.js";import"./listItemTextClasses-D-n0sOX5.js";import"./dividerClasses-Bv3o9dJ8.js";function Da(){const[k,we]=s.useState([]),[W,ke]=s.useState([]),[F,_e]=s.useState([]),[O,Te]=s.useState([]),[We,ie]=s.useState(!0),[U,v]=s.useState(null),[I,Fe]=s.useState(""),[z,Ie]=s.useState(""),[A,ze]=s.useState(""),[se,B]=s.useState(!1),[d,g]=s.useState({titulo:"",prioridad:"",descripcion:"",fecha:"",tipo_id:"",company_id:""}),[_,M]=s.useState("aleatoria"),[$,G]=s.useState(""),[oe,H]=s.useState("no"),[q,Z]=s.useState(null),[c,b]=s.useState({titulo:"",prioridad:"",descripcion:"",fecha:"",tipo_id:"",company_id:""}),[ne,K]=s.useState("no"),[Ae,Q]=s.useState(null),[R,J]=s.useState(null),[le,de]=s.useState({}),[ce,Re]=s.useState({}),[Pe,E]=s.useState({}),[Ne,X]=s.useState(null),[De,pe]=s.useState(""),Le=ir();sr(Le.breakpoints.down("sm"));const h=s.useCallback(async()=>{ie(!0),v(null);try{const[r,a,t,i]=await Promise.all([j.get("/tareas-con-asignaciones"),j.get("/api/tipos"),j.get("/api/companies"),j.get("/api/pasantes")]);we(r.data),ke(a.data),_e(t.data),Te(i.data.data)}catch(r){console.error("Error al cargar datos:",r),v("Hubo un error al cargar los datos. Por favor, intenta de nuevo.")}finally{ie(!1)}},[]),Oe=s.useCallback(async(r,a)=>{E(t=>({...t,[r]:!0}));try{await j.patch(`/asignaciones/${r}`,{estado:a}),await h()}catch(t){console.error("Error al actualizar estado:",t),v("No se pudo actualizar el estado")}finally{E(t=>({...t,[r]:!1}))}},[h]),Ue=s.useCallback(be.debounce(async(r,a)=>{E(t=>({...t,[r]:!0}));try{await j.patch(`/asignaciones/${r}`,{detalle:a}),await h()}catch(t){console.error("Error al actualizar detalle:",t),v("No se pudo actualizar el detalle")}finally{E(t=>({...t,[r]:!1}))}},1e3),[h]),Be=s.useCallback(be.debounce(async(r,a)=>{E(t=>({...t,[r]:!0}));try{await j.patch(`/tareas/${r}/descripcion`,{descripcion:a}),await h(),X(null)}catch(t){console.error("Error al actualizar descripci√≥n:",t),v("No se pudo actualizar la descripci√≥n")}finally{E(t=>({...t,[r]:!1}))}},1e3),[h]),ue=s.useMemo(()=>{const r=new Date().toISOString().split("T")[0];let a=k.filter(t=>t.fecha===r);return I&&(a=a.filter(t=>t.titulo.toLowerCase().includes(I.toLowerCase()))),A&&(a=a.filter(t=>t.prioridad===A)),z&&(a=a.filter(t=>t.asignados.some(i=>i.user_name===z))),a},[k,I,A,z]),P=s.useMemo(()=>{const r={};return ue.forEach(a=>{a.asignados.forEach(t=>{const i=t.user_name;r[i]||(r[i]=[]),r[i].push(a)})}),r},[ue]),Me=s.useMemo(()=>{const r=new Set;return k.forEach(a=>{a.asignados.forEach(t=>{r.add(t.user_name)})}),Array.from(r).sort()},[k]);s.useEffect(()=>{h()},[h]),s.useEffect(()=>{const r={};Object.keys(P).forEach(a=>{r[a]=!0}),de(r)},[P]);const $e=r=>{de(a=>({...a,[r]:!a[r]}))},Ge=r=>{Re(a=>({...a,[r]:!a[r]}))},He=r=>{var a,t;Z(r.id),b({titulo:r.titulo,prioridad:r.prioridad,descripcion:r.descripcion,fecha:r.fecha,tipo_id:(a=r.tipo)!=null&&a.id?String(r.tipo.id):"",company_id:(t=r.company)!=null&&t.id?String(r.company.id):""}),K(r.company?"si":"no")},qe=()=>{Z(null),b({titulo:"",prioridad:"",descripcion:"",fecha:"",tipo_id:"",company_id:""}),K("no")},Ze=async()=>{if(c.titulo.trim())try{const r={...c,tipo_id:c.tipo_id?Number(c.tipo_id):null,company_id:c.company_id?Number(c.company_id):null};await j.put(`/tareas/${q}`,r),Z(null),h()}catch(r){console.error("Error al actualizar tarea:",r),v("Error al actualizar la tarea")}},Y=()=>{B(!0),g({titulo:"",prioridad:"",descripcion:"",fecha:new Date().toISOString().split("T")[0],tipo_id:"",company_id:""}),H("no")},Ke=()=>{B(!1),g({titulo:"",prioridad:"",descripcion:"",fecha:"",tipo_id:"",company_id:""}),H("no"),M("aleatoria"),G("")},Qe=async()=>{if(d.titulo.trim())try{const r={...d,tipo_id:d.tipo_id?Number(d.tipo_id):null,company_id:d.company_id?Number(d.company_id):null,asignacion_aleatoria:_==="aleatoria",pasante_id:_==="manual"?Number($):null};console.log("üü¶ Payload que se env√≠a al backend:",r),await j.post("/create/tareas",r),B(!1),h(),M("aleatoria"),G("")}catch(r){console.error("Error al crear tarea:",r),v("Error al crear la tarea")}},Je=async r=>{if(R)try{const a=k.find(i=>i.id===r);if(!a||!a.asignados.length)return;const t=a.asignados[0].id;await j.delete(`/asignaciones/reasignar/${t}`,{data:{user_id:R}}).then(i=>{console.log(i.data.message)}).catch(i=>{console.error("Error al reasignar:",i)}),Q(null),J(null),h()}catch(a){console.error("Error al cambiar editor:",a),v("Error al cambiar el editor")}},Xe=r=>{X(r.id),pe(r.descripcion||"")},xe=r=>{switch(r.toLowerCase()){case"alta":return"#FF1744";case"media":return"#FF9100";case"baja":return"#00E676";default:return"#9E9E9E"}},Ye=r=>{const a=["#1976d2","#1565c0","#0d47a1","#2196f3","#0288d1","#01579b","#03a9f4","#00b0ff","#0091ea","#3f51b5"],t=r.charCodeAt(0)%a.length;return a[t]},Ve=r=>r.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2),er=`
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    `;return We?e.jsxs(he,{breadcrumbs:[{title:"Tareas",href:"/tareas"}],children:[e.jsx(me,{title:"Tareas"}),e.jsxs(ee,{maxWidth:"xl",sx:{py:4},children:[e.jsx(ve,{variant:"rectangular",height:60,sx:{mb:2,borderRadius:1}}),e.jsx(n,{container:!0,spacing:2,children:[...Array(7)].map((r,a)=>e.jsx(n,{item:!0,xs:12,sm:6,md:!0,children:e.jsx(ve,{variant:"rectangular",height:400,sx:{borderRadius:2}})},a))})]})]}):e.jsxs(he,{breadcrumbs:[{title:"Tareas",href:"/tareas"}],children:[e.jsx(me,{title:"Tareas"}),e.jsx("style",{children:er}),e.jsx(o,{sx:{background:"linear-gradient(135deg, #1976d2 0%, #0d47a1 100%)",color:"white",py:3,position:"relative",overflow:"hidden"},children:e.jsx(ee,{maxWidth:"xl",sx:{position:"relative",zIndex:1},children:e.jsx(re,{in:!0,timeout:800,children:e.jsxs(o,{children:[e.jsx(m,{variant:"h4",fontWeight:"bold",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:"üìÖ Tareas de Hoy"}),e.jsx(m,{variant:"subtitle1",sx:{opacity:.9},children:"Gestiona y edita tus tareas del d√≠a de manera eficienteeee"}),e.jsxs(o,{sx:{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap"},children:[e.jsx(o,{sx:{flexGrow:1}}),e.jsx(o,{sx:{display:"flex",gap:1},children:e.jsx(f,{variant:"contained",onClick:Y,startIcon:e.jsx(ae,{}),sx:{borderRadius:2,background:"linear-gradient(45deg, #1976d2 0%, #0d47a1 100%)","&:hover":{background:"linear-gradient(45deg, #1565c0 0%, #0a3880 100%)"},px:3,py:1},children:"Nueva Tarea Para Hoy"})})]})]})})})}),e.jsxs(ee,{maxWidth:"xl",sx:{py:3},children:[U&&e.jsx(or,{direction:"down",in:!!U,children:e.jsx(nr,{severity:"error",sx:{mb:3,borderRadius:2},action:e.jsx(f,{color:"inherit",size:"small",onClick:h,children:"Reintentar"}),children:U})}),e.jsx(fe,{elevation:0,sx:{p:3,mb:3,borderRadius:3,background:"linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%)",border:"1px solid rgba(0,0,0,0.05)",boxShadow:"0 4px 20px rgba(0,0,0,0.08)"},children:e.jsx(lr,{spacing:3,children:e.jsxs(n,{container:!0,spacing:2,children:[e.jsx(n,{item:!0,xs:12,md:4,children:e.jsx(p,{fullWidth:!0,placeholder:"Buscar tareas...",value:I,onChange:r=>Fe(r.target.value),InputProps:{startAdornment:e.jsx(dr,{position:"start",children:e.jsx(cr,{})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(n,{item:!0,xs:12,md:4,children:e.jsx(C,{options:Me,getOptionLabel:r=>r,value:z||null,onChange:(r,a)=>Ie(a||""),clearOnEscape:!0,sx:{minWidth:300},renderInput:r=>e.jsx(p,{...r,label:"üë§ Filtrar por Usuario",placeholder:"Filtrar por usuario",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,md:4,children:e.jsx(C,{options:["alta","media","baja"],getOptionLabel:r=>r.charAt(0).toUpperCase()+r.slice(1),value:A||null,onChange:(r,a)=>ze(a||""),clearOnEscape:!0,sx:{minWidth:300},renderInput:r=>e.jsx(p,{...r,label:"‚ö° Filtrar por Prioridad",placeholder:"Filtrar por prioridad",fullWidth:!0})})})]})})}),se&&e.jsx(te,{in:!0,children:e.jsxs(N,{sx:{mb:3,borderRadius:3,border:"2px solid #1976d2",boxShadow:"0 6px 24px rgba(25, 118, 210, 0.15)"},children:[e.jsxs(o,{sx:{p:3,background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",color:"white"},children:[e.jsx(m,{variant:"h5",fontWeight:"bold",children:"‚ú® Nueva Tarea para Hoy"}),e.jsx(m,{variant:"body2",sx:{opacity:.9},children:"Completa los campos para crear la tarea"})]}),e.jsx(o,{sx:{p:4,background:"white"},children:e.jsxs(n,{container:!0,spacing:3,children:[e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(p,{label:"üìù T√≠tulo",value:d.titulo,onChange:r=>g({...d,titulo:r.target.value}),fullWidth:!0,required:!0})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(p,{label:"üìÖ Fecha",type:"date",value:d.fecha,onChange:r=>g({...d,fecha:r.target.value}),fullWidth:!0,InputLabelProps:{shrink:!0}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(C,{options:W,getOptionLabel:r=>r.nombre,value:W.find(r=>r.id===Number(d.tipo_id))||null,onChange:(r,a)=>g({...d,tipo_id:a?String(a.id):""}),sx:{minWidth:280},renderInput:r=>e.jsx(p,{...r,label:"üè∑Ô∏è Tipo de tarea",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(S,{component:"fieldset",children:[e.jsx(T,{children:"‚ö° Prioridad"}),e.jsxs(w,{row:!0,value:d.prioridad,onChange:r=>g({...d,prioridad:r.target.value}),children:[e.jsx(x,{value:"alta",control:e.jsx(u,{}),label:"Alta"}),e.jsx(x,{value:"media",control:e.jsx(u,{}),label:"Media"}),e.jsx(x,{value:"baja",control:e.jsx(u,{}),label:"Baja"})]})]})}),e.jsx(n,{item:!0,xs:12,children:e.jsxs(S,{component:"fieldset",children:[e.jsx(T,{children:"üë• Asignaci√≥n"}),e.jsxs(w,{row:!0,value:_,onChange:r=>M(r.target.value),children:[e.jsx(x,{value:"aleatoria",control:e.jsx(u,{}),label:"Aleatoria"}),e.jsx(x,{value:"manual",control:e.jsx(u,{}),label:"Manual"})]})]})}),_==="manual"&&e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(C,{options:O,getOptionLabel:r=>`${r.name} (${r.email})`,value:O.find(r=>String(r.id)===$)||null,onChange:(r,a)=>G(a?String(a.id):""),sx:{minWidth:300},renderInput:r=>e.jsx(p,{...r,label:"üßë‚Äçüíº Seleccionar Editor",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(S,{component:"fieldset",children:[e.jsx(T,{children:"üè¢ ¬øAsignar empresa?"}),e.jsxs(w,{row:!0,value:oe,onChange:r=>{H(r.target.value),r.target.value==="no"&&g({...d,company_id:""})},children:[e.jsx(x,{value:"si",control:e.jsx(u,{}),label:"S√≠"}),e.jsx(x,{value:"no",control:e.jsx(u,{}),label:"No"})]})]})}),oe==="si"&&e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(C,{options:F,getOptionLabel:r=>r.nombre||r.name||"",value:F.find(r=>r.id===Number(d.company_id))||null,onChange:(r,a)=>g({...d,company_id:a?String(a.id):""}),sx:{minWidth:300},renderInput:r=>e.jsx(p,{...r,label:"üè¢ Seleccionar Empresa",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(p,{label:"üìÑ Descripci√≥n",multiline:!0,rows:3,value:d.descripcion,onChange:r=>g({...d,descripcion:r.target.value}),fullWidth:!0})}),e.jsxs(n,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:2},children:[e.jsx(f,{variant:"outlined",onClick:Ke,startIcon:e.jsx(ye,{}),sx:{borderRadius:2,px:3,py:1},children:"Cancelar"}),e.jsx(f,{variant:"contained",onClick:Qe,disabled:!d.titulo.trim()||_==="manual"&&!$,startIcon:e.jsx(Ce,{}),sx:{borderRadius:2,px:3,py:1,background:"linear-gradient(45deg, #4caf50 0%, #2e7d32 100%)","&:hover":{background:"linear-gradient(45deg, #388e3c 0%, #1b5e20 100%)"}},children:"Crear Tarea"})]})]})})]})}),q&&e.jsx(te,{in:!0,children:e.jsxs(N,{sx:{mb:3,borderRadius:3,border:"3px solid #FF9100",boxShadow:"0 8px 32px rgba(255, 145, 0, 0.2)"},children:[e.jsx(o,{sx:{p:3,background:"linear-gradient(135deg, #FF9100 0%, #FF6F00 100%)",color:"white"},children:e.jsx(m,{variant:"h5",fontWeight:"bold",children:"‚úèÔ∏è Editar Tarea"})}),e.jsx(o,{sx:{p:4},children:e.jsxs(n,{container:!0,spacing:3,children:[e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(p,{fullWidth:!0,label:"üìù T√≠tulo",value:c.titulo,onChange:r=>b({...c,titulo:r.target.value}),required:!0})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(p,{type:"date",fullWidth:!0,label:"üìÖ Fecha",value:c.fecha,onChange:r=>b({...c,fecha:r.target.value}),InputLabelProps:{shrink:!0}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(C,{options:W,getOptionLabel:r=>r.nombre,value:W.find(r=>r.id===Number(c.tipo_id))||null,onChange:(r,a)=>b({...c,tipo_id:a?String(a.id):""}),renderInput:r=>e.jsx(p,{...r,label:"üè∑Ô∏è Tipo de tarea",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(S,{component:"fieldset",fullWidth:!0,children:[e.jsx(T,{children:"‚ö° Prioridad"}),e.jsxs(w,{row:!0,value:c.prioridad,onChange:r=>b({...c,prioridad:r.target.value}),children:[e.jsx(x,{value:"alta",control:e.jsx(u,{}),label:"Alta"}),e.jsx(x,{value:"media",control:e.jsx(u,{}),label:"Media"}),e.jsx(x,{value:"baja",control:e.jsx(u,{}),label:"Baja"})]})]})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(S,{component:"fieldset",fullWidth:!0,children:[e.jsx(T,{children:"üè¢ ¬øCambiar empresa?"}),e.jsxs(w,{row:!0,value:ne,onChange:r=>{K(r.target.value),r.target.value==="no"&&b({...c,company_id:""})},children:[e.jsx(x,{value:"si",control:e.jsx(u,{}),label:"S√≠"}),e.jsx(x,{value:"no",control:e.jsx(u,{}),label:"No"})]})]})}),ne==="si"&&e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(C,{options:F,getOptionLabel:r=>r.nombre||r.name||"",value:F.find(r=>r.id===Number(c.company_id))||null,onChange:(r,a)=>b({...c,company_id:a?String(a.id):""}),sx:{minWidth:300},renderInput:r=>e.jsx(p,{...r,label:"üè¢ Seleccionar Empresa",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,multiline:!0,rows:3,label:"üìÑ Descripci√≥n",value:c.descripcion,onChange:r=>b({...c,descripcion:r.target.value})})}),e.jsx(n,{item:!0,xs:12,children:e.jsxs(o,{sx:{display:"flex",gap:2,justifyContent:"flex-end"},children:[e.jsx(f,{variant:"outlined",startIcon:e.jsx(ye,{}),onClick:qe,children:"Cancelar"}),e.jsx(f,{variant:"contained",startIcon:e.jsx(Ce,{}),onClick:Ze,disabled:!c.titulo.trim(),sx:{background:"linear-gradient(45deg, #FF9100 0%, #FF6F00 100%)"},children:"Actualizar"})]})})]})})]})}),e.jsx(re,{in:!0,children:e.jsx(o,{children:Object.keys(P).length===0?e.jsxs(fe,{sx:{p:6,textAlign:"center",borderRadius:3},children:[e.jsx(m,{variant:"h5",color:"text.secondary",sx:{mb:2},children:"üìù No hay tareas para hoy"}),e.jsx(f,{variant:"contained",startIcon:e.jsx(ae,{}),onClick:Y,children:"Crear primera tarea"})]}):Object.entries(P).map(([r,a],t)=>e.jsx(re,{in:!0,timeout:300+t*100,children:e.jsxs(N,{sx:{mb:3,borderRadius:3,overflow:"hidden"},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:3,background:"linear-gradient(135deg, #1976d2 0%, #2196f3 100%)",color:"white",cursor:"pointer"},onClick:()=>$e(r),children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(xr,{sx:{bgcolor:"white",color:Ye(r),fontWeight:"bold",width:48,height:48},children:Ve(r)}),e.jsxs(o,{children:[e.jsx(m,{variant:"h5",fontWeight:"bold",children:r}),e.jsxs(m,{variant:"body1",sx:{opacity:.9},children:[a.length," ",a.length===1?"tarea asignada":"tareas asignadas"]})]})]}),e.jsx(D,{sx:{color:"white"},children:le[r]?e.jsx(je,{}):e.jsx(ge,{})})]}),e.jsx(Se,{in:le[r]??!0,children:e.jsx(o,{sx:{p:2},children:a.map((i,rr)=>e.jsx(te,{in:!0,style:{transitionDelay:`${rr*100}ms`},children:e.jsxs(N,{sx:{mb:2,borderRadius:2,border:"1px solid rgba(0,0,0,0.1)",borderLeft:`6px solid ${xe(i.prioridad)}`},children:[e.jsxs(o,{onClick:()=>Ge(i.id),sx:{p:2,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between","&:hover":{bgcolor:y("#1976d2",.05)}},children:[e.jsxs(o,{sx:{flexGrow:1},children:[e.jsx(m,{variant:"h6",fontWeight:"bold",sx:{mb:1},children:i.titulo}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsx(L,{size:"small",label:i.prioridad.toUpperCase(),sx:{bgcolor:xe(i.prioridad),color:"white",fontWeight:"bold"}}),e.jsx(L,{size:"small",icon:e.jsx(mr,{fontSize:"small"}),label:i.fecha,variant:"outlined",color:"primary"}),i.tipo&&e.jsx(L,{size:"small",icon:e.jsx(ar,{fontSize:"small"}),label:i.tipo.nombre_tipo,variant:"outlined",color:"primary"}),i.company&&e.jsx(L,{size:"small",icon:e.jsx(tr,{fontSize:"small"}),label:i.company.name,variant:"outlined",color:"primary"})]})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Ee,{title:"Editar tarea",children:e.jsx(D,{onClick:l=>{l.stopPropagation(),He(i)},size:"small",sx:{bgcolor:y("#1976d2",.1),"&:hover":{bgcolor:y("#1976d2",.2)}},children:e.jsx(hr,{fontSize:"small"})})}),e.jsx(Ee,{title:"Cambiar editor",children:e.jsx(D,{onClick:l=>{l.stopPropagation(),Q(i.id)},size:"small",sx:{bgcolor:y("#4caf50",.1),"&:hover":{bgcolor:y("#4caf50",.2)}},children:e.jsx(jr,{fontSize:"small"})})}),e.jsx(D,{size:"small",sx:{color:"#1976d2"},children:ce[i.id]?e.jsx(je,{}):e.jsx(ge,{})})]})]}),i.id===Ae&&e.jsxs(o,{sx:{p:3,bgcolor:y("#4caf50",.05),borderTop:"1px solid rgba(0,0,0,0.1)"},children:[e.jsx(m,{variant:"h6",sx:{mb:2,color:"#4caf50",fontWeight:"bold"},children:"üîÑ Cambiar Editor"}),e.jsxs(S,{fullWidth:!0,size:"small",sx:{mb:2},children:[e.jsx(pr,{children:"Seleccionar Nuevo Editor"}),e.jsx(ur,{value:R??"",onChange:l=>J(Number(l.target.value)),label:"Seleccionar Nuevo Editor",children:O.map(l=>e.jsxs(gr,{value:l.id,children:[l.name," (",l.email,")"]},l.id))})]}),e.jsxs(o,{sx:{display:"flex",gap:2},children:[e.jsx(f,{variant:"outlined",onClick:()=>{Q(null),J(null)},size:"small",children:"Cancelar"}),e.jsx(f,{variant:"contained",onClick:()=>Je(i.id),disabled:!R,size:"small",sx:{bgcolor:"#4caf50","&:hover":{bgcolor:"#388e3c"}},children:"Confirmar cambio"})]})]}),e.jsx(Se,{in:ce[i.id]??!1,children:e.jsx(o,{sx:{px:3,pb:3},children:e.jsxs(o,{sx:{borderTop:"1px solid rgba(0,0,0,0.1)",pt:2},children:[i.asignados.map(l=>e.jsxs(o,{sx:{mb:3,p:2,borderRadius:2,bgcolor:y("#1976d2",.02),border:"1px solid rgba(25, 118, 210, 0.1)"},children:[e.jsxs(o,{sx:{mb:2},children:[e.jsxs(m,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:"bold"},children:["üìä Estado de la tarea:",Pe[l.id]&&e.jsx(o,{component:"span",sx:{ml:1,display:"inline-block",width:16,height:16,border:"2px solid #1976d2",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}})]}),e.jsx(S,{component:"fieldset",size:"small",children:e.jsxs(w,{row:!0,value:l.estado,onChange:V=>Oe(l.id,V.target.value),sx:{gap:2,flexWrap:"wrap"},children:[e.jsx(x,{value:"pendiente",control:e.jsx(u,{size:"small"}),label:"Pendiente"}),e.jsx(x,{value:"en_revision",control:e.jsx(u,{size:"small"}),label:"En revisi√≥n"}),e.jsx(x,{value:"publicada",control:e.jsx(u,{size:"small"}),label:"Publicada"})]})})]}),e.jsxs(o,{sx:{mb:2},children:[e.jsxs(m,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:"bold"},children:["üìù Detalle del progreso del Pasante: ",l.user_name]}),e.jsx(p,{fullWidth:!0,size:"small",multiline:!0,rows:2,placeholder:"Escribe aqu√≠ los detalles del progreso...",defaultValue:l.detalle||"",onChange:V=>Ue(l.id,V.target.value),sx:{"& .MuiOutlinedInput-root":{borderRadius:2,bgcolor:"white"}}})]})]},l.id)),e.jsxs(o,{sx:{mt:2},children:[e.jsx(m,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:"bold"},children:"üìÑ Descripci√≥n de la tarea:"}),Ne===i.id?e.jsx(p,{fullWidth:!0,multiline:!0,rows:3,value:De,onChange:l=>{pe(l.target.value),Be(i.id,l.target.value)},onBlur:()=>X(null),autoFocus:!0,placeholder:"Describe la tarea en detalle..."}):e.jsx(o,{onClick:()=>Xe(i),sx:{p:2,borderRadius:2,bgcolor:"white",border:"1px dashed rgba(25, 118, 210, 0.3)",cursor:"pointer","&:hover":{bgcolor:y("#1976d2",.02),borderColor:"#1976d2"}},children:e.jsx(m,{variant:"body2",color:i.descripcion?"text.primary":"text.secondary",sx:{fontStyle:i.descripcion?"normal":"italic"},children:i.descripcion||"Haz clic para agregar una descripci√≥n..."})})]})]})})})]})},i.id))})})]})},r))})}),!se&&!q&&e.jsx(br,{color:"primary",onClick:Y,sx:{position:"fixed",bottom:24,right:24,background:"linear-gradient(45deg, #4caf50 0%, #2e7d32 100%)","&:hover":{background:"linear-gradient(45deg, #388e3c 0%, #1b5e20 100%)",transform:"scale(1.1)"},transition:"all 0.3s ease",zIndex:1e3},children:e.jsx(ae,{})})]})]})}export{Da as default};
