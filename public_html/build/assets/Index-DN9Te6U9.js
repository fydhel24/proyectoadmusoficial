import{r as m,j as e,$ as K,Y as z}from"./app-YEuHkux5.js";import{A as J,B as P,c as Q}from"./app-layout-Dh5sl-jU.js";import{B as V}from"./Block-D2f7wPuI.js";import{C as U}from"./CheckCircle-P0wMdQpE.js";import{u as Z,T as c,P as B}from"./Typography-D8rBbavg.js";import{u as ee}from"./index-DXV3AoGs.js";import{S as te}from"./Snackbar-8wTI4jF5.js";import{A as re}from"./Alert-M1Fv6YQG.js";import{G as A}from"./Grid-CZ5Gk029.js";import{C as oe}from"./Card-DmMu79y6.js";import{B as s}from"./Box-DZXJg_qv.js";import{B as y}from"./Button-CMjaMz42.js";import{T as ae}from"./TextField-CpThoci2.js";import{I as j}from"./IconButton-DepEmupO.js";import{S as se}from"./Search-Cu_J7Bp9.js";import{T as ie}from"./TableContainer-dTje-Ypv.js";import{T as ne,a as le,b as v,c as me}from"./TableRow-cov9Pl37.js";import{T as i}from"./TableCell-9OmuTGMb.js";import{D as de}from"./DateRange-BhLTwN4n.js";import{C as ce}from"./CalendarToday-AqIyqL2V.js";import{E as pe}from"./EventAvailable-Da3yCQZW.js";import{E as R}from"./Edit-DJy-qXX3.js";import{D}from"./Delete-Ct1Ol2la.js";import{T as _}from"./Tooltip-MqpFe2zP.js";import{a as xe}from"./TablePagination-DYqek8Nq.js";import{D as he,a as ge,b as fe}from"./DialogTitle-DT-dALo8.js";import{C as M}from"./Close-Bm0cbP4p.js";import{D as ue}from"./DialogActions-DSNCgedV.js";import"./button-_5e2JbJM.js";import"./clsx-B-dksMZM.js";import"./avatar-DPKp3hQk.js";import"./createLucideIcon-9JrBpBfL.js";import"./index-D3g71isE.js";import"./index-B2kdsAU2.js";import"./index-m3ZdHyWT.js";import"./settings-d7GkTK56.js";import"./app-logo-icon-BYryv9rn.js";import"./createSvgIcon-Bv7lX4UF.js";import"./DefaultPropsProvider-CEXgxhq8.js";import"./createSimplePaletteValueFilter-J_8iZNoO.js";import"./getThemeProps-BO29yZBp.js";import"./useTimeout-g4Ibx1fA.js";import"./useSlot-q3G4gJ7a.js";import"./TransitionGroupContext-mQf08jKB.js";import"./ClickAwayListener-GZRELEzt.js";import"./Fade-pc_dseJo.js";import"./ownerDocument-DW-IO8s5.js";import"./Grow-J0HjpUkY.js";import"./Close-B3-jeOLy.js";import"./useThemeProps-B1feN13w.js";import"./isMuiElement-C40F-WzM.js";import"./useId-DF1cwINX.js";import"./ButtonBase-CS4YXIYb.js";import"./CircularProgress-Bn3EXqD5.js";import"./Select-B_eRVbu_.js";import"./index-CyVCCTxO.js";import"./useSlotProps-BXV3urdk.js";import"./List-2At25vZV.js";import"./Modal-B5zRzlCf.js";import"./Portal-1gL4VHaW.js";import"./debounce-Be36O1Ab.js";import"./useControlled-CZTOPfKL.js";import"./Popper-CBS_IXcw.js";import"./KeyboardArrowRight-DYzW2rWm.js";import"./LastPage-Do4h3UC4.js";import"./MenuItem-EZI4tQJZ.js";import"./listItemTextClasses-B6w7MOm2.js";import"./dividerClasses-Df44jC95.js";function L(f){return{monday:"Lunes",tuesday:"Martes",wednesday:"Miércoles",thursday:"Jueves",friday:"Viernes",saturday:"Sábado",sunday:"Domingo"}[f]||f}const At=({companies:f,influencersByDay:l})=>{const[q,k]=m.useState(!1),[p,E]=m.useState(null),[I,x]=m.useState(null),[h,H]=m.useState(f),[w,O]=m.useState(""),[u,T]=m.useState(0),[g,X]=m.useState(10),r=Z(),n=ee(r.breakpoints.down("sm")),C=m.useMemo(()=>{const t=w.trim().toLowerCase();return t?h.filter(a=>{var o,d;return a.name.toLowerCase().includes(t)||((d=(o=a.category)==null?void 0:o.name)==null?void 0:d.toLowerCase().includes(t))}):h},[w,h]),W=m.useMemo(()=>C.slice(u*g,u*g+g),[C,u,g]),F=m.useMemo(()=>{const t={monday:0,tuesday:0,wednesday:0,thursday:0,friday:0,saturday:0};return h.forEach(a=>{const o=a.availability_days||[];new Set(o.map(b=>b.day_of_week)).forEach(b=>{t[b]!==void 0&&t[b]++})}),t},[h]);async function $(){var t;if(p){try{const o=await(await fetch(`/companies/${p.id}`,{method:"DELETE",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""}})).json();x(o.success||"Compañía eliminada"),H(h.filter(d=>d.id!==p.id))}catch{x("Error al eliminar la compañía")}k(!1),E(null)}}async function N(t){var a;try{(await fetch(`/companies/${t.id}/estado`,{method:"PATCH",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":((a=document.querySelector('meta[name="csrf-token"]'))==null?void 0:a.getAttribute("content"))||""}})).ok?window.location.reload():x("Error al cambiar estado")}catch{x("Error al cambiar estado")}}function S(){k(!1),E(null)}const Y=(t,a)=>{T(a)},G=t=>{X(parseInt(t.target.value,10)),T(0)};return e.jsxs(J,{children:[e.jsx(K,{title:"Empresas"}),e.jsx(te,{open:!!I,autoHideDuration:4e3,onClose:()=>x(null),anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(re,{onClose:()=>x(null),severity:"success",sx:{width:"100%"},children:I})}),e.jsx(A,{container:!0,spacing:2,sx:{mb:3,mx:{xs:1,sm:2,md:3,lg:4,xl:6}},justifyContent:"center",children:Object.entries(F).map(([t,a])=>e.jsx(A,{item:!0,xs:6,sm:4,md:3,lg:2.4,xl:2,sx:{display:"flex",justifyContent:"center"},children:e.jsxs(oe,{sx:{width:{xs:160,sm:170,md:190,lg:210,xl:230},height:"auto",minHeight:{xs:280,sm:300,md:320,lg:340,xl:360},maxWidth:{xs:160,sm:170,md:190,lg:210,xl:230},flexShrink:0,flexGrow:0,borderRadius:{xs:3,md:4},background:"linear-gradient(135deg, #a18cd1 10%, #66a6ff 100%)",border:"2px solid rgba(0,91,168,0.6)",boxShadow:{xs:"0 4px 12px rgba(37,117,252,0.15), 0 2px 4px rgba(0,0,0,0.1)",md:"0 8px 24px rgba(37,117,252,0.2), 0 4px 8px rgba(0,0,0,0.1)"},display:"flex",flexDirection:"column",alignItems:"center",p:{xs:1,sm:1.2,md:1.5},overflow:"visible","&:hover":{transform:{xs:"translateY(-4px) scale(1.02)",md:"translateY(-6px) scale(1.03)"},boxShadow:{xs:"0 12px 32px rgba(37,117,252,0.25), 0 6px 12px rgba(0,0,0,0.15)",md:"0 16px 48px rgba(37,117,252,0.3), 0 8px 16px rgba(0,0,0,0.2)"}}},children:[e.jsxs(s,{sx:{textAlign:"center",mb:{xs:1,md:1.5},width:"100%"},children:[e.jsx(c,{variant:"subtitle1",sx:{fontWeight:"bold",mb:{xs:.5,md:1},color:"white",letterSpacing:1.2,fontSize:{xs:"0.85rem",sm:"0.9rem",md:"1rem"},textShadow:"0 2px 8px rgba(0,0,0,0.3)"},children:L(t)}),e.jsxs(c,{variant:"h4",sx:{fontWeight:900,fontSize:{xs:"1.5rem",sm:"1.75rem",md:"2rem"},color:"white",textShadow:"0 3px 12px rgba(0,0,0,0.4)"},children:[a," ",e.jsx(s,{component:"span",sx:{fontSize:"0.85rem",fontWeight:600,color:"rgba(255,255,255,0.9)"},children:a===1?"Empresa":"Empresas"})]})]}),e.jsx(s,{sx:{width:"100%",flex:1,display:"flex",flexDirection:"column",gap:{xs:.5,sm:.6,md:.7},px:{xs:.5,sm:.7,md:1},overflowY:"auto",maxHeight:{xs:180,sm:200,md:220},"&::-webkit-scrollbar":{width:"4px"},"&::-webkit-scrollbar-thumb":{backgroundColor:r.palette.primary.dark,borderRadius:"2px"}},children:Array.isArray(l==null?void 0:l[t])&&l[t].length>0?l[t].map((o,d)=>e.jsx(s,{sx:{background:"rgba(255,255,255,0.95)",borderRadius:1,p:{xs:.5,sm:.6,md:.7},borderLeft:`3px solid ${r.palette.secondary.main}`,boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:e.jsxs(c,{variant:"caption",sx:{display:"flex",flexDirection:"column",color:r.palette.primary.main,fontSize:{xs:"0.65rem",sm:"0.7rem",md:"0.75rem"},fontWeight:600,lineHeight:1.3},children:[e.jsx(s,{component:"span",sx:{fontWeight:"bold"},children:o.influencer.split(" ")[0]}),e.jsx(s,{component:"span",sx:{color:r.palette.secondary.main,wordBreak:"break-word",whiteSpace:"normal"},children:o.empresa})]})},d)):e.jsx(c,{variant:"caption",sx:{visibility:"hidden",height:{xs:20,sm:25,md:30}},children:"Placeholder"})}),Array.isArray(l==null?void 0:l[t])&&l[t].length>4&&e.jsxs(c,{variant:"caption",sx:{fontSize:"0.6rem",color:"rgba(255,255,255,0.8)",fontStyle:"italic",mt:.5,textShadow:"0 1px 4px rgba(0,0,0,0.3)"},children:["+",l[t].length-4," más"]})]})},t))}),e.jsxs(s,{sx:{py:6,mx:{xs:0,md:4}},children:[e.jsxs(s,{sx:{mb:4,display:"flex",flexDirection:{xs:"column",md:"row"},gap:2,alignItems:{md:"center"},justifyContent:{md:"space-between"}},children:[e.jsx(y,{component:z,href:"/companies/create",variant:"contained",color:"primary",sx:{fontWeight:"bold"},startIcon:e.jsx(P,{}),children:"Crear nueva Empresa"}),e.jsx(ae,{placeholder:"Buscar por nombre o categoría...",value:w,onChange:t=>O(t.target.value),size:"small",fullWidth:!0,sx:{maxWidth:320},InputProps:{startAdornment:e.jsx(j,{tabIndex:-1,children:e.jsx(se,{})})}})]}),e.jsxs(ie,{component:B,sx:{borderRadius:2,boxShadow:3,overflowX:"auto",border:"1px solid #e0e0e0",background:r.palette.background.paper,mx:{xs:0,md:2}},children:[e.jsxs(ne,{stickyHeader:!0,sx:{minWidth:900},children:[e.jsx(le,{children:e.jsxs(v,{children:[e.jsx(i,{sx:{fontWeight:"bold",backgroundColor:r.palette.primary.main,color:r.palette.common.white,padding:n?"8px":"16px",fontSize:n?"0.875rem":"1rem"},children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(P,{fontSize:"small"})," Nombre de la empresa"]})}),e.jsx(i,{sx:{fontWeight:"bold",backgroundColor:r.palette.primary.main,color:r.palette.common.white,padding:n?"8px":"16px",fontSize:n?"0.875rem":"1rem"},children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Q,{fontSize:"small"})," Categoría"]})}),e.jsx(i,{sx:{fontWeight:"bold",backgroundColor:r.palette.primary.main,color:r.palette.common.white,padding:n?"8px":"16px",fontSize:n?"0.875rem":"1rem"},children:e.jsx(s,{sx:{display:"flex",alignItems:"center",gap:1},children:"Estado"})}),e.jsx(i,{sx:{fontWeight:"bold",backgroundColor:r.palette.primary.main,color:r.palette.common.white,padding:n?"8px":"16px",fontSize:n?"0.875rem":"1rem"},children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(de,{fontSize:"small"})," Fecha inicio"]})}),e.jsx(i,{sx:{fontWeight:"bold",backgroundColor:r.palette.primary.main,color:r.palette.common.white,padding:n?"8px":"16px",fontSize:n?"0.875rem":"1rem"},children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ce,{fontSize:"small"})," Fecha fin"]})}),e.jsx(i,{sx:{fontWeight:"bold",backgroundColor:r.palette.primary.main,color:r.palette.common.white,padding:n?"8px":"16px",fontSize:n?"0.875rem":"1rem"},children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(pe,{fontSize:"small"})," Días Disponibles"]})}),e.jsx(i,{sx:{fontWeight:"bold",backgroundColor:r.palette.primary.main,color:r.palette.common.white,padding:n?"8px":"16px",fontSize:n?"0.875rem":"1rem"},children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(R,{fontSize:"small"})," / ",e.jsx(D,{fontSize:"small"})," Acciones"]})})]})}),e.jsxs(me,{children:[W.length===0&&e.jsx(v,{children:e.jsx(i,{colSpan:7,align:"center",sx:{py:6,color:"text.secondary"},children:"No se encontraron compañías."})}),W.map(t=>{var a;return e.jsxs(v,{hover:!0,children:[e.jsx(i,{children:t.name}),e.jsx(i,{children:((a=t.category)==null?void 0:a.name)||e.jsx("span",{style:{color:"#aaa",fontStyle:"italic"},children:"Sin categoría"})}),e.jsx(i,{children:e.jsx(c,{variant:"body2",sx:{fontWeight:600,color:t.estado==="activo"?"green":"red"},children:t.estado})}),e.jsx(i,{children:t.start_date||"-"}),e.jsx(i,{children:t.end_date||"-"}),e.jsx(i,{children:e.jsx(s,{sx:{display:"flex",flexDirection:"column",gap:.5},children:Array.isArray(t.availability_days)&&t.availability_days.length>0?t.availability_days.map((o,d)=>e.jsxs(s,{sx:{display:"inline-block",px:1,py:.5,borderRadius:1,fontSize:"0.75rem",fontWeight:600,bgcolor:o.turno==="mañana"?"blue.100":"yellow.100",color:o.turno==="mañana"?"blue.800":"yellow.800",border:"1px solid",borderColor:"grey.200"},children:[L(o.day_of_week),": ",o.start_time," - ",o.end_time," (",o.turno,")"]},d)):e.jsx(c,{variant:"body2",color:"text.secondary",fontStyle:"italic",children:"Sin disponibilidad"})})}),e.jsxs(i,{children:[e.jsx(_,{title:"Editar Empresa",children:e.jsx(j,{color:"primary",component:z,href:`/companies/${t.id}/edit`,"aria-label":"Editar",children:e.jsx(R,{})})}),e.jsx(_,{title:t.estado==="activo"?"Desactivar Empresa":"Activar Empresa",children:e.jsx(j,{color:t.estado==="activo"?"warning":"success",onClick:()=>N(t),"aria-label":t.estado==="activo"?"Desactivar":"Activar",children:t.estado==="activo"?e.jsx(V,{}):e.jsx(U,{})})})]})]},t.id)})]})]}),e.jsx(xe,{component:"div",count:C.length,page:u,onPageChange:Y,rowsPerPage:g,onRowsPerPageChange:G,rowsPerPageOptions:[5,10,25,50],labelRowsPerPage:"Filas por página"})]})]}),e.jsxs(he,{open:q,onClose:S,maxWidth:"xs",fullWidth:!0,children:[e.jsxs(ge,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(c,{variant:"h6",children:"Confirmar eliminación"}),e.jsx(j,{onClick:S,children:e.jsx(M,{})})]}),e.jsx(fe,{dividers:!0,children:e.jsxs(c,{children:["¿Estás seguro de que deseas eliminar la compañía ",e.jsx("b",{children:p==null?void 0:p.name}),"?"]})}),e.jsxs(ue,{children:[e.jsx(y,{onClick:S,color:"inherit",variant:"outlined",startIcon:e.jsx(M,{}),children:"Cancelar"}),e.jsx(y,{onClick:$,color:"error",variant:"contained",startIcon:e.jsx(D,{}),children:"Eliminar"})]})]})]})};export{At as default};
