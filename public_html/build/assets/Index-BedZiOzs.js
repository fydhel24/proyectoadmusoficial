import{j as e,r as l,$ as Y,Y as A}from"./app-C9FYWxt2.js";import{A as G,B as D,d as J,L as K}from"./app-layout-DmzbA60l.js";import{u as Q,T as m,P as U}from"./Typography-ChZrof4A.js";import{u as Z}from"./index-D2L-TbDH.js";import{S as ee}from"./Snackbar-DPPFr99D.js";import{A as te}from"./Alert-B0naQATg.js";import{G as E}from"./Grid-5B1YnSmD.js";import{C as re}from"./Card-CqptthBP.js";import{B as n}from"./Box-Bq5diqRU.js";import{B as z}from"./Button-OrpXgKRb.js";import{T as oe}from"./TextField-BXw8MSJw.js";import{I as b}from"./IconButton-WOx5yTT3.js";import{S as ae}from"./Search-CkdDY7T-.js";import{T as ie}from"./TableContainer-C8RRRQB8.js";import{T as se,a as ne,b as I,c as le}from"./TableRow-CkZJRGNB.js";import{T as a}from"./TableCell-DRNoLjy7.js";import{c as R}from"./createSvgIcon-BeWwfM08.js";import{C as ce}from"./CalendarToday-BTrSB7jF.js";import{E as H}from"./Edit-DVrFSII2.js";import{D as k}from"./Delete-z4gzrZsk.js";import{a as me}from"./TablePagination-DjmG7rEC.js";import{D as de,a as pe,b as xe}from"./DialogTitle-C2zjZyuu.js";import{C as L}from"./Close-DTD2RzDu.js";import{D as he}from"./DialogActions-DgAbohsO.js";import"./button-Tq1l60An.js";import"./clsx-B-dksMZM.js";import"./avatar-FJwtKWDO.js";import"./createLucideIcon-CxvTyEZH.js";import"./index-BRQOeZDx.js";import"./index-CbpD1ODr.js";import"./index-CTU4SEXm.js";import"./settings-6wmvEXTi.js";import"./app-logo-icon-DeROgz-_.js";import"./DefaultPropsProvider-ZncIBFYl.js";import"./getThemeProps-QoLWqXG_.js";import"./useTimeout-BU9dWeAN.js";import"./useSlot-DE_1Wxdu.js";import"./ClickAwayListener-BcDdUbt-.js";import"./Fade-Dxqqf-S-.js";import"./Grow-rrETuSGo.js";import"./Close-Cwwe_d8f.js";import"./useThemeProps-VB07dJvB.js";import"./isMuiElement-DPAZRHqk.js";import"./useId-BWw3VObj.js";import"./ButtonBase-DpSlwJZ0.js";import"./CircularProgress-Dq1DDrXf.js";import"./Select-BfGrSzPw.js";import"./index-BDY8rXHp.js";import"./useSlotProps-DhP8vEMs.js";import"./List-eZh72x_E.js";import"./Modal-rnOcQKoj.js";import"./Portal-DkTiE7_4.js";import"./debounce-Be36O1Ab.js";import"./useControlled-DFhhtwhL.js";import"./KeyboardArrowRight-CiVzl0x-.js";import"./LastPage-DYGZH0wD.js";import"./MenuItem-B28vU40v.js";import"./listItemTextClasses-BRQYdTuR.js";import"./dividerClasses-B8wi_Rdr.js";const ge=R(e.jsx("path",{d:"M9 11H7v2h2zm4 0h-2v2h2zm4 0h-2v2h2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 16H5V9h14z"})),fe=R(e.jsx("path",{d:"M16.53 11.06 15.47 10l-4.88 4.88-2.12-2.12-1.06 1.06L10.59 17zM19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 16H5V8h14z"}));function M(g){return{monday:"Lunes",tuesday:"Martes",wednesday:"Miércoles",thursday:"Jueves",friday:"Viernes",saturday:"Sábado",sunday:"Domingo"}[g]||g}const Ct=({companies:g,influencersByDay:d})=>{const[_,y]=l.useState(!1),[p,S]=l.useState(null),[P,f]=l.useState(null),[x,V]=l.useState(g),[C,$]=l.useState(""),[u,T]=l.useState(0),[h,q]=l.useState(10),r=Q(),i=Z(r.breakpoints.down("sm")),w=l.useMemo(()=>{const t=C.trim().toLowerCase();return t?x.filter(s=>{var o,c;return s.name.toLowerCase().includes(t)||((c=(o=s.category)==null?void 0:o.name)==null?void 0:c.toLowerCase().includes(t))}):x},[C,x]),W=l.useMemo(()=>w.slice(u*h,u*h+h),[w,u,h]),O=l.useMemo(()=>{const t={monday:0,tuesday:0,wednesday:0,thursday:0,friday:0};return x.forEach(s=>{const o=s.availability_days||[];new Set(o.map(j=>j.day_of_week)).forEach(j=>{t[j]!==void 0&&t[j]++})}),t},[x]);function F(t){S(t),y(!0)}async function B(){var t;if(p){try{const o=await(await fetch(`/companies/${p.id}`,{method:"DELETE",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""}})).json();f(o.success||"Compañía eliminada"),V(x.filter(c=>c.id!==p.id))}catch{f("Error al eliminar la compañía")}y(!1),S(null)}}function v(){y(!1),S(null)}const N=(t,s)=>{T(s)},X=t=>{q(parseInt(t.target.value,10)),T(0)};return e.jsxs(G,{children:[e.jsx(Y,{title:"Empresas"}),e.jsx(ee,{open:!!P,autoHideDuration:4e3,onClose:()=>f(null),anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(te,{onClose:()=>f(null),severity:"success",sx:{width:"100%"},children:P})}),e.jsx(E,{container:!0,spacing:2,sx:{mb:3,mx:{xs:0,md:4}},justifyContent:"center",children:Object.entries(O).map(([t,s])=>e.jsx(E,{item:!0,xs:12,sm:6,md:3,lg:2,sx:{display:"flex",justifyContent:"center"},children:e.jsxs(re,{sx:{width:220,height:320,borderRadius:3,boxShadow:4,background:`linear-gradient(135deg, ${r.palette.primary.light} 0%, ${r.palette.secondary.light} 100%)`,border:`1.5px solid ${r.palette.divider}`,transition:"transform 0.15s, box-shadow 0.15s",display:"flex",flexDirection:"column",alignItems:"center",p:2,"&:hover":{transform:"translateY(-4px) scale(1.03)",boxShadow:8}},children:[e.jsxs(n,{children:[e.jsx(m,{variant:"subtitle1",sx:{fontWeight:"bold",mb:1,color:r.palette.primary.dark,letterSpacing:1,fontSize:"1rem",textAlign:"center"},children:M(t)}),e.jsx(m,{variant:"h4",color:"primary",sx:{fontWeight:900,mb:.5,fontSize:"2rem",lineHeight:1,textShadow:"0 2px 8px rgba(37,117,252,0.10)",textAlign:"center"},children:s}),e.jsx(m,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:600,letterSpacing:.5,fontSize:"0.85rem",textAlign:"center"},children:s===1?"empresa":"empresas"})]}),e.jsx(n,{sx:{width:"100%"},children:Array.isArray(d==null?void 0:d[t])&&d[t].length>0?d[t].map((o,c)=>e.jsxs(m,{variant:"caption",sx:{display:"block",background:"#fff",color:r.palette.primary.main,borderRadius:1,px:1,mb:.5,fontSize:"0.75rem",fontWeight:600,boxShadow:"0 1px 4px rgba(37,117,252,0.07)",textAlign:"center",wordBreak:"break-word"},children:[e.jsx("b",{children:o.influencer.split(" ")[0]})," en"," ",e.jsx("span",{style:{color:r.palette.secondary.main},children:o.empresa})]},c)):e.jsx(m,{variant:"caption",sx:{visibility:"hidden",height:30},children:"Placeholder"})})]})},t))}),e.jsxs(n,{sx:{py:6,mx:{xs:0,md:4}},children:[e.jsxs(n,{sx:{mb:4,display:"flex",flexDirection:{xs:"column",md:"row"},gap:2,alignItems:{md:"center"},justifyContent:{md:"space-between"}},children:[e.jsx(z,{component:A,href:"/companies/create",variant:"contained",color:"primary",sx:{fontWeight:"bold"},startIcon:e.jsx(D,{}),children:"Crear nueva Empresa"}),e.jsx(oe,{placeholder:"Buscar por nombre o categoría...",value:C,onChange:t=>$(t.target.value),size:"small",fullWidth:!0,sx:{maxWidth:320},InputProps:{startAdornment:e.jsx(b,{tabIndex:-1,children:e.jsx(ae,{})})}})]}),e.jsxs(ie,{component:U,sx:{borderRadius:2,boxShadow:3,overflowX:"auto",border:"1px solid #e0e0e0",background:r.palette.background.paper,mx:{xs:0,md:2}},children:[e.jsxs(se,{stickyHeader:!0,sx:{minWidth:900},children:[e.jsx(ne,{children:e.jsxs(I,{children:[e.jsx(a,{sx:{fontWeight:"bold",backgroundColor:r.palette.primary.main,color:r.palette.common.white,padding:i?"8px":"16px",fontSize:i?"0.875rem":"1rem"},children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(D,{fontSize:"small"})," Nombre de la empresa"]})}),e.jsx(a,{sx:{fontWeight:"bold",backgroundColor:r.palette.primary.main,color:r.palette.common.white,padding:i?"8px":"16px",fontSize:i?"0.875rem":"1rem"},children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(J,{fontSize:"small"})," Categoría"]})}),e.jsx(a,{sx:{fontWeight:"bold",backgroundColor:r.palette.primary.main,color:r.palette.common.white,padding:i?"8px":"16px",fontSize:i?"0.875rem":"1rem"},children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(K,{fontSize:"small"})," Duración del contrato"]})}),e.jsx(a,{sx:{fontWeight:"bold",backgroundColor:r.palette.primary.main,color:r.palette.common.white,padding:i?"8px":"16px",fontSize:i?"0.875rem":"1rem"},children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ge,{fontSize:"small"})," Fecha inicio"]})}),e.jsx(a,{sx:{fontWeight:"bold",backgroundColor:r.palette.primary.main,color:r.palette.common.white,padding:i?"8px":"16px",fontSize:i?"0.875rem":"1rem"},children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ce,{fontSize:"small"})," Fecha fin"]})}),e.jsx(a,{sx:{fontWeight:"bold",backgroundColor:r.palette.primary.main,color:r.palette.common.white,padding:i?"8px":"16px",fontSize:i?"0.875rem":"1rem"},children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(fe,{fontSize:"small"})," Días Disponibles"]})}),e.jsx(a,{sx:{fontWeight:"bold",backgroundColor:r.palette.primary.main,color:r.palette.common.white,padding:i?"8px":"16px",fontSize:i?"0.875rem":"1rem"},children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(H,{fontSize:"small"})," / ",e.jsx(k,{fontSize:"small"})," Acciones"]})})]})}),e.jsxs(le,{children:[W.length===0&&e.jsx(I,{children:e.jsx(a,{colSpan:7,align:"center",sx:{py:6,color:"text.secondary"},children:"No se encontraron compañías."})}),W.map(t=>{var s;return e.jsxs(I,{hover:!0,children:[e.jsx(a,{children:t.name}),e.jsx(a,{children:((s=t.category)==null?void 0:s.name)||e.jsx("span",{style:{color:"#aaa",fontStyle:"italic"},children:"Sin categoría"})}),e.jsx(a,{children:t.contract_duration}),e.jsx(a,{children:t.start_date||"-"}),e.jsx(a,{children:t.end_date||"-"}),e.jsx(a,{children:e.jsx(n,{sx:{display:"flex",flexDirection:"column",gap:.5},children:Array.isArray(t.availability_days)&&t.availability_days.length>0?t.availability_days.map((o,c)=>e.jsxs(n,{sx:{display:"inline-block",px:1,py:.5,borderRadius:1,fontSize:"0.75rem",fontWeight:600,bgcolor:o.turno==="mañana"?"blue.100":"yellow.100",color:o.turno==="mañana"?"blue.800":"yellow.800",border:"1px solid",borderColor:"grey.200"},children:[M(o.day_of_week),": ",o.start_time," - ",o.end_time," (",o.turno,")"]},c)):e.jsx(m,{variant:"body2",color:"text.secondary",fontStyle:"italic",children:"Sin disponibilidad"})})}),e.jsxs(a,{children:[e.jsx(b,{color:"primary",component:A,href:`/companies/${t.id}/edit`,"aria-label":"Editar",children:e.jsx(H,{})}),e.jsx(b,{color:"error",onClick:()=>F(t),"aria-label":"Eliminar",children:e.jsx(k,{})})]})]},t.id)})]})]}),e.jsx(me,{component:"div",count:w.length,page:u,onPageChange:N,rowsPerPage:h,onRowsPerPageChange:X,rowsPerPageOptions:[5,10,25,50],labelRowsPerPage:"Filas por página"})]})]}),e.jsxs(de,{open:_,onClose:v,maxWidth:"xs",fullWidth:!0,children:[e.jsxs(pe,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(m,{variant:"h6",children:"Confirmar eliminación"}),e.jsx(b,{onClick:v,children:e.jsx(L,{})})]}),e.jsx(xe,{dividers:!0,children:e.jsxs(m,{children:["¿Estás seguro de que deseas eliminar la compañía ",e.jsx("b",{children:p==null?void 0:p.name}),"?"]})}),e.jsxs(he,{children:[e.jsx(z,{onClick:v,color:"inherit",variant:"outlined",startIcon:e.jsx(L,{}),children:"Cancelar"}),e.jsx(z,{onClick:B,color:"error",variant:"contained",startIcon:e.jsx(k,{}),children:"Eliminar"})]})]})]})};export{Ct as default};
