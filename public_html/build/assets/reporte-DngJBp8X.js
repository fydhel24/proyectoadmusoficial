import{q as N,r as i,j as e,m as U}from"./app-YEuHkux5.js";import{A as q}from"./app-layout-Dh5sl-jU.js";import{B as d}from"./Box-DZXJg_qv.js";import{T as o,P as H}from"./Typography-D8rBbavg.js";import{S as L}from"./Stack-DH4x_kPu.js";import{B as b}from"./Button-CMjaMz42.js";import{P as R}from"./PictureAsPdf-Cqo8bcDl.js";import{C as O}from"./Card-DmMu79y6.js";import{C as J}from"./CardContent-DNXYRSCg.js";import{F as k}from"./FilterList-B9RFDXqs.js";import{G as h}from"./Grid-CZ5Gk029.js";import{T as C}from"./TextField-CpThoci2.js";import{I as v}from"./InputAdornment-t3XbOCFs.js";import{C as A}from"./CalendarToday-AqIyqL2V.js";import{F as K,I as Q,S as V}from"./Select-B_eRVbu_.js";import{M as _}from"./MenuItem-EZI4tQJZ.js";import{S as X}from"./Search-Cu_J7Bp9.js";import{T as Y}from"./TableContainer-dTje-Ypv.js";import{T as Z,a as ee,b as y,c as re}from"./TableRow-cov9Pl37.js";import{T as a}from"./TableCell-9OmuTGMb.js";import{C as W}from"./Chip-D0HSmcM1.js";import{a as te}from"./TablePagination-DYqek8Nq.js";import"./button-_5e2JbJM.js";import"./clsx-B-dksMZM.js";import"./avatar-DPKp3hQk.js";import"./createLucideIcon-9JrBpBfL.js";import"./index-D3g71isE.js";import"./index-B2kdsAU2.js";import"./index-m3ZdHyWT.js";import"./settings-d7GkTK56.js";import"./app-logo-icon-BYryv9rn.js";import"./createSvgIcon-Bv7lX4UF.js";import"./DefaultPropsProvider-CEXgxhq8.js";import"./createSimplePaletteValueFilter-J_8iZNoO.js";import"./useThemeProps-B1feN13w.js";import"./getThemeProps-BO29yZBp.js";import"./useId-DF1cwINX.js";import"./ButtonBase-CS4YXIYb.js";import"./useTimeout-g4Ibx1fA.js";import"./TransitionGroupContext-mQf08jKB.js";import"./CircularProgress-Bn3EXqD5.js";import"./isMuiElement-C40F-WzM.js";import"./useSlot-q3G4gJ7a.js";import"./index-CyVCCTxO.js";import"./useSlotProps-BXV3urdk.js";import"./List-2At25vZV.js";import"./ownerDocument-DW-IO8s5.js";import"./Modal-B5zRzlCf.js";import"./Portal-1gL4VHaW.js";import"./Fade-pc_dseJo.js";import"./debounce-Be36O1Ab.js";import"./Grow-J0HjpUkY.js";import"./useControlled-CZTOPfKL.js";import"./listItemTextClasses-B6w7MOm2.js";import"./dividerClasses-Df44jC95.js";import"./KeyboardArrowRight-DYzW2rWm.js";import"./LastPage-Do4h3UC4.js";import"./IconButton-DepEmupO.js";const oe=l=>{switch(l.toLowerCase()){case"alta":return"error";case"media":return"warning";case"baja":return"success";default:return"default"}},ae=l=>{switch(l.toLowerCase()){case"completado":return"success";case"en progreso":return"info";case"pendiente":return"warning";case"cancelado":return"error";default:return"default"}};function dr(){const{asignaciones:l,filters:g}=N().props,[u,P]=i.useState(g.fecha_inicio||""),[x,S]=i.useState(g.fecha_fin||""),[T,I]=i.useState(g.mes||""),[n,F]=i.useState(""),[f,j]=i.useState(0),[c,M]=i.useState(10),m=i.useMemo(()=>l.filter(r=>{var s,p;const t=n.toLowerCase();return r.user.name.toLowerCase().includes(t)||r.tarea.titulo.toLowerCase().includes(t)||r.tarea.prioridad.toLowerCase().includes(t)||((s=r.tarea.tipo)==null?void 0:s.nombre_tipo.toLowerCase().includes(t))||((p=r.tarea.company)==null?void 0:p.name.toLowerCase().includes(t))||r.estado.toLowerCase().includes(t)||r.detalle.toLowerCase().includes(t)}),[l,n]),w=i.useMemo(()=>m.slice(f*c,f*c+c),[m,f,c]),B=r=>{r.preventDefault(),U.get("/reportetareas",{fecha_inicio:u,fecha_fin:x,mes:T},{preserveState:!0,preserveScroll:!0})},D=()=>{const r=new URLSearchParams({fecha_inicio:u,fecha_fin:x}).toString();window.open(`/reportetareas/pdf?${r}`,"_blank")},$=()=>{const r=new URLSearchParams({fecha_inicio:u,fecha_fin:x}).toString();window.open(`/reportetareas/pdfmes?${r}`,"_blank")},E=(r,t)=>{j(t)},G=r=>{M(parseInt(r.target.value,10)),j(0)},z=()=>{P(""),S(""),I(""),F(""),j(0)};return e.jsx(q,{children:e.jsxs(d,{sx:{p:3},children:[e.jsxs(d,{sx:{mb:3},children:[e.jsx(o,{variant:"h4",component:"h1",gutterBottom:!0,fontWeight:"bold",children:"Reporte de Tareas Asignadas"}),e.jsx(o,{variant:"subtitle1",color:"text.secondary",children:"Gestiona y visualiza todas las asignaciones de tareas"})]}),e.jsxs(L,{direction:"row",spacing:2,sx:{mb:3},children:[e.jsx(b,{variant:"contained",color:"error",startIcon:e.jsx(R,{}),onClick:D,sx:{borderRadius:2},children:"Generar PDF"}),e.jsx(b,{variant:"contained",color:"primary",startIcon:e.jsx(R,{}),onClick:$,sx:{borderRadius:2},children:"Generar PDF Mensual"})]}),e.jsx(O,{sx:{mb:3,borderRadius:3,background:"linear-gradient(to right, #f0f4ff, #f9fbff)",boxShadow:3},children:e.jsxs(J,{children:[e.jsxs(d,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(k,{sx:{mr:1,color:"primary.main"}}),e.jsx(o,{variant:"h6",color:"primary",children:"Filtros"})]}),e.jsx(d,{component:"form",onSubmit:B,children:e.jsxs(h,{container:!0,spacing:3,alignItems:"flex-end",children:[e.jsx(h,{item:!0,xs:12,sm:6,md:3,children:e.jsx(C,{fullWidth:!0,type:"date",label:"Fecha Inicio",value:u,onChange:r=>P(r.target.value),InputLabelProps:{shrink:!0},InputProps:{startAdornment:e.jsx(v,{position:"start",children:e.jsx(A,{color:"primary"})})}})}),e.jsx(h,{item:!0,xs:12,sm:6,md:3,children:e.jsx(C,{fullWidth:!0,type:"date",label:"Fecha Fin",value:x,onChange:r=>S(r.target.value),InputLabelProps:{shrink:!0},InputProps:{startAdornment:e.jsx(v,{position:"start",children:e.jsx(A,{color:"primary"})})}})}),e.jsx(h,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(K,{fullWidth:!0,children:[e.jsx(Q,{children:"Mes"}),e.jsxs(V,{value:T,label:"Mes",onChange:r=>I(r.target.value),sx:{px:3,fontWeight:500,backgroundColor:"white",borderRadius:2},children:[e.jsx(_,{value:"",children:"-- Todos los meses --"}),Array.from({length:12},(r,t)=>e.jsx(_,{value:t+1,children:new Date(0,t).toLocaleString("es-ES",{month:"long"})},t+1))]})]})}),e.jsx(h,{item:!0,xs:12,sm:6,md:2,children:e.jsxs(L,{direction:"row",spacing:1,children:[e.jsx(b,{type:"submit",variant:"contained",color:"primary",startIcon:e.jsx(k,{}),fullWidth:!0,sx:{borderRadius:2},children:"Filtrar"}),e.jsx(b,{variant:"outlined",color:"secondary",onClick:z,fullWidth:!0,sx:{borderRadius:2},children:"Limpiar"})]})})]})})]})}),e.jsx(d,{sx:{mb:3},children:e.jsx(C,{fullWidth:!0,variant:"outlined",placeholder:"Buscar por usuario, tarea, prioridad, tipo, empresa, estado o detalle...",value:n,onChange:r=>{F(r.target.value),j(0)},InputProps:{startAdornment:e.jsx(v,{position:"start",children:e.jsx(X,{color:"action"})})},sx:{borderRadius:2}})}),e.jsx(d,{sx:{mb:2},children:e.jsxs(o,{variant:"body2",color:"text.secondary",children:["Mostrando ",w.length," de ",m.length," resultados",n&&` para "${n}"`]})}),e.jsxs(H,{sx:{borderRadius:2,overflow:"hidden",border:"1px solid",borderColor:"divider"},children:[e.jsx(Y,{children:e.jsxs(Z,{stickyHeader:!0,children:[e.jsx(ee,{children:e.jsx(y,{sx:{background:"linear-gradient(to right, #f9fafb, #ebf8ff)"},children:["Usuario","Tarea","Prioridad","Tipo","Empresa","Fecha Asignación","Estado","Detalle"].map(r=>e.jsx(a,{sx:{fontWeight:"bold",color:"grey.800",borderBottom:"2px solid",borderColor:"divider"},children:r},r))})}),e.jsx(re,{children:w.length===0?e.jsx(y,{children:e.jsx(a,{colSpan:8,align:"center",sx:{py:4},children:e.jsxs(o,{variant:"body1",color:"text.secondary",children:["No se encontraron asignaciones",n&&` que coincidan con "${n}"`]})})}):w.map((r,t)=>{var s,p;return e.jsxs(y,{sx:{backgroundColor:t%2===0?"white":"rgba(243, 244, 246, 0.5)","&:hover":{backgroundColor:"rgba(219, 234, 254, 0.5)"}},children:[e.jsxs(a,{children:[e.jsx(o,{variant:"body2",fontWeight:"medium",children:r.user.name}),e.jsx(o,{variant:"caption",color:"text.secondary",children:r.user.email})]}),e.jsx(a,{children:e.jsx(o,{variant:"body2",fontWeight:"medium",children:r.tarea.titulo})}),e.jsx(a,{children:e.jsx(W,{label:r.tarea.prioridad,color:oe(r.tarea.prioridad),size:"small",variant:"outlined"})}),e.jsx(a,{children:((s=r.tarea.tipo)==null?void 0:s.nombre_tipo)||"N/A"}),e.jsx(a,{children:((p=r.tarea.company)==null?void 0:p.name)||"N/A"}),e.jsx(a,{children:e.jsx(o,{variant:"body2",children:new Date(r.fecha).toLocaleDateString("es-ES")})}),e.jsx(a,{children:e.jsx(W,{label:r.estado,color:ae(r.estado),size:"small"})}),e.jsx(a,{children:e.jsx(o,{variant:"body2",sx:{maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:r.detalle,children:r.detalle})})]},r.id)})})]})}),m.length>0&&e.jsx(te,{component:"div",count:m.length,page:f,onPageChange:E,rowsPerPage:c,onRowsPerPageChange:G,rowsPerPageOptions:[5,10,25,50],labelRowsPerPage:"Filas por página:",labelDisplayedRows:({from:r,to:t,count:s})=>`${r}-${t} de ${s!==-1?s:`más de ${t}`}`,sx:{borderTop:"1px solid",borderColor:"divider",bgcolor:"grey.50"}})]})]})})}export{dr as default};
