import{j as e,$ as m,m as x,r as u}from"./app-DWYhLQL6.js";import{A as b}from"./app-layout-p7K4X7eV.js";import"./button-wMTuvAkw.js";import"./clsx-B-dksMZM.js";import"./avatar-C0bnmZQz.js";import"./createLucideIcon-DISkT-zV.js";import"./index-vDywYphy.js";import"./index-CvZMSx04.js";import"./index-C-qtZoBa.js";import"./settings-B1FLQ7wV.js";import"./app-logo-icon-HoYzQaBs.js";import"./createSvgIcon-C-V1FIKo.js";import"./DefaultPropsProvider-CHy6HlRv.js";function g({tarea:n}){const[a,i]=u.useState({titulo:n.titulo,fecha_produccion:n.fecha_produccion??"",estado_produccion:n.estado_produccion||"pendiente",fecha_edicion:n.fecha_edicion??"",estado_edicion:n.estado_edicion||"pendiente",fecha_entrega:n.fecha_entrega??"",estado_entrega:n.estado_entrega||"pendiente",estrategia:n.estrategia,comentario:n.comentario,guion:n.guion}),t=(c,l)=>{i(p=>{const r={...p,[c]:l};return x.patch(route("tareas.actualizar",n.id),{...r,fecha_produccion:r.fecha_produccion||null,fecha_edicion:r.fecha_edicion||null,fecha_entrega:r.fecha_entrega||null},{preserveScroll:!0,onError:()=>alert("Error al actualizar tarea")}),r})},o=c=>{const{name:l,value:p}=c.target;i({...a,[l]:p})},s=()=>{const c={...a,fecha_produccion:a.fecha_produccion||null,fecha_edicion:a.fecha_edicion||null,fecha_entrega:a.fecha_entrega||null};x.patch(route("tareas.actualizar",n.id),c,{preserveScroll:!0,onError:()=>alert("Error al actualizar tarea")})};return e.jsxs("tr",{className:"text-sm hover:bg-gray-50",children:[e.jsx("td",{className:"border px-4 py-2",children:e.jsx("input",{name:"titulo",value:a.titulo,onChange:o,onBlur:s,className:"w-full rounded border px-2 py-1"})}),e.jsx("td",{className:"border px-4 py-2",children:e.jsx("input",{type:"date",name:"fecha_produccion",value:a.fecha_produccion,onChange:o,onBlur:s,className:"w-full rounded border px-2 py-1"})}),e.jsx("td",{className:"border px-4 py-2 text-center",children:e.jsx("input",{type:"checkbox",checked:a.estado_produccion==="pendiente",onChange:()=>t("estado_produccion","pendiente")})}),e.jsx("td",{className:"border px-4 py-2 text-center",children:e.jsx("input",{type:"checkbox",checked:a.estado_produccion==="completado",onChange:()=>t("estado_produccion","completado")})}),e.jsx("td",{className:"border px-4 py-2",children:e.jsx("input",{type:"date",name:"fecha_edicion",value:a.fecha_edicion,onChange:o,onBlur:s,className:"w-full rounded border px-2 py-1"})}),e.jsx("td",{className:"border px-4 py-2 text-center",children:e.jsx("input",{type:"checkbox",checked:a.estado_edicion==="pendiente",onChange:()=>t("estado_edicion","pendiente")})}),e.jsx("td",{className:"border px-4 py-2 text-center",children:e.jsx("input",{type:"checkbox",checked:a.estado_edicion==="completado",onChange:()=>t("estado_edicion","completado")})}),e.jsx("td",{className:"border px-4 py-2",children:e.jsx("input",{type:"date",name:"fecha_entrega",value:a.fecha_entrega,onChange:o,onBlur:s,className:"w-full rounded border px-2 py-1"})}),e.jsx("td",{className:"border px-4 py-2 text-center",children:e.jsx("input",{type:"checkbox",checked:a.estado_entrega==="pendiente",onChange:()=>t("estado_entrega","pendiente")})}),e.jsx("td",{className:"border px-4 py-2 text-center",children:e.jsx("input",{type:"checkbox",checked:a.estado_entrega==="completado",onChange:()=>t("estado_entrega","completado")})}),e.jsx("td",{className:"border px-4 py-2",children:e.jsx("textarea",{name:"estrategia",value:a.estrategia,onChange:o,onBlur:s,className:"w-full resize-none rounded border px-2 py-1",rows:2})}),e.jsx("td",{className:"border px-4 py-2",children:e.jsx("textarea",{name:"comentario",value:a.comentario,onChange:o,onBlur:s,className:"w-full resize-none rounded border px-2 py-1",rows:2})}),e.jsx("td",{className:"border px-4 py-2",children:e.jsx("textarea",{name:"guion",value:a.guion,onChange:o,onBlur:s,className:"w-full resize-none rounded border px-2 py-1",rows:2})})]})}function A({empresa:n,tareas:a=[],mensaje:i}){const t=new Date,o=t.toLocaleString("es-ES",{month:"long"}),s=t.getFullYear(),c=(a??[]).reduce((r,d)=>{const h=d.semana??"0";return r[h]||(r[h]=[]),r[h].push(d),r},{}),l=Object.keys(c).filter(Boolean).map(r=>Number(r)).sort((r,d)=>r-d).map(r=>r.toString()),p=()=>{confirm("¿Estás seguro de generar las tareas por defecto para esta empresa?")&&x.post(route("tareas.generar",n.id))};return e.jsxs(b,{children:[e.jsx(m,{title:"Tareas de Seguimiento"}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 border-b pb-4",children:[e.jsxs("h1",{className:"mb-2 text-2xl font-bold",children:["Empresa: ",n.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Duración del contrato:"})," ",n.contract_duration]}),n.category&&e.jsxs("p",{children:[e.jsx("strong",{children:"Categoría:"})," ",n.category.name]})]}),i&&e.jsx("div",{className:"mb-4 rounded bg-green-100 p-4 text-green-800",children:i}),e.jsx("div",{className:"mb-4",children:e.jsxs("p",{className:"text-lg font-semibold text-gray-700",children:["Mostrando tareas de: ",o.charAt(0).toUpperCase()+o.slice(1)," ",s]})}),a.length===0&&e.jsx("div",{className:"mb-6",children:e.jsx("button",{onClick:p,className:"rounded bg-blue-500 px-4 py-2 text-white hover:bg-blue-600",children:"Generar datos de tareas"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"mb-4 text-xl font-semibold",children:"Tareas de Seguimiento"}),l.length===0?e.jsx("p",{className:"py-4 text-center",children:"No hay tareas registradas."}):l.map(r=>e.jsxs("div",{className:"mb-8",children:[e.jsxs("h3",{className:"mb-2 text-lg font-bold text-blue-700",children:["Semana ",r]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full border border-gray-300 bg-white",children:[e.jsxs("thead",{className:"bg-gray-100",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Título"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Fecha Producción"}),e.jsx("th",{className:"border px-4 py-2",colSpan:2,children:"Estado Producción"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Fecha Edición"}),e.jsx("th",{className:"border px-4 py-2",colSpan:2,children:"Estado Edición"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Fecha Entrega"}),e.jsx("th",{className:"border px-4 py-2",colSpan:2,children:"Estado Entrega"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Estrategia"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Comentario"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Guión"})]}),e.jsxs("tr",{children:[e.jsx("th",{className:"border px-4 py-2",children:"Pendiente"}),e.jsx("th",{className:"border px-4 py-2",children:"Completado"}),e.jsx("th",{className:"border px-4 py-2",children:"Pendiente"}),e.jsx("th",{className:"border px-4 py-2",children:"Completado"}),e.jsx("th",{className:"border px-4 py-2",children:"Pendiente"}),e.jsx("th",{className:"border px-4 py-2",children:"Completado"})]})]}),e.jsx("tbody",{children:Array.isArray(c[r])&&c[r].map(d=>e.jsx(g,{tarea:d},d.id))})]})})]},r))]})]})]})}export{A as default};
