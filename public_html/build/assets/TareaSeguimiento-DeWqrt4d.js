import{r as m,j as e,$ as P,m as N}from"./app-iQxetvcT.js";import{A as T}from"./app-layout-DZNLsAUN.js";import"./button-Br5uzfA2.js";import"./clsx-B-dksMZM.js";import"./avatar-BfsoZtdh.js";import"./createLucideIcon-DcDr_LZ4.js";import"./index-xUTrLbSm.js";import"./index-STaUq66L.js";import"./index-HkiN5Yj1.js";import"./settings-CpjDLTZ2.js";import"./app-logo-icon-4ncQ7Ez_.js";import"./createSvgIcon-ClVcefPA.js";import"./DefaultPropsProvider-ByswQ0ug.js";function _({status:a,fieldName:f,value:p,onChange:n}){const v=a===p,g={pendiente:"bg-red-500 border-red-500",revision:"bg-yellow-500 border-yellow-500",completado:"bg-green-500 border-green-500"};return e.jsx("div",{className:`h-5 w-5 cursor-pointer rounded-full border-2 transition-colors duration-200 ${v?g[p]:"border-gray-400 bg-white"} `,onClick:()=>n(f,p)})}function k({tarea:a,usersProduccion:f,usersEdicion:p}){const[n,v]=m.useState({titulo:a.titulo,fecha_produccion:a.fecha_produccion??"",fecha_nueva_produccion:a.fecha_nueva_produccion??"",razon_produccion:a.razon_produccion??"",estado_produccion:a.estado_produccion||"pendiente",user_produccion_id:a.user_produccion_id??null,fecha_edicion:a.fecha_edicion??"",fecha_nueva_edicion:a.fecha_nueva_edicion??"",razon_edicion:a.razon_edicion??"",estado_edicion:a.estado_edicion||"pendiente",user_edicion_id:a.user_edicion_id??null,fecha_entrega:a.fecha_entrega??"",fecha_nueva_entrega:a.fecha_nueva_entrega??"",razon_entrega:a.razon_entrega??"",estado_entrega:a.estado_entrega||"pendiente",estrategia:a.estrategia,comentario:a.comentario,guion:a.guion}),[g,y]=m.useState(!!a.fecha_nueva_produccion),[j,E]=m.useState(!!a.fecha_nueva_edicion),[w,z]=m.useState(!!a.fecha_nueva_entrega),d=(o,i)=>{v(h=>{const s={...h,[o]:i};return N.patch(route("tareas.actualizar",a.id),{...s,fecha_produccion:s.fecha_produccion||null,fecha_nueva_produccion:s.fecha_nueva_produccion||null,fecha_edicion:s.fecha_edicion||null,fecha_nueva_edicion:s.fecha_nueva_edicion||null,fecha_entrega:s.fecha_entrega||null,fecha_nueva_entrega:s.fecha_nueva_entrega||null},{preserveScroll:!0,onError:()=>alert("Error al actualizar tarea")}),s})},t=o=>{const{name:i,value:h}=o.target;v({...n,[i]:h})},C=o=>{const{name:i,value:h}=o.target,s=h===""?null:Number(h),c={...n,[i]:s};v(c),N.patch(route("tareas.actualizar",a.id),{...c,fecha_produccion:c.fecha_produccion||null,fecha_nueva_produccion:c.fecha_nueva_produccion||null,fecha_edicion:c.fecha_edicion||null,fecha_nueva_edicion:c.fecha_nueva_edicion||null,fecha_entrega:c.fecha_entrega||null,fecha_nueva_entrega:c.fecha_nueva_entrega||null},{preserveScroll:!0,onError:()=>alert("Error al actualizar tarea")})},l=()=>{const o={...n,fecha_produccion:n.fecha_produccion||null,fecha_nueva_produccion:n.fecha_nueva_produccion||null,fecha_edicion:n.fecha_edicion||null,fecha_nueva_edicion:n.fecha_nueva_edicion||null,fecha_entrega:n.fecha_entrega||null,fecha_nueva_entrega:n.fecha_nueva_entrega||null};N.patch(route("tareas.actualizar",a.id),o,{preserveScroll:!0,onError:()=>alert("Error al actualizar tarea")})},F=n.estado_entrega==="completado"?"bg-green-100 text-green-800 border-2 border-emerald-500 shadow-md font-semibold":"hover:bg-gray-50",x="bg-blue-200 border-blue-400",b="bg-yellow-200 border-yellow-400",S="bg-green-200 border-green-400";return e.jsxs("tr",{className:`text-sm ${F}`,children:[e.jsx("td",{className:"border px-4 py-2",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Título:"}),e.jsx("input",{name:"titulo",value:n.titulo,onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1"}),e.jsx("label",{className:"text-xs text-gray-500",children:"Estrategia:"}),e.jsx("textarea",{name:"estrategia",value:n.estrategia,onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1",rows:2})]})}),e.jsxs("td",{className:`border px-4 py-2 ${x}`,children:[e.jsx("input",{type:"date",name:"fecha_produccion",value:n.fecha_produccion,onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1"}),!g&&!n.fecha_nueva_produccion?e.jsx("button",{onClick:()=>y(!0),className:"mt-2 text-blue-500 hover:text-blue-700",children:"➕ Agregar nueva fecha"}):e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Nueva Fecha:"}),e.jsx("input",{type:"date",name:"fecha_nueva_produccion",value:n.fecha_nueva_produccion??"",onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1"}),e.jsx("label",{className:"text-xs text-gray-500",children:"Razón:"}),e.jsx("textarea",{name:"razon_produccion",value:n.razon_produccion??"",onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1",rows:2})]})]}),e.jsx("td",{className:`border px-4 py-2 text-center ${x}`,children:e.jsx(_,{status:n.estado_produccion,fieldName:"estado_produccion",value:"pendiente",onChange:d})}),e.jsx("td",{className:`border px-4 py-2 text-center ${x}`,children:e.jsx(_,{status:n.estado_produccion,fieldName:"estado_produccion",value:"completado",onChange:d})}),e.jsxs("td",{className:`border px-4 py-2 ${x}`,children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Asignado:"}),e.jsxs("select",{name:"user_produccion_id",value:n.user_produccion_id??"",onChange:C,className:"w-full rounded border px-2 py-1",children:[e.jsx("option",{value:"",children:"Seleccionar"}),f.map(o=>e.jsx("option",{value:o.id,children:o.name},o.id))]})]}),e.jsxs("td",{className:`border px-4 py-2 ${b}`,children:[e.jsx("input",{type:"date",name:"fecha_edicion",value:n.fecha_edicion,onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1"}),!j&&!n.fecha_nueva_edicion?e.jsx("button",{onClick:()=>E(!0),className:"mt-2 text-blue-500 hover:text-blue-700",children:"➕ Agregar nueva fecha"}):e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Nueva Fecha:"}),e.jsx("input",{type:"date",name:"fecha_nueva_edicion",value:n.fecha_nueva_edicion??"",onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1"}),e.jsx("label",{className:"text-xs text-gray-500",children:"Razón:"}),e.jsx("textarea",{name:"razon_edicion",value:n.razon_edicion??"",onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1",rows:2})]})]}),e.jsx("td",{className:`border px-4 py-2 text-center ${b}`,children:e.jsx(_,{status:n.estado_edicion,fieldName:"estado_edicion",value:"pendiente",onChange:d})}),e.jsx("td",{className:`border px-4 py-2 text-center ${b}`,children:e.jsx(_,{status:n.estado_edicion,fieldName:"estado_edicion",value:"revision",onChange:d})}),e.jsx("td",{className:`border px-4 py-2 text-center ${b}`,children:e.jsx(_,{status:n.estado_edicion,fieldName:"estado_edicion",value:"completado",onChange:d})}),e.jsxs("td",{className:`border px-4 py-2 ${b}`,children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Asignado:"}),e.jsxs("select",{name:"user_edicion_id",value:n.user_edicion_id??"",onChange:C,className:"w-full rounded border px-2 py-1",children:[e.jsx("option",{value:"",children:"Seleccionar"}),p.map(o=>e.jsx("option",{value:o.id,children:o.name},o.id))]})]}),e.jsxs("td",{className:`border px-4 py-2 ${S}`,children:[e.jsx("input",{type:"date",name:"fecha_entrega",value:n.fecha_entrega,onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1"}),!w&&!n.fecha_nueva_entrega?e.jsx("button",{onClick:()=>z(!0),className:"mt-2 text-blue-500 hover:text-blue-700",children:"➕ Agregar nueva fecha"}):e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Nueva Fecha:"}),e.jsx("input",{type:"date",name:"fecha_nueva_entrega",value:n.fecha_nueva_entrega??"",onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1"}),e.jsx("label",{className:"text-xs text-gray-500",children:"Razón:"}),e.jsx("textarea",{name:"razon_entrega",value:n.razon_entrega??"",onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1",rows:2})]})]}),e.jsx("td",{className:`border px-4 py-2 text-center ${S}`,children:e.jsx(_,{status:n.estado_entrega,fieldName:"estado_entrega",value:"pendiente",onChange:d})}),e.jsx("td",{className:`border px-4 py-2 text-center ${S}`,children:e.jsx(_,{status:n.estado_entrega,fieldName:"estado_entrega",value:"completado",onChange:d})}),e.jsx("td",{className:"border px-4 py-2",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Comentario:"}),e.jsx("textarea",{name:"comentario",value:n.comentario,onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1",rows:2}),e.jsx("label",{className:"text-xs text-gray-500",children:"Guión:"}),e.jsx("textarea",{name:"guion",value:n.guion,onChange:t,onBlur:l,className:"w-full rounded border px-2 py-1",rows:2})]})})]})}function K({empresa:a,tareas:f=[],usersProduccion:p,usersEdicion:n,mensaje:v,mes:g,anio:y}){var c,A,B;const[j,E]=m.useState(""),[w,z]=m.useState("1"),d=()=>{if(!j)return alert("Debes ingresar un título para la tarea");confirm(`¿Crear tarea "${j}" para la semana ${w}?`)&&N.post(route("tareas.crear",a.id),{titulo:j,semana:w,mes:g,anio:y},{onSuccess:()=>{E(""),z("1")},onError:()=>alert("Error al crear la tarea")})},t=new Date,C=[{value:"01",label:"Enero"},{value:"02",label:"Febrero"},{value:"03",label:"Marzo"},{value:"04",label:"Abril"},{value:"05",label:"Mayo"},{value:"06",label:"Junio"},{value:"07",label:"Julio"},{value:"08",label:"Agosto"},{value:"09",label:"Septiembre"},{value:"10",label:"Octubre"},{value:"11",label:"Noviembre"},{value:"12",label:"Diciembre"}],[l,F]=m.useState(g),[x,b]=m.useState(y),S=()=>{N.get(route("empresas.seguimiento-tareas",a.id),{mes:l,anio:x})},o=()=>{confirm("¿Estás seguro de generar registros por defecto para este mes?")&&N.post(route("tareas.generar",a.id),{mes:l,anio:x})},i=(f??[]).reduce((r,u)=>{const $=u.semana??"0";return r[$]||(r[$]=[]),r[$].push(u),r},{}),h=Object.keys(i).filter(Boolean).map(r=>Number(r)).sort((r,u)=>r-u).map(r=>r.toString()),s={writingMode:"vertical-rl",transform:"rotate(180deg)",height:"100px",width:"30px",padding:"0 4px",textAlign:"center",verticalAlign:"bottom"};return e.jsxs(T,{children:[e.jsx(P,{title:"Tareas de Seguimiento"}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 rounded-lg bg-white p-6 shadow-md",children:[e.jsx("div",{className:"mb-4 flex items-center justify-between border-b pb-4",children:e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:a.name})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-500",children:"Categoría"}),e.jsx("span",{className:"text-gray-900",children:((c=a.category)==null?void 0:c.name)??"No asignada"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-500",children:"Duración del Contrato"}),e.jsx("span",{className:"text-gray-900",children:a.contract_duration})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-500",children:"Paquete"}),e.jsx("span",{className:"text-gray-900",children:((A=a.paquete)==null?void 0:A.nombre_paquete)??"No asignado"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-500",children:"Cliente"}),e.jsx("span",{className:"text-gray-900",children:a.nombre_cliente})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-500",children:"Fechas del Contrato"}),e.jsxs("span",{className:"text-gray-900",children:["Inicio: ",a.start_date," / Fin: ",a.end_date]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-500",children:"Seguidores"}),e.jsxs("span",{className:"text-gray-900",children:["Inicio: ",a.seguidores_inicio," / Fin: ",a.seguidores_fin]})]})]})]}),e.jsxs("div",{className:"mb-4 flex items-center space-x-4",children:[e.jsx("select",{value:l,onChange:r=>F(r.target.value),className:"rounded border px-2 py-1",children:C.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))}),e.jsx("select",{value:x,onChange:r=>b(r.target.value),className:"rounded border px-2 py-1",children:Array.from({length:5},(r,u)=>t.getFullYear()-u).map(r=>e.jsx("option",{value:r,children:r},r))}),e.jsx("button",{onClick:S,className:"rounded bg-blue-500 px-4 py-2 text-white hover:bg-blue-600",children:"Filtrar"})]}),e.jsxs("div",{className:"mb-6 rounded-lg bg-gray-100 p-4 text-center text-xl font-bold text-gray-800 shadow-sm",children:[((B=C.find(r=>r.value===g))==null?void 0:B.label)??"Mes"," ",y]}),f.length===0?e.jsx("div",{className:"mb-6",children:e.jsx("button",{onClick:o,className:"rounded bg-blue-500 px-4 py-2 text-white hover:bg-blue-600",children:"Generar registros"})}):e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6 rounded-lg bg-white p-6 shadow-md",children:[e.jsx("h2",{className:"mb-4 text-xl font-bold text-gray-800",children:"Crear Nueva Tarea"}),e.jsxs("div",{className:"flex flex-col space-y-4 md:flex-row md:space-y-0 md:space-x-4",children:[e.jsx("input",{type:"text",placeholder:"Título de la tarea",value:j,onChange:r=>E(r.target.value),className:"w-full rounded border px-2 py-1"}),e.jsxs("select",{value:w,onChange:r=>z(r.target.value),className:"rounded border px-2 py-1",children:[e.jsx("option",{value:"1",children:"Semana 1"}),e.jsx("option",{value:"2",children:"Semana 2"}),e.jsx("option",{value:"3",children:"Semana 3"}),e.jsx("option",{value:"4",children:"Semana 4"})]}),e.jsx("button",{onClick:d,className:"rounded bg-green-500 px-4 py-2 text-white hover:bg-green-600",children:"Crear Tarea"})]})]}),e.jsx("h2",{className:"mb-4 text-xl font-semibold",children:"Tareas de Seguimiento"}),h.map(r=>e.jsxs("div",{className:"mb-8",children:[e.jsxs("h3",{className:"mb-2 text-lg font-bold text-blue-700",children:["Semana ",r]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full border border-gray-300 bg-white",children:[e.jsxs("thead",{className:"bg-gray-100",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Título/Estrategia"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Fecha Producción"}),e.jsx("th",{className:"border px-4 py-2",colSpan:2,children:"Estado Producción"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Usuario Producción"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Fecha Edición"}),e.jsx("th",{className:"border px-4 py-2",colSpan:3,children:"Estado Edición"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Usuario Edición"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Fecha Entrega"}),e.jsx("th",{className:"border px-4 py-2",colSpan:2,children:"Estado Entrega"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Comentario/Guión"})]}),e.jsxs("tr",{children:[e.jsx("th",{className:"border bg-gray-200",style:s,children:"Pendiente"}),e.jsx("th",{className:"border bg-gray-200",style:s,children:"Completado"}),e.jsx("th",{className:"border bg-gray-200",style:s,children:"Pendiente"}),e.jsx("th",{className:"border bg-gray-200",style:s,children:"En revision"}),e.jsx("th",{className:"border bg-gray-200",style:s,children:"Completado"}),e.jsx("th",{className:"border bg-gray-200",style:s,children:"Pendiente"}),e.jsx("th",{className:"border bg-gray-200",style:s,children:"Publicado"})]})]}),e.jsx("tbody",{children:Array.isArray(i[r])&&i[r].map(u=>e.jsx(k,{tarea:u,usersProduccion:p,usersEdicion:n},u.id))})]})})]},r))]})]})]})}export{K as default};
