import{j as e,$ as f,m as b,r as y}from"./app-DWYhLQL6.js";import{A as _}from"./app-layout-p7K4X7eV.js";import"./button-wMTuvAkw.js";import"./clsx-B-dksMZM.js";import"./avatar-C0bnmZQz.js";import"./createLucideIcon-DISkT-zV.js";import"./index-vDywYphy.js";import"./index-CvZMSx04.js";import"./index-C-qtZoBa.js";import"./settings-B1FLQ7wV.js";import"./app-logo-icon-HoYzQaBs.js";import"./createSvgIcon-C-V1FIKo.js";import"./DefaultPropsProvider-CHy6HlRv.js";function p({status:a,fieldName:u,value:m,onChange:s}){const x=a===m,l={pendiente:"bg-red-500 border-red-500",revision:"bg-yellow-500 border-yellow-500",completado:"bg-green-500 border-green-500"};return e.jsx("div",{className:`h-5 w-5 cursor-pointer rounded-full border-2 transition-colors duration-200 ${x?l[m]:"border-gray-400 bg-white"} `,onClick:()=>s(u,m)})}function v({tarea:a,usersProduccion:u,usersEdicion:m}){const[s,x]=y.useState({titulo:a.titulo,fecha_produccion:a.fecha_produccion??"",estado_produccion:a.estado_produccion||"pendiente",user_produccion_id:a.user_produccion_id??null,fecha_edicion:a.fecha_edicion??"",estado_edicion:a.estado_edicion||"pendiente",user_edicion_id:a.user_edicion_id??null,fecha_entrega:a.fecha_entrega??"",estado_entrega:a.estado_entrega||"pendiente",estrategia:a.estrategia,comentario:a.comentario,guion:a.guion}),l=(t,n)=>{x(i=>{const d={...i,[t]:n};return b.patch(route("tareas.actualizar",a.id),{...d,fecha_produccion:d.fecha_produccion||null,fecha_edicion:d.fecha_edicion||null,fecha_entrega:d.fecha_entrega||null},{preserveScroll:!0,onError:()=>alert("Error al actualizar tarea")}),d})},c=t=>{const{name:n,value:i}=t.target;x({...s,[n]:i})},g=t=>{const{name:n,value:i}=t.target,d=i===""?null:Number(i),r={...s,[n]:d};x(r),b.patch(route("tareas.actualizar",a.id),{...r,fecha_produccion:r.fecha_produccion||null,fecha_edicion:r.fecha_edicion||null,fecha_entrega:r.fecha_entrega||null},{preserveScroll:!0,onError:()=>alert("Error al actualizar tarea")})},o=()=>{const t={...s,fecha_produccion:s.fecha_produccion||null,fecha_edicion:s.fecha_edicion||null,fecha_entrega:s.fecha_entrega||null};b.patch(route("tareas.actualizar",a.id),t,{preserveScroll:!0,onError:()=>alert("Error al actualizar tarea")})},j=s.estado_entrega==="completado"?"bg-green-100 text-green-800":"hover:bg-gray-50";return e.jsxs("tr",{className:`text-sm ${j}`,children:[e.jsx("td",{className:"border px-4 py-2",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Título:"}),e.jsx("input",{name:"titulo",value:s.titulo,onChange:c,onBlur:o,className:"w-full rounded border px-2 py-1"}),e.jsx("label",{className:"text-xs text-gray-500",children:"Estrategia:"}),e.jsx("textarea",{name:"estrategia",value:s.estrategia,onChange:c,onBlur:o,className:"w-full resize-none rounded border px-2 py-1",rows:2})]})}),e.jsx("td",{className:"border px-4 py-2",children:e.jsx("input",{type:"date",name:"fecha_produccion",value:s.fecha_produccion,onChange:c,onBlur:o,className:"w-full rounded border px-2 py-1"})}),e.jsx("td",{className:"border px-4 py-2 text-center",children:e.jsx(p,{status:s.estado_produccion,fieldName:"estado_produccion",value:"pendiente",onChange:l})}),e.jsx("td",{className:"border px-4 py-2 text-center",children:e.jsx(p,{status:s.estado_produccion,fieldName:"estado_produccion",value:"completado",onChange:l})}),e.jsxs("td",{className:"border px-4 py-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Asignado:"}),e.jsxs("select",{name:"user_produccion_id",value:s.user_produccion_id??"",onChange:g,className:"w-full rounded border px-2 py-1",children:[e.jsx("option",{value:"",children:"Seleccionar"}),u.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsx("td",{className:"border px-4 py-2",children:e.jsx("input",{type:"date",name:"fecha_edicion",value:s.fecha_edicion,onChange:c,onBlur:o,className:"w-full rounded border px-2 py-1"})}),e.jsx("td",{className:"border px-4 py-2 text-center",children:e.jsx(p,{status:s.estado_edicion,fieldName:"estado_edicion",value:"pendiente",onChange:l})}),e.jsx("td",{className:"border px-4 py-2 text-center",children:e.jsx(p,{status:s.estado_edicion,fieldName:"estado_edicion",value:"revision",onChange:l})}),e.jsx("td",{className:"border px-4 py-2 text-center",children:e.jsx(p,{status:s.estado_edicion,fieldName:"estado_edicion",value:"completado",onChange:l})}),e.jsxs("td",{className:"border px-4 py-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Asignado:"}),e.jsxs("select",{name:"user_edicion_id",value:s.user_edicion_id??"",onChange:g,className:"w-full rounded border px-2 py-1",children:[e.jsx("option",{value:"",children:"Seleccionar"}),m.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsx("td",{className:"border px-4 py-2",children:e.jsx("input",{type:"date",name:"fecha_entrega",value:s.fecha_entrega,onChange:c,onBlur:o,className:"w-full rounded border px-2 py-1"})}),e.jsx("td",{className:"border px-4 py-2 text-center",children:e.jsx(p,{status:s.estado_entrega,fieldName:"estado_entrega",value:"pendiente",onChange:l})}),e.jsx("td",{className:"border px-4 py-2 text-center",children:e.jsx(p,{status:s.estado_entrega,fieldName:"estado_entrega",value:"completado",onChange:l})}),e.jsx("td",{className:"border px-4 py-2",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Comentario:"}),e.jsx("textarea",{name:"comentario",value:s.comentario,onChange:c,onBlur:o,className:"w-full resize-none rounded border px-2 py-1",rows:2}),e.jsx("label",{className:"text-xs text-gray-500",children:"Guión:"}),e.jsx("textarea",{name:"guion",value:s.guion,onChange:c,onBlur:o,className:"w-full resize-none rounded border px-2 py-1",rows:2})]})})]})}function $({empresa:a,tareas:u=[],usersProduccion:m,usersEdicion:s,mensaje:x}){var i,d;const l=new Date,c=l.toLocaleString("es-ES",{month:"long"}),g=l.getFullYear(),o=(u??[]).reduce((r,h)=>{const N=h.semana??"0";return r[N]||(r[N]=[]),r[N].push(h),r},{}),j=Object.keys(o).filter(Boolean).map(r=>Number(r)).sort((r,h)=>r-h).map(r=>r.toString()),t=()=>{confirm("¿Estás seguro de generar registros por defecto para esta empresa?")&&b.post(route("tareas.generar",a.id))},n={writingMode:"vertical-rl",transform:"rotate(180deg)",height:"100px",width:"30px",padding:"0 4px",textAlign:"center",verticalAlign:"bottom"};return e.jsxs(_,{children:[e.jsx(f,{title:"Tareas de Seguimiento"}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 rounded-lg bg-white p-6 shadow-md",children:[e.jsx("div",{className:"mb-4 flex items-center justify-between border-b pb-4",children:e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:a.name})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-500",children:"Categoría"}),e.jsx("span",{className:"text-gray-900",children:((i=a.category)==null?void 0:i.name)??"No asignada"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-500",children:"Duración del Contrato"}),e.jsx("span",{className:"text-gray-900",children:a.contract_duration})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-500",children:"Paquete"}),e.jsx("span",{className:"text-gray-900",children:((d=a.paquete)==null?void 0:d.nombre_paquete)??"No asignado"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-500",children:"Cliente"}),e.jsx("span",{className:"text-gray-900",children:a.nombre_cliente})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-500",children:"Fechas del Contrato"}),e.jsxs("span",{className:"text-gray-900",children:[a.start_date," - ",a.end_date]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-500",children:"Monto Mensual"}),e.jsx("span",{className:"text-gray-900",children:a.monto_mensual})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-500",children:"Seguidores"}),e.jsxs("span",{className:"text-gray-900",children:["Inicio: ",a.seguidores_inicio," / Fin: ",a.seguidores_fin]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-500",children:"Teléfono"}),e.jsx("span",{className:"text-gray-900",children:a.celular})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-500",children:"Influencer"}),e.jsx("span",{className:"text-gray-900",children:a.influencer})]})]}),e.jsx("div",{className:"mt-6 border-t pt-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-500",children:"Especificaciones"}),e.jsx("span",{className:"mt-1 text-gray-900",children:a.especificaciones})]})})]}),x&&e.jsx("div",{className:"mb-4 rounded bg-green-100 p-4 text-green-800",children:x}),e.jsx("div",{className:"mb-4",children:e.jsxs("p",{className:"text-lg font-semibold text-gray-700",children:[c.charAt(0).toUpperCase()+c.slice(1)," ",g]})}),u.length===0&&e.jsx("div",{className:"mb-6",children:e.jsx("button",{onClick:t,className:"rounded bg-blue-500 px-4 py-2 text-white hover:bg-blue-600",children:"Generar registros"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"mb-4 text-xl font-semibold",children:"Tareas de Seguimiento"}),j.length===0?e.jsx("p",{className:"py-4 text-center",children:"No hay tareas registradas."}):j.map(r=>e.jsxs("div",{className:"mb-8",children:[e.jsxs("h3",{className:"mb-2 text-lg font-bold text-blue-700",children:["Semana ",r]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full border border-gray-300 bg-white",children:[e.jsxs("thead",{className:"bg-gray-100",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Título/Estrategia"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Fecha Producción"}),e.jsx("th",{className:"border px-4 py-2",colSpan:2,children:"Estado Producción"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Usuario Producción"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Fecha Edición"}),e.jsx("th",{className:"border px-4 py-2",colSpan:3,children:"Estado Edición"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Usuario Edición"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Fecha Entrega"}),e.jsx("th",{className:"border px-4 py-2",colSpan:2,children:"Estado Entrega"}),e.jsx("th",{className:"border px-4 py-2",rowSpan:2,children:"Comentario/Guión"})]}),e.jsxs("tr",{children:[e.jsx("th",{className:"border bg-gray-200",style:n,children:"Pendiente"}),e.jsx("th",{className:"border bg-gray-200",style:n,children:"Completado"}),e.jsx("th",{className:"border bg-gray-200",style:n,children:"Pendiente"}),e.jsx("th",{className:"border bg-gray-200",style:n,children:"En revision"}),e.jsx("th",{className:"border bg-gray-200",style:n,children:"Completado"}),e.jsx("th",{className:"border bg-gray-200",style:n,children:"Pendiente"}),e.jsx("th",{className:"border bg-gray-200",style:n,children:"Publicado"})]})]}),e.jsx("tbody",{children:Array.isArray(o[r])&&o[r].map(h=>e.jsx(v,{tarea:h,usersProduccion:m,usersEdicion:s},h.id))})]})})]},r))]})]})]})}export{$ as default};
