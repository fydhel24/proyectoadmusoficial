import{q as W,r as o,j as e,Y as C,m as i}from"./app-DWYhLQL6.js";import{A as Y}from"./app-layout-p7K4X7eV.js";import{F as q}from"./index-C3gxjpFt.js";import{T as v}from"./TextField-MHNYv_sC.js";import{D as y,a as N,b as S}from"./DialogTitle-BRc-au27.js";import{D as w}from"./DialogActions-2fZYmJbN.js";import{B as d}from"./Button-BrLf_Pls.js";import"./button-wMTuvAkw.js";import"./clsx-B-dksMZM.js";import"./avatar-C0bnmZQz.js";import"./createLucideIcon-DISkT-zV.js";import"./index-vDywYphy.js";import"./index-CvZMSx04.js";import"./index-C-qtZoBa.js";import"./settings-B1FLQ7wV.js";import"./app-logo-icon-HoYzQaBs.js";import"./createSvgIcon-C-V1FIKo.js";import"./DefaultPropsProvider-CHy6HlRv.js";import"./useSlot-CO4IlLCl.js";import"./TransitionGroupContext-D4TXwhqE.js";import"./useId-o3zk_1yM.js";import"./Select-DJEe7ust.js";import"./useFormControl-CsRgqpY5.js";import"./isMuiElement-D94hBNTL.js";import"./createSimplePaletteValueFilter-WGi9SSDd.js";import"./index-DtBJPI5W.js";import"./useSlotProps-CBCDIG0V.js";import"./List-DOdfdsGa.js";import"./Paper-EniTK7He.js";import"./Typography-IkT196je.js";import"./ownerDocument-DW-IO8s5.js";import"./Modal-N30Js5sT.js";import"./useTimeout-CcjJ2cmE.js";import"./createChainedFunction-BO_9K8Jh.js";import"./Portal-Dt5KHSRP.js";import"./Fade-BWgYys4A.js";import"./debounce-Be36O1Ab.js";import"./Grow-IF_zPiYA.js";import"./useControlled-5UsadrEY.js";import"./ButtonBase-DpqQEAAf.js";import"./CircularProgress-Bo20HsGQ.js";const De=()=>{const{informes:c,filters:I}=W().props,[M,D]=o.useState(I.search||""),[E,p]=o.useState(!1),[_,x]=o.useState(!1),[n,l]=o.useState(""),[h,u]=o.useState(null),[g,b]=o.useState([]),[A,j]=o.useState(""),F=t=>{confirm("¿Eliminar este informe?")&&i.delete(route("informes.destroy",t))},O=t=>{u(t),l(""),p(!0)},m=()=>{p(!1),u(null),l("")},T=()=>{!n||h===null||i.post(route("comentarios.store"),{contenido:n,informe_id:h},{onSuccess:()=>{m(),alert("Comentario agregado con éxito!")}})},k=t=>{b(t.comentarios??[]),j(t.titulo),x(!0)},f=()=>{b([]),j(""),x(!1)},L=t=>{D(t.target.value),i.get(route("informes.index"),{search:t.target.value},{preserveState:!0,replace:!0})},B=c.data.reduce((t,s)=>{var a;const r=((a=s.company)==null?void 0:a.name)??"Sin empresa";return t[r]||(t[r]=[]),t[r].push(s),t},{});return e.jsx(Y,{children:e.jsxs("div",{className:"mx-auto max-w-7xl px-6 py-10",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Listado de Informes"}),e.jsx(C,{href:route("informes.create"),className:"rounded bg-blue-600 px-4 py-2 font-semibold text-white transition hover:bg-blue-700",children:"Crear Informe"})]}),e.jsx("div",{className:"mb-4",children:e.jsx(v,{label:"Buscar informes...",variant:"outlined",size:"small",value:M,onChange:L,className:"w-64"})}),Object.entries(B).map(([t,s])=>e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:t}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:s.map(r=>{var a;return e.jsxs("div",{className:"bg-white shadow rounded-lg p-4 hover:shadow-lg transition",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx(q,{className:"text-yellow-500 text-3xl"}),e.jsx("div",{children:e.jsx("h3",{className:"text-lg font-semibold",children:r.titulo})})]}),e.jsx("p",{className:"text-gray-600 mb-2",children:((a=r.descripcion)==null?void 0:a.substring(0,80))??"-"}),e.jsxs("p",{className:"text-xs text-gray-400 mb-2",children:["Estado: ",r.estado??"-"," | Inicio: ",r.fecha_inicio," | Fin: ",r.fecha_fin??"-"]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsx(C,{href:route("informes.edit",r.id),className:"px-2 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700",children:"Editar"}),e.jsx("button",{onClick:()=>F(r.id),className:"px-2 py-1 bg-red-600 text-white text-xs rounded hover:bg-red-700",children:"Eliminar"}),e.jsx("button",{onClick:()=>O(r.id),className:"px-2 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700",children:"Agregar Comentario"}),e.jsx("button",{onClick:()=>k(r),className:"px-2 py-1 bg-gray-600 text-white text-xs rounded hover:bg-gray-700",children:"Ver Comentarios"})]})]},r.id)})})]},t)),e.jsx("div",{className:"mt-6 flex justify-center space-x-2",children:c.links.map((t,s)=>e.jsx("button",{className:`px-3 py-1 rounded ${t.active?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`,disabled:!t.url,onClick:()=>t.url&&i.get(t.url,{},{preserveState:!0,replace:!0}),dangerouslySetInnerHTML:{__html:t.label}},s))}),e.jsxs(y,{open:E,onClose:m,children:[e.jsx(N,{children:"Agregar Comentario"}),e.jsx(S,{children:e.jsx(v,{label:"Comentario",fullWidth:!0,multiline:!0,rows:4,value:n,onChange:t=>l(t.target.value)})}),e.jsxs(w,{children:[e.jsx(d,{onClick:m,color:"secondary",children:"Cancelar"}),e.jsx(d,{onClick:T,variant:"contained",color:"primary",children:"Guardar"})]})]}),e.jsxs(y,{open:_,onClose:f,fullWidth:!0,maxWidth:"sm",children:[e.jsxs(N,{children:['Comentarios de "',A,'"']}),e.jsx(S,{dividers:!0,children:g.length>0?g.map(t=>{var s;return e.jsxs("div",{className:"mb-4 border-b border-gray-200 pb-2",children:[e.jsx("p",{className:"text-gray-800",children:t.contenido}),e.jsxs("p",{className:"text-xs text-gray-500",children:[((s=t.user)==null?void 0:s.name)??"Usuario"," - ",new Date(t.created_at).toLocaleString()]})]},t.id)}):e.jsx("p",{className:"text-gray-500",children:"No hay comentarios para este informe."})}),e.jsx(w,{children:e.jsx(d,{onClick:f,color:"primary",children:"Cerrar"})})]})]})})};export{De as default};
