import{r as o,a as n,j as i}from"./app-B43QGLc0.js";import{A as _}from"./app-layout-Be3qQQND.js";import{s as S,e as D,f as I}from"./format-BgZJCj5L.js";import"./app-logo-icon-2Eh3Z-eT.js";import"./index-CfAE_ukx.js";import"./index-HnoccPYx.js";const C=[{title:"Disponibilidad de Influencers",href:"/influencer-availability"}],T={monday:"Lunes",tuesday:"Martes",wednesday:"Miércoles",thursday:"Jueves",friday:"Viernes",saturday:"Sábado",sunday:"Domingo"},R=()=>{const[d,h]=o.useState([]),[x,y]=o.useState([]),[u,f]=o.useState({}),[v,w]=o.useState(null);o.useEffect(()=>{y(k()),l(),j()},[]);const j=()=>{n.get("/api/auth/user").then(e=>{w(e.data.id)}).catch(e=>console.error("Error fetching user id:",e))},k=()=>{const e=S(new Date,{weekStartsOn:1}),t=D(new Date,{weekStartsOn:1}),a=[];for(let s=e;s<=t;s.setDate(s.getDate()+1))a.push(new Date(s));return a},l=()=>{n.get("/api/influencer-availability").then(e=>{h(e.data);const t={};e.data.forEach(a=>{t[a.day_of_week]=a.turno}),f(t)}).catch(e=>console.error("Error fetching availabilities:",e))},p=(e,t)=>{const a=u[e];if(a===t){m(e,a);return}f(r=>({...r,[e]:t}));const s=t==="mañana"?"09:30":"14:00",c=t==="mañana"?"13:00":"18:00";d.find(r=>r.day_of_week===e&&r.turno===a)&&m(e,a);const b=d.find(r=>r.day_of_week===e&&r.turno===t);b?A(b.id,s,c):E(e,t,s,c)},E=(e,t,a,s)=>{n.post("/api/influencer-availability",{user_id:v,day_of_week:e,turno:t,start_time:a,end_time:s}).then(()=>l()).catch(c=>console.error("Error creating availability:",c))},A=(e,t,a)=>{n.put(`/api/influencer-availability/${e}`,{start_time:t,end_time:a}).then(()=>l()).catch(s=>console.error("Error updating availability:",s))},m=(e,t)=>{const a=d.find(s=>s.day_of_week===e&&s.turno===t);a&&n.delete(`/api/influencer-availability/${a.id}`).then(()=>l()).catch(s=>console.error("Error deleting availability:",s))},g=(e,t)=>u[e]===t,N=async()=>{var e,t;try{const a=await n.post("/api/asignar-empresa"),{empresa_nombre:s}=a.data;alert(`Empresas asignadas: ${s}`),window.open("/api/reporte-empresas-asignadas","_blank")}catch(a){(t=(e=a.response)==null?void 0:e.data)!=null&&t.message?alert(`${a.response.data.message}`):alert("Error desconocido al asignar empresa."),console.error("Error al asignar empresa:",a)}};return i.jsxs(_,{breadcrumbs:C,children:[i.jsx("div",{className:"flex justify-end p-6",children:i.jsx("button",{onClick:N,className:"rounded bg-blue-600 px-4 py-2 font-semibold text-white hover:bg-blue-700",children:"Asignar Empresa"})}),i.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 rounded-xl bg-gray-50 p-6",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsx("h1",{className:"text-2xl font-semibold tracking-tight text-gray-800",children:"Disponibilidad de Influencers"})}),i.jsx("div",{className:"flex items-center justify-between",children:i.jsx("h2",{className:"text-2xl tracking-tight text-gray-800",children:"Agregar los dias y turnos disponibles"})}),i.jsx("div",{className:"overflow-x-auto rounded-lg border bg-white p-6 shadow",children:i.jsx("div",{className:"grid grid-cols-7 gap-4",children:x.map((e,t)=>{const a=I(e,"EEEE").toLowerCase(),s=T[a];return i.jsxs("div",{className:"flex flex-col items-center rounded-lg border border-gray-300 p-4",children:[i.jsxs("div",{className:"mb-4 text-center font-semibold",children:[s," "]}),i.jsxs("div",{className:"flex flex-col space-y-2",children:[i.jsx("button",{onClick:()=>p(a,"mañana"),className:`rounded-md px-4 py-2 ${g(a,"mañana")?"bg-green-500 text-white":"bg-gray-200"}`,children:"Mañana"}),i.jsx("button",{onClick:()=>p(a,"tarde"),className:`rounded-md px-4 py-2 ${g(a,"tarde")?"bg-orange-500 text-white":"bg-gray-200"}`,children:"Tarde"})]})]},t)})})})]})]})};export{R as default};
