import{r as n,a as g,j as e,$ as Y,U as Z}from"./app-gcPa0s22.js";import{A as ee,c as re,B as ae}from"./app-layout-CO_KMSKV.js";import{d as R}from"./debounce-Be36O1Ab.js";import{B as p}from"./Box-DeqaGcCp.js";import{C as I}from"./Container-BSOpcVTn.js";import{T as d,P as w}from"./Typography-C3iDGIYS.js";import{S as te}from"./Stack-Bdk1KeRL.js";import{T as W}from"./TextField-CU4Ift9l.js";import{I as se}from"./InputAdornment-TnoEheyC.js";import{S as oe}from"./Search-BvbNGRVG.js";import{F as T,I as S,S as E}from"./Select-B5o_GQW_.js";import{M as l}from"./MenuItem-SlLzB4Lr.js";import{T as ie}from"./TableContainer-De6i2F0Y.js";import{T as ne,a as le,b as F,c as de}from"./TableRow-CNuGh-jM.js";import{T as s}from"./TableCell-D1PfhpaL.js";import{I as ce}from"./IconButton-DjCumPI2.js";import{C as m}from"./Chip-B5Ywctie.js";import{F as pe}from"./FolderOutlined-CkkB9K0B.js";import{C as me}from"./CalendarToday-DFbyrGqB.js";import{C as xe}from"./Collapse-CDBqJ-nW.js";import{R as he,a as z}from"./RadioGroup-CTiaRqep.js";import{F as P}from"./FormControlLabel-BWX9pNbN.js";import{P as ue}from"./Pagination-7xZgUlhP.js";import{b}from"./DefaultPropsProvider-D0UdZHkc.js";import{f as je}from"./format-C6wJrPT2.js";import"./button-DWmv4xKc.js";import"./clsx-B-dksMZM.js";import"./avatar-DEAtloF7.js";import"./createLucideIcon-DtIvEspD.js";import"./index-8qmTPeiK.js";import"./index-C3PMNp9i.js";import"./index-BZXrUZ9C.js";import"./settings-COpbVc2A.js";import"./app-logo-icon-TNEIzHJ2.js";import"./createSvgIcon-Bvn2cbuR.js";import"./useThemeProps-C-UIwKqD.js";import"./getThemeProps-D5BX1hbN.js";import"./createSimplePaletteValueFilter-BHDmXtX9.js";import"./useSlot-DDOmgoeR.js";import"./TransitionGroupContext-dVxC_wZ9.js";import"./useId-B2TArqAG.js";import"./isMuiElement-QxEqWT4A.js";import"./index-B2WmQ1i5.js";import"./useSlotProps-CY715XIJ.js";import"./List-DL6HMG9F.js";import"./ownerDocument-DW-IO8s5.js";import"./Modal-DgGQVq81.js";import"./useTimeout-D1Dphss0.js";import"./Portal-ltdkSTfj.js";import"./Fade-D2Lgt6Fr.js";import"./Grow-DazsCD7o.js";import"./useControlled-CKqLkeIN.js";import"./ButtonBase-BZ4Bemvj.js";import"./listItemTextClasses-DWX30277.js";import"./dividerClasses-DdJp5AUC.js";import"./CircularProgress-CfS9p-RR.js";import"./SwitchBase--_1mqYW6.js";import"./FormGroup-D7E7ksvP.js";import"./LastPage-BD3VpcH-.js";const ge=[{title:"Mis Tareas",href:"/pasante/mistareas"}],k=c=>{if(!c)return"#9E9E9E";switch(c.toLowerCase()){case"alta":return"#FF1744";case"media":return"#FF9100";case"baja":return"#00E676";default:return"#9E9E9E"}},be=c=>{if(!c)return"default";switch(c.toLowerCase()){case"publicada":return"success";case"en_revision":return"primary";case"pendiente":return"warning";default:return"default"}};function Tr({tareas:c,total:B,perPage:A,currentPage:L}){const[t,x]=n.useState(c),[f,_]=n.useState(null),[y,$]=n.useState(""),[h,D]=n.useState(""),[u,G]=n.useState(""),[j,O]=n.useState(""),[q,M]=n.useState(L),H=n.useCallback(R(async(r,a)=>{var o;try{await g.patch(`/tareas/actualizar-estado/${r}`,{detalle:a,estado:((o=t.find(i=>i.id===r))==null?void 0:o.estado)||"pendiente"})}catch(i){console.error("Error al guardar el detalle:",i)}},1e3),[t]),N=async(r,a)=>{var o;try{await g.patch(`/tareas/actualizar-estado/${r}`,{estado:a,detalle:((o=t.find(i=>i.id===r))==null?void 0:o.detalle)||""}),x(t.map(i=>i.id===r?{...i,estado:a}:i))}catch(i){console.error("Error al actualizar el estado:",i)}},U=(r,a)=>{x(t.map(o=>o.id===r?{...o,detalle:a}:o)),H(r,a)},J=r=>{_(f===r?null:r)},v=n.useCallback(R(async(r,a)=>{try{const o=await g.get("/pasante/mistareasencorregir",{params:{search:r,priority:a.priority,status:a.status,type:a.type,page:a.page}});x(o.data.tareas),o.data.total!==B&&M(1)}catch(o){console.error("Error al buscar tareas:",o)}},500),[]),K=r=>{const a=r.target.value;$(a),v(a,{priority:h,status:u,type:j,page:1})},C=(r,a)=>{switch(r){case"priority":D(a);break;case"status":G(a);break;case"type":O(a);break}v(y,{priority:r==="priority"?a:h,status:r==="status"?a:u,type:r==="type"?a:j,page:1})},Q=(r,a)=>{M(a),v(y,{priority:h,status:u,type:j,page:a})},V=Array.from(new Set((t==null?void 0:t.map(r=>{var a;return(a=r.tarea.tipo)==null?void 0:a.nombre_tipo}).filter(Boolean))||[])),X=async()=>{try{const r=await g.get("/pasante/mistareasencorregir",{params:{search:"",priority:"",status:"",type:"",page:1}});x(r.data.tareas)}catch(r){console.error("Error al cargar tareas:",r)}};return n.useEffect(()=>{X()},[]),e.jsxs(ee,{breadcrumbs:ge,children:[e.jsx(Y,{title:"Mis Tareas"}),e.jsx(p,{sx:{background:"linear-gradient(135deg, #1976d2 0%, #0d47a1 100%)",color:"white",py:3,position:"relative",overflow:"hidden"},children:e.jsxs(I,{maxWidth:"xl",sx:{position:"relative",zIndex:1},children:[e.jsx(d,{variant:"h4",fontWeight:"bold",children:"ðŸ“‹ Mis Tareas Asignadas"}),e.jsx(d,{variant:"subtitle1",sx:{opacity:.9},children:"Gestiona y actualiza el estado de tus tareas"})]})}),e.jsxs(I,{maxWidth:"xl",sx:{py:4},children:[e.jsx(w,{sx:{p:2,mb:3},children:e.jsx(te,{spacing:2,children:e.jsxs(p,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(W,{placeholder:"Buscar tareas...",value:y,onChange:K,sx:{flexGrow:1},InputProps:{startAdornment:e.jsx(se,{position:"start",children:e.jsx(oe,{})})}}),e.jsxs(T,{sx:{minWidth:120},children:[e.jsx(S,{children:"Prioridad"}),e.jsxs(E,{value:h,onChange:r=>C("priority",r.target.value),label:"Prioridad",children:[e.jsx(l,{value:"",children:"Todas"}),e.jsx(l,{value:"alta",children:"Alta"}),e.jsx(l,{value:"media",children:"Media"}),e.jsx(l,{value:"baja",children:"Baja"})]})]}),e.jsxs(T,{sx:{minWidth:120},children:[e.jsx(S,{children:"Estado"}),e.jsxs(E,{value:u,onChange:r=>C("status",r.target.value),label:"Estado",children:[e.jsx(l,{value:"",children:"Todos"}),e.jsx(l,{value:"pendiente",children:"pendiente"}),e.jsx(l,{value:"en_revision",children:"en_revision"}),e.jsx(l,{value:"publicada",children:"publicada"})]})]}),e.jsxs(T,{sx:{minWidth:120},children:[e.jsx(S,{children:"Tipo"}),e.jsxs(E,{value:j,onChange:r=>C("type",r.target.value),label:"Tipo",children:[e.jsx(l,{value:"",children:"Todos"}),V.map(r=>e.jsx(l,{value:r,children:r},r))]})]})]})})}),e.jsx(ie,{component:w,sx:{borderRadius:2,boxShadow:2},children:e.jsxs(ne,{children:[e.jsx(le,{children:e.jsxs(F,{sx:{bgcolor:b("#1976d2",.05)},children:[e.jsx(s,{sx:{width:"40px"}}),e.jsx(s,{children:"TÃ­tulo"}),e.jsx(s,{children:"Tipo"}),e.jsx(s,{children:"Empresa"}),e.jsx(s,{children:"Fecha"}),e.jsx(s,{children:"Prioridad"}),e.jsx(s,{children:"Estado"})]})}),e.jsx(de,{children:t==null?void 0:t.map(r=>e.jsxs(Z.Fragment,{children:[e.jsxs(F,{sx:{"&:hover":{bgcolor:b("#1976d2",.02)},borderLeft:`4px solid ${k(r.tarea.prioridad)}`},children:[e.jsx(s,{children:e.jsx(ce,{size:"small",onClick:()=>J(r.id),sx:{transform:f===r.id?"rotate(180deg)":"none",transition:"transform 0.2s"},children:e.jsx(re,{})})}),e.jsx(s,{children:e.jsx(d,{variant:"subtitle2",fontWeight:"medium",children:r.tarea.titulo})}),e.jsx(s,{children:r.tarea.tipo&&e.jsx(m,{icon:e.jsx(pe,{sx:{fontSize:16}}),label:r.tarea.tipo.nombre_tipo,size:"small",sx:{bgcolor:b("#1976d2",.1),color:"primary.main"}})}),e.jsx(s,{children:r.tarea.company&&e.jsx(m,{icon:e.jsx(ae,{fontSize:"small"}),label:r.tarea.company.name,size:"small",variant:"outlined"})}),e.jsx(s,{children:e.jsx(m,{icon:e.jsx(me,{fontSize:"small"}),label:je(new Date(r.fecha),"dd/MM/yyyy"),size:"small",variant:"outlined"})}),e.jsx(s,{children:e.jsx(m,{label:r.tarea.prioridad,size:"small",sx:{bgcolor:k(r.tarea.prioridad),color:"white"}})}),e.jsx(s,{children:e.jsx(m,{label:r.estado||"Sin estado",color:be(r.estado),size:"small"})})]}),e.jsx(F,{children:e.jsx(s,{colSpan:7,sx:{py:0},children:e.jsx(xe,{in:f===r.id,children:e.jsxs(p,{sx:{p:3},children:[e.jsx(d,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"DescripciÃ³n:"}),e.jsx(d,{variant:"body2",sx:{mb:3},children:r.tarea.descripcion}),e.jsxs(p,{sx:{p:2,bgcolor:b("#1976d2",.05),borderRadius:2},children:[e.jsx(d,{variant:"subtitle2",sx:{mb:2,fontWeight:"bold",color:"primary.main"},children:"Estado de la tarea"}),e.jsxs(he,{row:!0,value:r.estado||"pendiente",onChange:a=>N(r.id,a.target.value),sx:{mb:2},children:[e.jsx(P,{value:"pendiente",control:e.jsx(z,{color:"warning"}),label:"Pendiente"}),e.jsx(P,{value:"corregir",control:e.jsx(z,{color:"primary"}),label:"Corregir"}),e.jsx(P,{value:"en_revision",control:e.jsx(z,{color:"primary"}),label:"Realizado"})]}),e.jsx(W,{fullWidth:!0,multiline:!0,rows:2,variant:"outlined",placeholder:"Agregar detalles o comentarios sobre la tarea...",value:r.detalle||"",onChange:a=>U(r.id,a.target.value),sx:{"& .MuiOutlinedInput-root":{bgcolor:"white"}}})]})]})})})},`detail-${r.id}`)]},r.id))})]})}),(t==null?void 0:t.length)===0&&e.jsxs(w,{sx:{p:6,textAlign:"center",borderRadius:3,background:"linear-gradient(145deg, #f8f9fa 0%, #e9ecef 100%)"},children:[e.jsx(d,{variant:"h5",color:"text.secondary",sx:{mb:2},children:"ðŸ“ No tienes tareas asignadas"}),e.jsx(d,{color:"text.secondary",children:"Por el momento no hay tareas asignadas para ti"})]}),(t==null?void 0:t.length)>0&&e.jsx(p,{sx:{mt:3,display:"flex",justifyContent:"center"},children:e.jsx(ue,{count:Math.ceil(B/A),page:q,onChange:Q,color:"primary",showFirstButton:!0,showLastButton:!0})})]})]})}export{Tr as default};
