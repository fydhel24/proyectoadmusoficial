import{v as se,r as o,j as e,$ as le}from"./app-CUaISujP.js";import{A as ae}from"./app-layout-CWuB6NnO.js";import{L as k,P as te,F as re}from"./pen-line-B35v8GWd.js";import{C as oe}from"./circle-alert-DTZOHU4R.js";import{C as ie}from"./circle-check-big-DDoExZwQ.js";import{B as E}from"./building-2-D_hWWlJ2.js";import{V as ne}from"./video-DdHcLHft.js";import{P as de}from"./plus-BlkVQYG2.js";import{C as L}from"./calendar-DHBj7jZg.js";import{S as ce}from"./save-B60n0M0M.js";import{S as me}from"./search-NAu1leSR.js";import{F as xe}from"./filter-BJoXTGmp.js";import{X as ue}from"./avatar-vMY4vQMB.js";import{E as he}from"./external-link-D0QCGrTv.js";import"./button-0Hij8kFa.js";import"./clsx-B-dksMZM.js";import"./index-DZ5Pi2z6.js";import"./index-b-iRS2c_.js";import"./index-JQPl0ewz.js";import"./createLucideIcon-XVNSMSUw.js";import"./settings-CLpIyV6T.js";import"./app-logo-icon-DxXq1G7b.js";import"./createSvgIcon-CsdeE9h-.js";import"./DefaultPropsProvider-DnyQ5W7l.js";const C=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],_=10;function $e({empresas:m,registros:F}){const T=new Date,V=C[T.getMonth()],X=T.toISOString().split("T")[0],{data:j,setData:x,post:H,reset:K,processing:M}=se({company_id:"",link:"",detalle:"",mes:V,fecha:X}),[U,A]=o.useState(""),[N,P]=o.useState(null),[S,B]=o.useState(F),[u,D]=o.useState(""),[v,R]=o.useState(""),[y,I]=o.useState(""),[w,h]=o.useState(1),[$,Q]=o.useState(!1),[i,q]=o.useState(()=>{const s={};return F.forEach(l=>{var a,t,n;s[l.id]={company_id:l.company.id,link:l.link.link,detalle:l.link.detalle||"",mes:l.mes,fecha:((a=l.fecha)==null?void 0:a.slice(0,10))||"",comprobante_id:((n=(t=l.comprobante)==null?void 0:t.id)==null?void 0:n.toString())||""}}),s}),p=o.useMemo(()=>S.filter(s=>{const l=s.company.name.toLowerCase().includes(u.toLowerCase())||s.link.link.toLowerCase().includes(u.toLowerCase())||(s.link.detalle||"").toLowerCase().includes(u.toLowerCase()),a=!v||s.mes===v,t=!y||s.company.id.toString()===y;return l&&a&&t}),[S,u,v,y]),G=o.useMemo(()=>{const s=(w-1)*_;return p.slice(s,s+_)},[p,w]),O=Math.ceil(p.length/_),W=s=>{const l=m.find(a=>a.name===s);return l?l.id.toString():""},g=s=>{P(s),setTimeout(()=>P(null),3e3)},Y=()=>{D(""),R(""),I(""),h(1)},Z=s=>{s.preventDefault(),H(route("company-links.store"),{onSuccess:l=>{K(),A(""),g("✅ Registro creado correctamente");const a=l.props.flash.nuevoRegistro;a&&(B(t=>[a,...t]),q(t=>({...t,[a.id]:{company_id:a.company_id,link:a.link.link,detalle:a.link.detalle||"",mes:a.mes,fecha:a.fecha,comprobante_id:a.comprobante_id||""}})))},onError:()=>{g("❌ Error al crear el registro")}}),window.location.reload()},b=(s,l,a)=>{q(t=>({...t,[s]:{...t[s],[l]:a}}))},f=async s=>{var a;const l=i[s];if(l)try{const t=await fetch(route("company-links.update",s),{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((a=document.querySelector('meta[name="csrf-token"]'))==null?void 0:a.getAttribute("content"))||"",Accept:"application/json"},body:JSON.stringify({company_id:l.company_id,mes:l.mes,fecha:l.fecha,link:l.link,detalle:l.detalle})});if(!t.ok){const c=await t.text();console.error(`Error HTTP ${t.status}:`,c),g("❌ Error al guardar");return}const n=await t.json();g(n.message||"✅ Guardado correctamente"),B(c=>c.map(d=>d.id===s?{...d,company_id:l.company_id,mes:l.mes,fecha:l.fecha,link:{...d.link,link:l.link,detalle:l.detalle}}:d))}catch(t){console.error("Error al guardar inline:",t),g("❌ Error al guardar: "+t.message)}},ee=s=>{h(s),window.scrollTo({top:0,behavior:"smooth"})};return e.jsxs(ae,{children:[e.jsx(le,{title:"Links por Empresa"}),e.jsx("div",{className:"bg-gradient-to-br from-blue-600 via-blue-700 to-indigo-800 text-white shadow-2xl",children:e.jsx("div",{className:"px-6 py-10",children:e.jsxs("div",{className:"mb-4 flex items-center gap-4",children:[e.jsx("div",{className:"rounded-2xl bg-white/20 p-3 backdrop-blur-sm",children:e.jsx(k,{className:"h-10 w-10"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold tracking-tight",children:"Gestión de Links"}),e.jsx("p",{className:"mt-2 text-xl text-blue-100",children:"Administra los enlaces y comprobantes de cada empresa"})]})]})})}),e.jsxs("div",{className:"min-h-screen space-y-8 bg-gradient-to-br from-gray-50 to-blue-50/30 p-6",children:[N&&e.jsx("div",{className:"animate-in slide-in-from-right fixed top-4 right-4 z-50 duration-300",children:e.jsx("div",{className:`rounded-xl border-l-4 p-4 shadow-2xl backdrop-blur-sm ${N.includes("❌")?"border-red-500 bg-red-50/90 text-red-800":"border-green-500 bg-green-50/90 text-green-800"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[N.includes("❌")?e.jsx(oe,{className:"h-5 w-5"}):e.jsx(ie,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:N})]})})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-3",children:[e.jsx("div",{className:"group rounded-2xl border border-blue-100/50 bg-white/80 p-6 shadow-lg backdrop-blur-sm transition-all hover:scale-105 hover:shadow-2xl",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 p-4 shadow-lg",children:e.jsx(E,{className:"h-7 w-7 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Empresas"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:m.length})]})]})}),e.jsx("div",{className:"group rounded-2xl border border-green-100/50 bg-white/80 p-6 shadow-lg backdrop-blur-sm transition-all hover:scale-105 hover:shadow-2xl",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"rounded-xl bg-gradient-to-br from-green-500 to-green-600 p-4 shadow-lg",children:e.jsx(k,{className:"h-7 w-7 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Links"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:S.length})]})]})}),e.jsx("div",{className:"group rounded-2xl border border-purple-100/50 bg-white/80 p-6 shadow-lg backdrop-blur-sm transition-all hover:scale-105 hover:shadow-2xl",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"rounded-xl bg-gradient-to-br from-purple-500 to-purple-600 p-4 shadow-lg",children:e.jsx(ne,{className:"h-7 w-7 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Videos Activos"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:p.length})]})]})})]}),e.jsxs("div",{className:"overflow-hidden rounded-2xl border border-gray-200/50 bg-white/80 shadow-2xl backdrop-blur-sm",children:[e.jsx("div",{className:"border-b border-blue-200/50 bg-gradient-to-r from-blue-50/80 to-indigo-50/80 px-8 py-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"rounded-xl bg-blue-600 p-3",children:e.jsx(de,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-900",children:"Agregar Nuevo Link"}),e.jsx("p",{className:"mt-1 text-blue-700",children:"Completa la información para registrar un nuevo enlace"})]})]})}),e.jsxs("form",{onSubmit:Z,className:"p-8",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-gray-700",children:[e.jsx(E,{className:"h-5 w-5 text-blue-600"}),"Empresa *"]}),e.jsx("input",{list:"empresa-list",className:"w-full rounded-xl border-2 border-gray-200 p-4 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20",value:U,onChange:s=>{const l=s.target.value;A(l);const a=W(l);x("company_id",a)},required:!0,placeholder:"Selecciona una empresa..."}),e.jsx("datalist",{id:"empresa-list",children:m.map(s=>e.jsx("option",{value:s.name},s.id))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-gray-700",children:[e.jsx(L,{className:"h-5 w-5 text-blue-600"}),"Mes *"]}),e.jsxs("select",{className:"w-full rounded-xl border-2 border-gray-200 p-4 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20",value:j.mes,onChange:s=>x("mes",s.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Seleccione mes"}),C.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-gray-700",children:[e.jsx(L,{className:"h-5 w-5 text-blue-600"}),"Fecha *"]}),e.jsx("input",{type:"date",className:"w-full rounded-xl border-2 border-gray-200 p-4 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20",value:j.fecha,onChange:s=>x("fecha",s.target.value),required:!0})]}),e.jsx("div",{className:"md:col-span-2 lg:col-span-3",children:e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row",children:[e.jsxs("div",{className:"w-full space-y-2 md:w-1/3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-gray-700",children:[e.jsx(k,{className:"h-5 w-5 text-blue-600"}),"Link *"]}),e.jsx("input",{type:"url",className:"w-full rounded-xl border-2 border-gray-200 p-4 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20",value:j.link,onChange:s=>x("link",s.target.value),required:!0,placeholder:"https://www.tiktok.com/"})]}),e.jsxs("div",{className:"w-full space-y-2 md:w-2/3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-gray-700",children:[e.jsx(te,{className:"h-5 w-5 text-blue-600"}),"Detalle"]}),e.jsx("textarea",{className:"w-full resize-none rounded-xl border-2 border-gray-200 p-4 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20",rows:4,value:j.detalle,onChange:s=>x("detalle",s.target.value),placeholder:"Descripción adicional del contenido (opcional)"})]})]})})]}),e.jsx("div",{className:"mt-8 flex justify-end",children:e.jsxs("button",{type:"submit",disabled:M,className:"flex items-center gap-3 rounded-xl bg-gradient-to-r from-blue-600 to-blue-700 px-8 py-4 font-bold text-white shadow-xl transition-all duration-200 hover:scale-105 hover:from-blue-700 hover:to-blue-800 hover:shadow-2xl disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx(ce,{className:"h-5 w-5"}),M?"Guardando...":"Guardar Link"]})})]})]}),e.jsxs("div",{className:"overflow-hidden rounded-2xl border border-gray-200/50 bg-white/80 shadow-2xl backdrop-blur-sm",children:[e.jsxs("div",{className:"border-b border-blue-200/50 bg-gradient-to-r from-blue-50/80 to-indigo-50/80 px-8 py-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"rounded-xl bg-blue-600 p-3",children:e.jsx(re,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-blue-900",children:"Registros Existentes"}),e.jsxs("p",{className:"text-blue-700",children:["Mostrando ",G.length," de ",p.length," registros"]})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row",children:[e.jsxs("div",{className:"relative",children:[e.jsx(me,{className:"absolute top-1/2 left-3 h-5 w-5 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar por empresa, link o detalle...",className:"w-full rounded-xl border-2 border-gray-200 py-3 pr-4 pl-10 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20 sm:w-80",value:u,onChange:s=>{D(s.target.value),h(1)}})]}),e.jsxs("button",{onClick:()=>Q(!$),className:"flex items-center gap-2 rounded-xl border-2 border-gray-200 px-4 py-3 text-sm font-medium transition-all hover:bg-gray-50",children:[e.jsx(xe,{className:"h-4 w-4"}),"Filtros"]})]})]}),$&&e.jsx("div",{className:"mt-6 rounded-xl bg-white/50 p-6 backdrop-blur-sm",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Filtrar por empresa"}),e.jsxs("select",{className:"w-full rounded-lg border-2 border-gray-200 p-3 text-sm",value:y,onChange:s=>{I(s.target.value),h(1)},children:[e.jsx("option",{value:"",children:"Todas las empresas"}),m.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Filtrar por mes"}),e.jsxs("select",{className:"w-full rounded-lg border-2 border-gray-200 p-3 text-sm",value:v,onChange:s=>{R(s.target.value),h(1)},children:[e.jsx("option",{value:"",children:"Todos los meses"}),C.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:Y,className:"flex items-center gap-2 rounded-lg bg-gray-100 px-4 py-3 text-sm font-medium text-gray-700 transition-all hover:bg-gray-200",children:[e.jsx(ue,{className:"h-4 w-4"}),"Limpiar filtros"]})})]})})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-blue-50",children:[e.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4"}),"Empresa"]})}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-4 w-4"}),"Link"]})}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700",children:"Detalle"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),"Mes"]})}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-gray-700",children:"Fecha"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:G.map((s,l)=>{var a,t,n,c,d,z,J;return e.jsxs("tr",{className:`transition-all duration-200 hover:bg-blue-50/50 ${l%2===0?"bg-white":"bg-gray-50/50"}`,children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("select",{className:"w-full rounded-lg border-2 border-gray-200 p-3 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20",value:((a=i[s.id])==null?void 0:a.company_id)||"",onChange:r=>b(s.id,"company_id",r.target.value),onBlur:()=>f(s.id),children:m.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"url",className:"flex-1 rounded-lg border-2 border-gray-200 p-3 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20",value:((t=i[s.id])==null?void 0:t.link)||"",onChange:r=>b(s.id,"link",r.target.value),onBlur:()=>f(s.id)}),((n=i[s.id])==null?void 0:n.link)&&e.jsx("a",{href:(c=i[s.id])==null?void 0:c.link,target:"_blank",rel:"noopener noreferrer",className:"rounded-lg p-3 text-blue-600 transition-all hover:bg-blue-50 hover:text-blue-800",children:e.jsx(he,{className:"h-4 w-4"})})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"text",className:"w-full rounded-lg border-2 border-gray-200 p-3 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20",value:((d=i[s.id])==null?void 0:d.detalle)||"",onChange:r=>b(s.id,"detalle",r.target.value),onBlur:()=>f(s.id),placeholder:"Detalle..."})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("select",{className:"w-full rounded-lg border-2 border-gray-200 p-3 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20",value:((z=i[s.id])==null?void 0:z.mes)||"",onChange:r=>b(s.id,"mes",r.target.value),onBlur:()=>f(s.id),children:C.map(r=>e.jsx("option",{value:r,children:r},r))})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"date",className:"w-full rounded-lg border-2 border-gray-200 p-3 text-sm transition-all focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20",value:((J=i[s.id])==null?void 0:J.fecha)||"",onChange:r=>b(s.id,"fecha",r.target.value),onBlur:()=>f(s.id)})})]},s.id)})})]}),e.jsxs("div",{className:"flex items-center justify-between border-t border-gray-200 bg-white/50 p-6 backdrop-blur-sm",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Página ",w," de ",O]}),e.jsx("div",{className:"flex items-center gap-3",children:Array.from({length:O},(s,l)=>e.jsx("button",{onClick:()=>ee(l+1),className:`rounded-lg px-4 py-2 transition-all ${w===l+1?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-blue-50"}`,children:l+1},l+1))})]})]})]})]})]})}export{$e as default};
