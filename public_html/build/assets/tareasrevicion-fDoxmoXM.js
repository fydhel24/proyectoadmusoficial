import{r as o,a as h,j as e,$ as be}from"./app-hmuC0z_W.js";import{A as je,P as tr,B as ye,d as ve,e as Ce,c as ir}from"./app-layout-tfxOdOKB.js";import{l as Se}from"./lodash-CeRcawRR.js";import{u as or,T as p,P as we}from"./Typography-D9aOS4L9.js";import{u as sr}from"./index-4a7AVbQy.js";import{C as ee}from"./Container-mX-SkPwN.js";import{S as Ee}from"./Skeleton-BwSUdwpn.js";import{G as n}from"./Grid-B8p_XyNn.js";import{B as s}from"./Box-4C9-OmNb.js";import{F as re}from"./Fade-CwyH9ByJ.js";import{C}from"./Chip-Dcvl53u6.js";import{S as nr}from"./Slide-iQb0oPAs.js";import{A as lr}from"./Alert-n7JhyHaU.js";import{B as W}from"./Button-CI4PvYH9.js";import{S as dr}from"./Stack-ofWMD4V8.js";import{T as u}from"./TextField-C5FPbCxz.js";import{I as cr}from"./InputAdornment-DSMijJF8.js";import{S as pr}from"./Search-BGzkUUj0.js";import{A as S}from"./Autocomplete-Cn4j4H1W.js";import{A as ur}from"./Assignment-p7A9Xb_-.js";import{Z as ae}from"./Zoom-dCXXe_5O.js";import{C as $}from"./Card-DF9nCZsV.js";import{F as T,a as z}from"./Select-BXe5PBU8.js";import{R as I,a as x}from"./RadioGroup-DflsIJub.js";import{F as m}from"./FormControlLabel-BIZANsSZ.js";import{C as Fe}from"./Cancel-DLTggAVp.js";import{S as ke}from"./Save-Bgt6w-LS.js";import{A as xr}from"./Add-72XwltG9.js";import{A as mr}from"./Avatar-B5gU_Hib.js";import{I as B}from"./IconButton-5suIbhPZ.js";import{C as _e}from"./Collapse-CDdaW4f7.js";import{C as hr}from"./CalendarToday-BQPCHoPf.js";import{T as We}from"./Tooltip-C2YJTe4A.js";import{E as gr}from"./Edit-BRh_CxWN.js";import{D as fr}from"./Delete-XrUhzWCn.js";import{a as g}from"./DefaultPropsProvider-B9G9mrQg.js";import"./button-BdWLbofJ.js";import"./clsx-B-dksMZM.js";import"./avatar-SH5xSAMo.js";import"./createLucideIcon-B2A0n4jm.js";import"./index-BeDZ4tg0.js";import"./index-B2CGEqEW.js";import"./index-CDmN9uZR.js";import"./settings-B81NYrWU.js";import"./app-logo-icon-DF-2vurZ.js";import"./createSvgIcon-DmtCSiy2.js";import"./createSimplePaletteValueFilter-BLiQVDB3.js";import"./getThemeProps-Ci1Myslq.js";import"./useTimeout-CyHmLoFO.js";import"./useThemeProps-D5Z9mzbb.js";import"./isMuiElement-DUef8CkO.js";import"./TransitionGroupContext-zx_Mae6Z.js";import"./useSlot-b8oj5fjv.js";import"./ButtonBase-CKxFeLN_.js";import"./debounce-Be36O1Ab.js";import"./Modal-B3L5jhwL.js";import"./ownerDocument-DW-IO8s5.js";import"./Portal-3qAPjvvz.js";import"./Close-B1u00IW_.js";import"./useId-CIKGyZXY.js";import"./CircularProgress-DbGwbuXF.js";import"./useControlled-D8uUDMf0.js";import"./usePreviousProps-Dgau8qTv.js";import"./Popper-Bof0hLwX.js";import"./index-CPN-dXc6.js";import"./useSlotProps-B7GeVvJr.js";import"./List-e32Tbcmu.js";import"./Grow-CwDNX7JD.js";import"./SwitchBase-5uCyApIu.js";import"./FormGroup-a33Dd1O1.js";function $a(){const[w,te]=o.useState([]),[D,ie]=o.useState([]),[L,oe]=o.useState([]),[R,U]=o.useState("aleatoria"),[se,ne]=o.useState([]),[G,q]=o.useState(""),[Te,le]=o.useState(!0),[H,y]=o.useState(null),[Ie,br]=o.useState("dia"),[jr,yr]=o.useState(new Date().toISOString().split("T")[0]),[E,Re]=o.useState(""),[F,Ae]=o.useState(""),[k,ze]=o.useState(""),[de,Z]=o.useState(null),[l,j]=o.useState({titulo:"",prioridad:"",descripcion:"",fecha:"",tipo_id:"",company_id:""}),[De,K]=o.useState(!1),[d,f]=o.useState({titulo:"",prioridad:"",descripcion:"",fecha:"",tipo_id:"",company_id:""}),[ce,Q]=o.useState("no"),[pe,J]=o.useState("no"),[vr,Cr]=o.useState(null),[Sr,wr]=o.useState({estado:"",detalle:""}),[ue,xe]=o.useState({}),[X,_]=o.useState({}),[Le,Y]=o.useState(null),[Pe,me]=o.useState(""),[P,Me]=o.useState({}),Oe=or();sr(Oe.breakpoints.down("sm"));const b=async()=>{try{const[r,a,t,i]=await Promise.all([h.get("/tareas-con-asignaciones"),h.get("/api/tipos"),h.get("/api/companies"),h.get("/api/pasantes")]),A=r.data.filter(c=>{var v;return(v=c.asignados)==null?void 0:v.some(O=>{var N;return((N=O.estado)==null?void 0:N.toLowerCase().replace(/\s/g,""))==="en_revision"})});te(A),ie(a.data),oe(t.data),ne(i.data.data)}catch(r){console.error("Error al cargar datos:",r),y("Error al cargar datos.")}finally{le(!1)}},Ne=o.useCallback(async(r,a)=>{_(t=>({...t,[r]:!0}));try{await h.patch(`/asignaciones/${r}`,{estado:a}),await b()}catch(t){console.error("Error al actualizar estado:",t),y("No se pudo actualizar el estado")}finally{_(t=>({...t,[r]:!1}))}},[b]),$e=o.useCallback(Se.debounce(async(r,a)=>{_(t=>({...t,[r]:!0}));try{await h.patch(`/asignaciones/${r}`,{detalle:a}),await b()}catch(t){console.error("Error al actualizar detalle:",t),y("No se pudo actualizar el detalle")}finally{_(t=>({...t,[r]:!1}))}},1e3),[b]),Be=o.useCallback(Se.debounce(async(r,a)=>{_(t=>({...t,[r]:!0}));try{await h.put(`/tareas/${r}`,{descripcion:a}),await b(),Y(null)}catch(t){console.error("Error al actualizar descripci√≥n:",t),y("No se pudo actualizar la descripci√≥n")}finally{_(t=>({...t,[r]:!1}))}},1e3),[b]),V=o.useMemo(()=>{new Date().toISOString().split("T")[0];let r=w;return w.filter(a=>a.asignados.some(t=>{var i;return((i=t.estado)==null?void 0:i.toLowerCase().replace(/\s/g,""))==="en_revision"})),E&&(r=r.filter(a=>a.titulo.toLowerCase().includes(E.toLowerCase()))),k&&(r=r.filter(a=>a.prioridad===k)),F&&(r=r.filter(a=>a.asignados.some(t=>t.user_name===F))),r},[w,E,k,F]),M=o.useMemo(()=>{const r={};return V.forEach(a=>{a.asignados.forEach(t=>{const i=t.user_name;r[i]||(r[i]=[]),r[i].push(a)})}),r},[V]),he=o.useMemo(()=>{const r=new Set;return w.forEach(a=>{a.asignados.forEach(t=>{r.add(t.user_name)})}),Array.from(r).sort()},[w]);o.useEffect(()=>{(async()=>{try{const[a,t,i,A]=await Promise.all([h.get("/tareas-con-asignaciones"),h.get("/api/tipos"),h.get("/api/companies"),h.get("/api/pasantes")]),c=a.data.filter(v=>{var O;return(O=v.asignados)==null?void 0:O.some(N=>{var fe;return((fe=N.estado)==null?void 0:fe.toLowerCase().replace(/\s/g,""))==="en_revision"})});console.log("üìå TAREAS EN REVISI√ìN:",c),te(c),ie(t.data),oe(i.data),ne(A.data.data)}catch(a){console.error("Error al cargar datos:",a),y("Hubo un error al cargar los datos. Por favor, intenta de nuevo.")}finally{le(!1)}})()},[]),o.useEffect(()=>{const r={};Object.keys(M).forEach(a=>{r[a]=!0}),xe(r)},[M]);const Ue=r=>{xe(a=>({...a,[r]:!a[r]}))},Ge=r=>{var a,t;Z(r.id),j({titulo:r.titulo,prioridad:r.prioridad,descripcion:r.descripcion,fecha:r.fecha,tipo_id:(a=r.tipo)!=null&&a.id?String(r.tipo.id):"",company_id:(t=r.company)!=null&&t.id?String(r.company.id):""}),J(r.company?"si":"no")},qe=()=>{Z(null),j({titulo:"",prioridad:"",descripcion:"",fecha:"",tipo_id:"",company_id:""}),J("no")},He=async()=>{if(l.titulo.trim())try{const r={...l,tipo_id:l.tipo_id?Number(l.tipo_id):null,company_id:l.company_id?Number(l.company_id):null};await h.put(`/tareas/${de}`,r),Z(null),b()}catch(r){console.error("Error al actualizar tarea:",r),y("Error al actualizar la tarea")}},Ze=()=>{K(!0),f({titulo:"",prioridad:"",descripcion:"",fecha:new Date().toISOString().split("T")[0],tipo_id:"",company_id:""}),Q("no")},Ke=()=>{K(!1),f({titulo:"",prioridad:"",descripcion:"",fecha:"",tipo_id:"",company_id:""}),Q("no"),U("aleatoria"),q("")},Qe=async()=>{if(d.titulo.trim())try{const r={...d,tipo_id:d.tipo_id?Number(d.tipo_id):null,company_id:d.company_id?Number(d.company_id):null,asignacion_aleatoria:R==="aleatoria",pasante_id:R==="manual"?Number(G):null};await h.post("/create/tareas",r),K(!1),b(),U("aleatoria"),q("")}catch(r){console.error("Error al crear tarea:",r),y("Error al crear la tarea")}},Je=async r=>{if(confirm("¬øEst√°s seguro de que deseas eliminar esta tarea?"))try{await h.delete(`/tareas/${r}`),b()}catch(a){console.error("Error al eliminar tarea:",a),y("Error al eliminar la tarea")}},ge=r=>{switch(r.toLowerCase()){case"alta":return"#FF1744";case"media":return"#FF9100";case"baja":return"#00E676";default:return"#9E9E9E"}},Xe=r=>{const a=["#1976d2","#1565c0","#0d47a1","#2196f3","#0288d1","#01579b","#03a9f4","#00b0ff","#0091ea","#3f51b5"],t=r.charCodeAt(0)%a.length;return a[t]},Ye=r=>r.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2),Ve=V.filter(r=>F?r.asignados.some(a=>a.user_name.includes(F)):!0).filter(r=>k?r.prioridad===k:!0).filter(r=>E?r.titulo.toLowerCase().includes(E.toLowerCase()):!0);if(Te)return e.jsxs(je,{breadcrumbs:[{title:"Tareas",href:"/tareas"}],children:[e.jsx(be,{title:"Tareas"}),e.jsxs(ee,{maxWidth:"xl",sx:{py:4},children:[e.jsx(Ee,{variant:"rectangular",height:60,sx:{mb:2,borderRadius:1}}),e.jsx(n,{container:!0,spacing:2,children:[...Array(7)].map((r,a)=>e.jsx(n,{item:!0,xs:12,sm:6,md:!0,children:e.jsx(Ee,{variant:"rectangular",height:400,sx:{borderRadius:2}})},a))})]})]});const er=r=>{Y(r.id),me(r.descripcion||"")},rr=`
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
`,ar=r=>{Me(a=>({...a,[r]:!a[r]}))};return e.jsxs(je,{breadcrumbs:[{title:"Tareas",href:"/tareas"}],children:[e.jsx(be,{title:"Tareas"}),e.jsx("style",{children:rr}),e.jsx(s,{sx:{background:"linear-gradient(135deg, #1976d2 0%, #0d47a1 100%)",color:"white",py:3,position:"relative",overflow:"hidden"},children:e.jsx(ee,{maxWidth:"xl",sx:{position:"relative",zIndex:1},children:e.jsx(re,{in:!0,timeout:800,children:e.jsxs(s,{display:"flex",alignItems:"center",gap:1,mb:2,children:[e.jsx(p,{variant:"h5",fontWeight:"bold",children:"üìÑ Tareas"}),e.jsx(C,{label:"En Revisi√≥n",color:"warning",variant:"outlined"})]})})})}),e.jsxs(ee,{maxWidth:"xl",sx:{py:3},children:[H&&e.jsx(nr,{direction:"down",in:!!H,children:e.jsx(lr,{severity:"error",sx:{mb:3,borderRadius:2},action:e.jsx(W,{color:"inherit",size:"small",onClick:b,children:"Reintentar"}),children:H})}),e.jsx(we,{elevation:0,sx:{p:3,mb:3,borderRadius:3,background:"linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%)",border:"1px solid rgba(0,0,0,0.05)",boxShadow:"0 4px 20px rgba(0,0,0,0.08)"},children:e.jsxs(dr,{spacing:3,children:[e.jsxs(s,{sx:{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap"},children:[e.jsx(s,{sx:{flexGrow:1}}),e.jsx(s,{sx:{display:"flex",gap:1}})]}),e.jsxs(n,{container:!0,spacing:2,children:[e.jsx(n,{item:!0,xs:12,md:4,children:e.jsx(u,{fullWidth:!0,placeholder:"Buscar tareas...",value:E,onChange:r=>Re(r.target.value),InputProps:{startAdornment:e.jsx(cr,{position:"start",children:e.jsx(pr,{})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(n,{item:!0,xs:12,md:4,children:e.jsx(S,{options:he,getOptionLabel:r=>r,value:F||null,onChange:(r,a)=>Ae(a||""),clearOnEscape:!0,sx:{minWidth:300},renderInput:r=>e.jsx(u,{...r,label:"üë§ Filtrar por Usuario",placeholder:"Filtrar por usuario",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,md:4,children:e.jsx(S,{options:["alta","media","baja"],getOptionLabel:r=>r.charAt(0).toUpperCase()+r.slice(1),value:k||null,onChange:(r,a)=>ze(a||""),clearOnEscape:!0,sx:{minWidth:300},renderInput:r=>e.jsx(u,{...r,label:"‚ö° Filtrar por Prioridad",placeholder:"Filtrar por prioridad",fullWidth:!0})})})]}),e.jsxs(s,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(C,{icon:e.jsx(ur,{}),label:`${Ve.length} tareas de hoy`,color:"primary",variant:"outlined",sx:{fontWeight:"bold"}}),Ie!=="dia"&&e.jsxs(e.Fragment,{children:[e.jsx(C,{icon:e.jsx(tr,{}),label:`${he.length} usuarios`,color:"primary",variant:"outlined",sx:{fontWeight:"bold"}}),e.jsx(C,{icon:e.jsx(ye,{}),label:`${new Set(w.map(r=>{var a;return(a=r.company)==null?void 0:a.name}).filter(Boolean)).size} empresas`,color:"primary",variant:"outlined",sx:{fontWeight:"bold"}})]})]})]})}),De&&e.jsx(ae,{in:!0,children:e.jsxs($,{sx:{mb:3,borderRadius:3,border:"2px solid #1976d2",boxShadow:"0 6px 24px rgba(25, 118, 210, 0.15)"},children:[e.jsxs(s,{sx:{p:3,background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",color:"white"},children:[e.jsx(p,{variant:"h5",fontWeight:"bold",children:"‚ú® Nueva Tarea para Hoy"}),e.jsx(p,{variant:"body2",sx:{opacity:.9},children:"Completa los campos para crear la tarea"})]}),e.jsx(s,{sx:{p:4,background:"white"},children:e.jsxs(n,{container:!0,spacing:3,children:[e.jsx(n,{item:!0,xs:12,children:e.jsx(S,{options:w,getOptionLabel:r=>`${r.titulo} - ${r.fecha}`,filterOptions:(r,{inputValue:a})=>r.filter(t=>t.titulo.toLowerCase().includes(a.toLowerCase())),onChange:(r,a)=>{a&&f(t=>({...t,titulo:a.titulo,descripcion:a.descripcion}))},renderInput:r=>e.jsx(u,{...r,label:"üîç Buscar tareas existentes",placeholder:"Escribe para buscar una tarea similar...",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(u,{label:"üìù T√≠tulo",value:d.titulo,onChange:r=>f({...d,titulo:r.target.value}),fullWidth:!0,required:!0})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(u,{label:"üìÖ Fecha",type:"date",value:d.fecha,onChange:r=>f({...d,fecha:r.target.value}),fullWidth:!0,InputLabelProps:{shrink:!0}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(S,{options:D,getOptionLabel:r=>r.nombre,value:D.find(r=>r.id===Number(d.tipo_id))||null,onChange:(r,a)=>f({...d,tipo_id:a?String(a.id):""}),sx:{minWidth:280},renderInput:r=>e.jsx(u,{...r,label:"üè∑Ô∏è Tipo de tarea",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(T,{component:"fieldset",children:[e.jsx(z,{children:"‚ö° Prioridad"}),e.jsxs(I,{row:!0,value:d.prioridad,onChange:r=>f({...d,prioridad:r.target.value}),children:[e.jsx(m,{value:"alta",control:e.jsx(x,{}),label:"Alta"}),e.jsx(m,{value:"media",control:e.jsx(x,{}),label:"Media"}),e.jsx(m,{value:"baja",control:e.jsx(x,{}),label:"Baja"})]})]})}),e.jsx(n,{item:!0,xs:12,children:e.jsxs(T,{component:"fieldset",children:[e.jsx(z,{children:"üë• Asignaci√≥n"}),e.jsxs(I,{row:!0,value:R,onChange:r=>U(r.target.value),children:[e.jsx(m,{value:"aleatoria",control:e.jsx(x,{}),label:"Aleatoria"}),e.jsx(m,{value:"manual",control:e.jsx(x,{}),label:"Manual"})]})]})}),R==="manual"&&e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(S,{options:se,getOptionLabel:r=>`${r.name} (${r.email})`,value:se.find(r=>String(r.id)===G)||null,onChange:(r,a)=>q(a?String(a.id):""),sx:{minWidth:300},renderInput:r=>e.jsx(u,{...r,label:"üßë‚Äçüíº Seleccionar Pasante",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(T,{component:"fieldset",children:[e.jsx(z,{children:"üè¢ ¬øAsignar empresa?"}),e.jsxs(I,{row:!0,value:ce,onChange:r=>{Q(r.target.value),r.target.value==="no"&&f({...d,company_id:""})},children:[e.jsx(m,{value:"si",control:e.jsx(x,{}),label:"S√≠"}),e.jsx(m,{value:"no",control:e.jsx(x,{}),label:"No"})]})]})}),ce==="si"&&e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(S,{options:L,getOptionLabel:r=>r.nombre,value:L.find(r=>r.id===Number(d.company_id))||null,onChange:(r,a)=>f({...d,company_id:a?String(a.id):""}),sx:{minWidth:280},renderInput:r=>e.jsx(u,{...r,label:"üè¢ Seleccionar Empresa",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(u,{label:"üìÑ Descripci√≥n",multiline:!0,rows:3,value:d.descripcion,onChange:r=>f({...d,descripcion:r.target.value}),fullWidth:!0})}),e.jsxs(n,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:2},children:[e.jsx(W,{variant:"outlined",onClick:Ke,startIcon:e.jsx(Fe,{}),sx:{borderRadius:2,px:3,py:1,fontWeight:"bold",borderColor:"#9e9e9e",color:"#424242","&:hover":{backgroundColor:"#f5f5f5",borderColor:"#616161"}},children:"Cancelar"}),e.jsx(W,{variant:"contained",onClick:Qe,disabled:!d.titulo.trim()||R==="manual"&&!G,startIcon:e.jsx(ke,{}),sx:{borderRadius:2,px:3,py:1,fontWeight:"bold",background:"linear-gradient(45deg, #4caf50 0%, #2e7d32 100%)","&:hover":{background:"linear-gradient(45deg, #388e3c 0%, #1b5e20 100%)",transform:"scale(1.02)"},transition:"all 0.3s ease"},children:"Crear Tarea"})]})]})})]})}),de&&e.jsx(ae,{in:!0,children:e.jsxs($,{sx:{mb:3,borderRadius:3,border:"3px solid #FF9100",boxShadow:"0 8px 32px rgba(255, 145, 0, 0.2)",overflow:"hidden"},children:[e.jsxs(s,{sx:{p:3,background:"linear-gradient(135deg, #FF9100 0%, #FF6F00 100%)",color:"white"},children:[e.jsx(p,{variant:"h5",fontWeight:"bold",sx:{display:"flex",alignItems:"center",gap:1},children:"‚úèÔ∏è Editar Tarea"}),e.jsx(p,{variant:"body2",sx:{opacity:.9,mt:.5},children:"Modifica los campos que necesites actualizar"})]}),e.jsx(s,{sx:{p:4,background:"linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%)"},children:e.jsxs(n,{container:!0,spacing:3,children:[e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(u,{fullWidth:!0,label:"üìù T√≠tulo de la tarea",value:l.titulo,onChange:r=>j({...l,titulo:r.target.value}),required:!0,sx:{"& .MuiOutlinedInput-root":{borderRadius:2,"&:hover":{borderColor:"#FF9100"}}}})}),e.jsx(n,{item:!0,xs:12,md:3,children:e.jsx(u,{type:"date",fullWidth:!0,label:"üìÖ Fecha",value:l.fecha,onChange:r=>j({...l,fecha:r.target.value}),InputLabelProps:{shrink:!0},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(n,{item:!0,xs:12,md:4,children:e.jsx(S,{options:D,getOptionLabel:r=>r.nombre,value:D.find(r=>r.id===Number(l.tipo_id))||null,onChange:(r,a)=>j({...l,tipo_id:a?String(a.id):""}),sx:{minWidth:300},renderInput:r=>e.jsx(u,{...r,label:"üè∑Ô∏è Tipo de tarea",placeholder:"Selecciona un tipo",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(T,{component:"fieldset",fullWidth:!0,children:[e.jsx(z,{component:"legend",sx:{fontWeight:"bold",mb:1,color:"#FF9100"},children:"‚ö° Prioridad"}),e.jsxs(I,{row:!0,value:l.prioridad,onChange:r=>j({...l,prioridad:r.target.value}),children:[e.jsx(m,{value:"alta",control:e.jsx(x,{sx:{color:"#FF1744","&.Mui-checked":{color:"#FF1744"}}}),label:"Alta"}),e.jsx(m,{value:"media",control:e.jsx(x,{sx:{color:"#FF9100","&.Mui-checked":{color:"#FF9100"}}}),label:"Media"}),e.jsx(m,{value:"baja",control:e.jsx(x,{sx:{color:"#00E676","&.Mui-checked":{color:"#00E676"}}}),label:"Baja"})]})]})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(T,{component:"fieldset",fullWidth:!0,children:[e.jsx(z,{component:"legend",sx:{fontWeight:"bold",mb:1,color:"#FF9100"},children:"üè¢ ¬øCambiar empresa?"}),e.jsxs(I,{row:!0,value:pe,onChange:r=>{J(r.target.value),r.target.value==="no"&&j({...l,company_id:""})},children:[e.jsx(m,{value:"si",control:e.jsx(x,{}),label:"S√≠"}),e.jsx(m,{value:"no",control:e.jsx(x,{}),label:"No"})]})]})}),pe==="si"&&e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(S,{options:L,getOptionLabel:r=>r.nombre,value:L.find(r=>r.id===Number(l.company_id))||null,onChange:(r,a)=>j({...l,company_id:a?String(a.id):""}),sx:{minWidth:300},renderInput:r=>e.jsx(u,{...r,label:"üè¢ Empresa",placeholder:"Selecciona una empresa",fullWidth:!0})})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(u,{fullWidth:!0,multiline:!0,rows:3,label:"üìÑ Descripci√≥n",value:l.descripcion,onChange:r=>j({...l,descripcion:r.target.value}),placeholder:"Describe la tarea en detalle...",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(n,{item:!0,xs:12,children:e.jsxs(s,{sx:{display:"flex",gap:2,justifyContent:"flex-end"},children:[e.jsx(W,{variant:"outlined",startIcon:e.jsx(Fe,{}),onClick:qe,sx:{borderRadius:2,minWidth:120},children:"Cancelar"}),e.jsx(W,{variant:"contained",startIcon:e.jsx(ke,{}),onClick:He,disabled:!l.titulo.trim(),sx:{borderRadius:2,minWidth:120,background:"linear-gradient(45deg, #FF9100 0%, #FF6F00 100%)","&:hover":{background:"linear-gradient(45deg, #FF8F00 0%, #E65100 100%)"}},children:"Actualizar"})]})})]})})]})}),e.jsx(re,{in:!0,children:e.jsx(s,{children:Object.keys(M).length===0?e.jsxs(we,{sx:{p:6,textAlign:"center",borderRadius:3,background:"linear-gradient(145deg, #f8f9fa 0%, #e9ecef 100%)"},children:[e.jsx(p,{variant:"h5",color:"text.secondary",sx:{mb:2},children:"üìù No hay tareas para hoy"}),e.jsx(p,{color:"text.secondary",sx:{mb:3},children:"No se encontraron tareas programadas para hoy"}),e.jsx(W,{variant:"contained",startIcon:e.jsx(xr,{}),onClick:()=>Ze(),sx:{borderRadius:2,background:"linear-gradient(45deg, #1976d2 0%, #0d47a1 100%)"},children:"Crear primera tarea"})]}):Object.entries(M).map(([r,a],t)=>e.jsx(re,{in:!0,timeout:300+t*100,children:e.jsxs($,{sx:{mb:3,borderRadius:3,overflow:"hidden",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:3,background:"linear-gradient(135deg, #1976d2 0%, #2196f3 100%)",color:"white",cursor:"pointer","&:hover":{background:"linear-gradient(135deg, #1565c0 0%, #1976d2 100%)"},transition:"background 0.3s ease"},onClick:()=>Ue(r),children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(mr,{sx:{bgcolor:"white",color:Xe(r),fontWeight:"bold",width:48,height:48},children:Ye(r)}),e.jsxs(s,{children:[e.jsx(p,{variant:"h5",fontWeight:"bold",children:r}),e.jsxs(p,{variant:"body1",sx:{opacity:.9},children:[a.length," ",a.length===1?"tarea asignada":"tareas asignadas"]})]})]}),e.jsx(B,{sx:{color:"white"},children:ue[r]?e.jsx(ve,{}):e.jsx(Ce,{})})]}),e.jsx(_e,{in:ue[r]??!0,children:e.jsx(s,{sx:{p:2},children:a.map((i,A)=>e.jsx(ae,{in:!0,style:{transitionDelay:`${A*100}ms`},children:e.jsxs($,{sx:{mb:2,borderRadius:2,border:"1px solid rgba(0,0,0,0.1)",transition:"all 0.3s ease","&:hover":{boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},borderLeft:`6px solid ${ge(i.prioridad)}`,overflow:"hidden"},children:[e.jsxs(s,{onClick:()=>ar(i.id),sx:{p:2,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",bgcolor:P[i.id]?g("#1976d2",.02):"transparent","&:hover":{bgcolor:g("#1976d2",.05)},transition:"background-color 0.2s ease"},children:[e.jsxs(s,{sx:{flexGrow:1},children:[e.jsx(p,{variant:"h6",fontWeight:"bold",sx:{mb:1,color:P[i.id]?"#1976d2":"text.primary"},children:i.titulo}),e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsx(C,{size:"small",label:i.prioridad.toUpperCase(),sx:{bgcolor:ge(i.prioridad),color:"white",fontWeight:"bold",fontSize:"0.75rem"}}),e.jsx(C,{size:"small",icon:e.jsx(hr,{fontSize:"small"}),label:i.fecha,variant:"outlined",color:"primary"}),i.tipo&&e.jsx(C,{size:"small",icon:e.jsx(ir,{fontSize:"small"}),label:i.tipo.nombre_tipo,variant:"outlined",color:"primary"}),i.company&&e.jsx(C,{size:"small",icon:e.jsx(ye,{fontSize:"small"}),label:i.company.name,variant:"outlined",color:"primary"})]})]}),e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(We,{title:"Editar tarea",children:e.jsx(B,{onClick:c=>{c.stopPropagation(),Ge(i)},size:"small",color:"primary",sx:{bgcolor:g("#1976d2",.1),"&:hover":{bgcolor:g("#1976d2",.2)}},children:e.jsx(gr,{fontSize:"small"})})}),e.jsx(We,{title:"Eliminar tarea",children:e.jsx(B,{onClick:c=>{c.stopPropagation(),Je(i.id)},size:"small",color:"error",sx:{bgcolor:g("#f44336",.1),"&:hover":{bgcolor:g("#f44336",.2)}},children:e.jsx(fr,{fontSize:"small"})})}),e.jsx(B,{size:"small",sx:{color:"#1976d2"},children:P[i.id]?e.jsx(ve,{}):e.jsx(Ce,{})})]})]}),e.jsx(_e,{in:P[i.id]??!1,children:e.jsx(s,{sx:{px:3,pb:3},children:e.jsxs(s,{sx:{borderTop:"1px solid rgba(0,0,0,0.1)",pt:2},children:[i.asignados.map(c=>e.jsxs(s,{sx:{mb:3,p:2,borderRadius:2,bgcolor:g("#1976d2",.02),border:"1px solid rgba(25, 118, 210, 0.1)"},children:[e.jsxs(s,{sx:{mb:2},children:[e.jsxs(p,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:"bold",display:"flex",alignItems:"center",gap:1},children:["üìä Estado de la tarea:",X[c.id]&&e.jsx(s,{sx:{width:16,height:16,border:"2px solid #1976d2",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}})]}),e.jsx(T,{component:"fieldset",size:"small",children:e.jsxs(I,{row:!0,value:c.estado,onChange:v=>Ne(c.id,v.target.value),sx:{gap:2,flexWrap:"wrap"},children:[e.jsx(m,{value:"pendiente",control:e.jsx(x,{size:"small",sx:{color:"#FF9100","&.Mui-checked":{color:"#FF9100"},"&:hover":{bgcolor:g("#FF9100",.1)}}}),label:e.jsx(p,{variant:"body2",sx:{fontSize:"0.875rem"},children:"Pendiente"})}),e.jsx(m,{value:"en_revision",control:e.jsx(x,{size:"small",sx:{color:"#2196F3","&.Mui-checked":{color:"#2196F3"},"&:hover":{bgcolor:g("#2196F3",.1)}}}),label:e.jsx(p,{variant:"body2",sx:{fontSize:"0.875rem"},children:"En revisi√≥n"})}),e.jsx(m,{value:"publicada",control:e.jsx(x,{size:"small",sx:{color:"#4CAF50","&.Mui-checked":{color:"#4CAF50"},"&:hover":{bgcolor:g("#4CAF50",.1)}}}),label:e.jsx(p,{variant:"body2",sx:{fontSize:"0.875rem"},children:"Publicada"})})]})})]}),e.jsxs(s,{sx:{mb:2},children:[e.jsxs(p,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:"bold",display:"flex",alignItems:"center",gap:1},children:["üìù Detalle del progreso:",X[c.id]&&e.jsx(p,{variant:"caption",color:"primary",sx:{fontStyle:"italic"},children:"Guardando..."})]}),e.jsx(u,{fullWidth:!0,size:"small",multiline:!0,rows:2,placeholder:"Escribe aqu√≠ los detalles del progreso...",defaultValue:c.detalle||"",onChange:v=>$e(c.id,v.target.value),sx:{"& .MuiOutlinedInput-root":{borderRadius:2,bgcolor:"white","&:hover":{bgcolor:"white",borderColor:"#1976d2"},"&.Mui-focused":{bgcolor:"white",borderColor:"#1976d2"}}}})]})]},c.id)),e.jsxs(s,{sx:{mt:2},children:[e.jsxs(p,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:"bold",display:"flex",alignItems:"center",gap:1},children:["üìÑ Descripci√≥n de la tarea:",X[i.id]&&e.jsx(p,{variant:"caption",color:"primary",sx:{fontStyle:"italic"},children:"Guardando..."})]}),Le===i.id?e.jsx(u,{fullWidth:!0,multiline:!0,rows:3,value:Pe,onChange:c=>{me(c.target.value),Be(i.id,c.target.value)},onBlur:()=>Y(null),autoFocus:!0,placeholder:"Describe la tarea en detalle...",sx:{"& .MuiOutlinedInput-root":{borderRadius:2,bgcolor:"white","&:hover":{borderColor:"#1976d2"}}}}):e.jsx(s,{onClick:()=>er(i),sx:{p:2,borderRadius:2,bgcolor:"white",border:"1px dashed rgba(25, 118, 210, 0.3)",cursor:"pointer",transition:"all 0.2s ease","&:hover":{bgcolor:g("#1976d2",.02),borderColor:"#1976d2",borderStyle:"solid"}},children:e.jsx(p,{variant:"body2",color:i.descripcion?"text.primary":"text.secondary",sx:{fontStyle:i.descripcion?"normal":"italic",lineHeight:1.5},children:i.descripcion||"Haz clic para agregar una descripci√≥n..."})})]})]})})})]})},i.id))})})]})},r))})})]})]})}export{$a as default};
