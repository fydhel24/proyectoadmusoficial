import{r as o,j as e,a as T,$ as Ne}from"./app-BS78KgI9.js";import{A as He,e as xr,P as ur,B as we,d as $e,c as hr,b as pr}from"./app-layout-DXAC2WAv.js";import{u as mr,T as n,P as U}from"./Typography-CcX01ihT.js";import{u as gr}from"./index-Vlg2qeMU.js";import{C as Se}from"./Container-C0tUgWAO.js";import{S as Be}from"./Skeleton-CQvgX6d8.js";import{G as l}from"./Grid-rYS9TwvK.js";import{B as t}from"./Box-DUIKlT8z.js";import{F as V}from"./Fade-FGt6R6vx.js";import{S as fr}from"./Slide-BJETzD5t.js";import{A as jr}from"./Alert-B4Vyu2Ut.js";import{B as v}from"./Button-DqXQBeNq.js";import{S as ke}from"./Stack-D-Gkkt_v.js";import{A as br}from"./ArrowBack-DwV3HcQc.js";import{c as X}from"./createSvgIcon-12aY9Ngm.js";import{T as G}from"./Tooltip-IWvH1ko8.js";import{I as F}from"./IconButton-CZ7CUvid.js";import{A as q}from"./Add--ainIzPA.js";import{T as g}from"./TextField-CvGdJWCa.js";import{I as vr}from"./InputAdornment-BT-QByY7.js";import{S as yr}from"./Search-0IMiUOv4.js";import{M as p}from"./MenuItem-D3GBDHMT.js";import{C}from"./Chip-co4ExwZU.js";import{A as Cr}from"./Assignment-BGjdoqf6.js";import{Z as Y}from"./Zoom-sbauqwfM.js";import{C as Z}from"./Card-Cu_cYAkA.js";import{F as P,a as Q}from"./Select-9OsFqQh0.js";import{R as O,a as f}from"./RadioGroup-k_8zM7ga.js";import{F as j}from"./FormControlLabel-CLdvIqrW.js";import{A as de}from"./Avatar-Bg0t12nq.js";import{C as Ie}from"./Cancel-DP0BWe5k.js";import{S as Fe}from"./Save-CWrtrFzm.js";import{S as Ue}from"./Star-DfmZOi2m.js";import{a as wr,L as Sr}from"./List-ctjg6MFH.js";import{L as kr,a as Ir}from"./ListItem-CQRwmEoj.js";import{c as Fr}from"./clsx-B-dksMZM.js";import{a as Er,g as Wr,u as Dr,s as Mr,c as Tr,b as w}from"./DefaultPropsProvider-Dk6HDr1M.js";import{T as Rr}from"./TrendingUp-D1KjND_D.js";import{L as zr}from"./ListItemText-6FJsXUZA.js";import{C as Ve}from"./CalendarToday-me7VNsZg.js";import{E as Ee}from"./Edit-07f2nKEV.js";import{D as Ge}from"./Delete-BBGxcFmB.js";import{D as Ar}from"./Divider-B8ontJjP.js";import{C as _r}from"./Collapse-C4kprWT0.js";import{F as Lr}from"./Fab-YqvAyP3a.js";import"./button-oAFDZpeO.js";import"./avatar-BWsYigjR.js";import"./createLucideIcon-D-6WHVmO.js";import"./index-Qic-rRyU.js";import"./index--gTV4hvx.js";import"./index-DBd0QHkk.js";import"./settings-DV0Bctrx.js";import"./app-logo-icon-GUvtkzgu.js";import"./getThemeProps--CMPU-9n.js";import"./useTimeout-oSTK7AfQ.js";import"./useThemeProps-hgA8uWgq.js";import"./isMuiElement-w8fP3KeW.js";import"./debounce-Be36O1Ab.js";import"./Modal-BH4F5tNL.js";import"./useSlot-DerHgNuN.js";import"./Portal-CCwm8dqL.js";import"./Close-CzLUv769.js";import"./useId-DZf0Wwsg.js";import"./ButtonBase-DLk8W6EL.js";import"./CircularProgress-DHT395bS.js";import"./index-BZb61BhM.js";import"./useControlled-wSjlUgLl.js";import"./Grow-CxMvSjLL.js";import"./Popper-DnDfq_y6.js";import"./useSlotProps-Cf7xKLKx.js";import"./listItemTextClasses-CBB9ZnPp.js";import"./dividerClasses-893dsvZ6.js";import"./SwitchBase-D7t7AbaY.js";import"./FormGroup-CipON7Nh.js";function Pr(h){return Er("MuiListItemAvatar",h)}Wr("MuiListItemAvatar",["root","alignItemsFlexStart"]);const Or=h=>{const{alignItems:E,classes:W}=h;return Tr({root:["root",E==="flex-start"&&"alignItemsFlexStart"]},Pr,W)},Nr=Mr("div",{name:"MuiListItemAvatar",slot:"Root",overridesResolver:(h,E)=>{const{ownerState:W}=h;return[E.root,W.alignItems==="flex-start"&&E.alignItemsFlexStart]}})({minWidth:56,flexShrink:0,variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}),Hr=o.forwardRef(function(E,W){const N=Dr({props:E,name:"MuiListItemAvatar"}),{className:J,...ce}=N,R=o.useContext(wr),_={...N,alignItems:R.alignItems},xe=Or(_);return e.jsx(Nr,{className:Fr(xe.root,J),ownerState:_,ref:W,...ce})}),$r=X(e.jsx("path",{d:"M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2M8 11H4V6h4zm6 0h-4V6h4zm6 0h-4V6h4zM8 18H4v-5h4zm6 0h-4v-5h4zm6 0h-4v-5h4z"})),Br=X([e.jsx("circle",{cx:"12",cy:"19",r:"2"},"0"),e.jsx("path",{d:"M10 3h4v12h-4z"},"1")]),Ur=X(e.jsx("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"})),Vr=X(e.jsx("path",{d:"m16 18 2.29-2.29-4.88-4.88-4 4L2 7.41 3.41 6l6 6 4-4 6.3 6.29L22 12v6z"})),Gr=X(e.jsx("path",{d:"M3 14h4v-4H3zm0 5h4v-4H3zM3 9h4V5H3zm5 5h13v-4H8zm0 5h13v-4H8zM8 5v4h13V5z"}));function ht(){const[h,E]=o.useState([]),[W,N]=o.useState([]),[J,ce]=o.useState([]),[R,_]=o.useState("aleatoria"),[xe,qe]=o.useState([]),[ue,K]=o.useState(""),[Ye,We]=o.useState(!0),[he,L]=o.useState(null),[De,Me]=o.useState({}),[d,H]=o.useState("semana"),[z,Te]=o.useState(null),[ee,Ze]=o.useState(""),[re,Qe]=o.useState(""),[ae,Xe]=o.useState(""),[pe,te]=o.useState(null),[c,k]=o.useState({titulo:"",prioridad:"",descripcion:"",fecha:"",tipo_id:"",company_id:""}),[Re,se]=o.useState(!1),[x,I]=o.useState({titulo:"",prioridad:"",descripcion:"",fecha:"",tipo_id:"",company_id:""}),[ze,me]=o.useState("no"),[Ae,ge]=o.useState("no"),Je=mr();gr(Je.breakpoints.down("sm"));const D=o.useCallback(async()=>{We(!0),L(null);try{const[r,a,s,i]=await Promise.all([T.get("/tareas-con-asignaciones"),T.get("/api/tipos"),T.get("/api/companies"),T.get("/api/pasantes")]);E(r.data),N(a.data),ce(s.data),qe(i.data)}catch(r){console.error("Error al cargar datos:",r),L("Hubo un error al cargar los datos. Por favor, intenta de nuevo.")}finally{We(!1)}},[]);o.useEffect(()=>{D()},[D]);const $=o.useCallback(r=>{const[a,s,i]=r.split("-").map(S=>Number.parseInt(S,10));return new Date(a,s-1,i)},[]),ie=o.useCallback(r=>{const a=$(r),s=new Date,S=(s.getDay()+6)%7,u=new Date(s);u.setDate(s.getDate()-S),u.setHours(0,0,0,0);const m=new Date(u);return m.setDate(u.getDate()+6),m.setHours(23,59,59,999),a>=u&&a<=m},[$]),fe=o.useMemo(()=>{const r=new Date,s=(r.getDay()+6)%7,i=new Date(r);i.setDate(r.getDate()-s),i.setHours(0,0,0,0);const S=[];for(let u=0;u<7;u++){const m=new Date(i);m.setDate(i.getDate()+u);const b=m.getFullYear(),y=String(m.getMonth()+1).padStart(2,"0"),Ce=String(m.getDate()).padStart(2,"0");S.push(`${b}-${y}-${Ce}`)}return S},[]),A=o.useMemo(()=>{let r=h;if(d==="semana")r=h.filter(a=>ie(a.fecha));else if(d==="mes"){const a=new Date;r=h.filter(s=>{const i=$(s.fecha);return i.getMonth()===a.getMonth()&&i.getFullYear()===a.getFullYear()})}else d==="dia"&&z&&(r=h.filter(a=>a.fecha===z));return ee&&(r=r.filter(a=>a.titulo.toLowerCase().includes(ee.toLowerCase()))),ae&&(r=r.filter(a=>a.prioridad===ae)),re&&(r=r.filter(a=>a.asignados.some(s=>s.user_name===re))),r},[h,d,z,ie,$,ee,ae,re]),Ke=o.useMemo(()=>{const r={};return d==="semana"&&h.filter(a=>ie(a.fecha)).forEach(a=>{r[a.fecha]||(r[a.fecha]=[]),r[a.fecha].push(a)}),r},[h,d,ie]),oe=o.useMemo(()=>{if(d!=="dia")return{};const r={};return A.forEach(a=>{a.asignados.forEach(s=>{const i=s.user_name;r[i]||(r[i]=[]),r[i].push(a)})}),r},[A,d]),_e=o.useMemo(()=>{const r=new Set;return h.forEach(a=>{a.asignados.forEach(s=>{r.add(s.user_name)})}),Array.from(r).sort()},[h]);o.useEffect(()=>{const r={};Object.keys(oe).forEach(a=>{r[a]=!0}),Me(r)},[oe]);const er=r=>{Me(a=>({...a,[r]:!a[r]}))},Le=r=>{Te(r),H("dia")},rr=()=>{H("semana"),Te(null),te(null),se(!1)},Pe=r=>{var a,s;te(r.id),k({titulo:r.titulo,prioridad:r.prioridad,descripcion:r.descripcion,fecha:r.fecha,tipo_id:(a=r.tipo)!=null&&a.id?String(r.tipo.id):"",company_id:(s=r.company)!=null&&s.id?String(r.company.id):""}),ge(r.company?"si":"no")},ar=()=>{te(null),k({titulo:"",prioridad:"",descripcion:"",fecha:"",tipo_id:"",company_id:""}),ge("no")},B=r=>{se(!0),I({titulo:"",prioridad:"",descripcion:"",fecha:r||new Date().toISOString().split("T")[0],tipo_id:"",company_id:""}),me("no")},tr=()=>{se(!1),I({titulo:"",prioridad:"",descripcion:"",fecha:"",tipo_id:"",company_id:""}),me("no"),_("aleatoria"),K("")},sr=async()=>{if(x.titulo.trim())try{const r={...x,tipo_id:x.tipo_id?Number(x.tipo_id):null,company_id:x.company_id?Number(x.company_id):null,asignacion_aleatoria:R==="aleatoria",pasante_id:R==="manual"?Number(ue):null};await T.post("/create/tareas",r),se(!1),D(),_("aleatoria"),K("")}catch(r){console.error("Error al crear tarea:",r),L("Error al crear la tarea")}},Oe=async r=>{if(confirm("Â¿EstÃ¡s seguro de que deseas eliminar esta tarea?"))try{await T.delete(`/tareas/${r}`),D()}catch(a){console.error("Error al eliminar tarea:",a),L("Error al eliminar la tarea")}},M=r=>{switch(r.toLowerCase()){case"alta":return"#FF1744";case"media":return"#FF9100";case"baja":return"#00E676";default:return"#9E9E9E"}},je=r=>{const a=["#1976d2","#1565c0","#0d47a1","#2196f3","#0288d1","#01579b","#03a9f4","#00b0ff","#0091ea","#3f51b5"],s=r.charCodeAt(0)%a.length;return a[s]},be=r=>r.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2),ir=(r,a=!1)=>{if(a)return"linear-gradient(135deg, #FF6B35 0%, #F7931E 50%, #FFD23F 100%)";const s=["linear-gradient(135deg, #667eea 0%, #764ba2 100%)","linear-gradient(135deg, #f093fb 0%, #f5576c 100%)","linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)","linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)","linear-gradient(135deg, #fa709a 0%, #fee140 100%)","linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)","linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%)"];return s[r%s.length]},[ve,ye]=o.useState(null),[ne,le]=o.useState({estado:"",detalle:""});if(Ye)return e.jsxs(He,{breadcrumbs:[{title:"Tareas",href:"/tareas"}],children:[e.jsx(Ne,{title:"Tareas"}),e.jsxs(Se,{maxWidth:"xl",sx:{py:4},children:[e.jsx(Be,{variant:"rectangular",height:60,sx:{mb:2,borderRadius:1}}),e.jsx(l,{container:!0,spacing:2,children:[...Array(7)].map((r,a)=>e.jsx(l,{item:!0,xs:12,sm:6,md:!0,children:e.jsx(Be,{variant:"rectangular",height:400,sx:{borderRadius:2}})},a))})]})]});function or(r){ye(r.id),le({estado:r.estado,detalle:r.detalle??""})}function nr(){ye(null),le({estado:"",detalle:""})}async function lr(){if(ve)try{await T.patch(`/asignaciones/${ve}`,{estado:ne.estado,detalle:ne.detalle}),await D(),ye(null)}catch(r){console.error("Error al actualizar asignaciÃ³n:",r),L("No se pudo actualizar la asignaciÃ³n")}}const dr=async()=>{if(c.titulo.trim())try{const r={...c,tipo_id:c.tipo_id?Number(c.tipo_id):null,company_id:c.company_id?Number(c.company_id):null};await T.put(`/tareas/${pe}`,r),te(null),D()}catch(r){console.error("Error al actualizar tarea:",r),L("Error al actualizar la tarea")}};return e.jsxs(He,{breadcrumbs:[{title:"Tareas",href:"/tareas"}],children:[e.jsx(Ne,{title:"Tareas"}),e.jsx(t,{sx:{background:"linear-gradient(135deg, #1976d2 0%, #0d47a1 100%)",color:"white",py:3,position:"relative",overflow:"hidden"},children:e.jsx(Se,{maxWidth:"xl",sx:{position:"relative",zIndex:1},children:e.jsx(V,{in:!0,timeout:800,children:e.jsxs(t,{children:[e.jsxs(n,{variant:"h4",fontWeight:"bold",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:["ðŸ“… ",d==="dia"?`Tareas del ${z}`:"GestiÃ³n de Tareas"]}),e.jsx(n,{variant:"subtitle1",sx:{opacity:.9},children:d==="dia"?"Edita las tareas directamente en la lista":"Organiza y gestiona todas tus tareas de manera eficiente"})]})})})}),e.jsxs(Se,{maxWidth:"xl",sx:{py:3},children:[he&&e.jsx(fr,{direction:"down",in:!!he,children:e.jsx(jr,{severity:"error",sx:{mb:3,borderRadius:2},action:e.jsx(v,{color:"inherit",size:"small",onClick:D,children:"Reintentar"}),children:he})}),e.jsx(U,{elevation:0,sx:{p:3,mb:3,borderRadius:3,background:"linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%)",border:"1px solid rgba(0,0,0,0.05)",boxShadow:"0 4px 20px rgba(0,0,0,0.08)"},children:e.jsxs(ke,{spacing:3,children:[e.jsxs(t,{sx:{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap"},children:[d==="dia"&&e.jsx(v,{variant:"outlined",startIcon:e.jsx(br,{}),onClick:rr,sx:{borderRadius:2,borderColor:"#1976d2",color:"#1976d2"},children:"Volver a la semana"}),e.jsxs(t,{sx:{display:"flex",gap:1},children:[e.jsx(v,{variant:d==="semana"?"contained":"outlined",startIcon:e.jsx(xr,{}),onClick:()=>H("semana"),sx:{borderRadius:2},children:"Semana"}),e.jsx(v,{variant:d==="mes"?"contained":"outlined",startIcon:e.jsx($r,{}),onClick:()=>H("mes"),sx:{borderRadius:2},children:"Mes"}),e.jsx(v,{variant:d==="todas"?"contained":"outlined",startIcon:e.jsx(Gr,{}),onClick:()=>H("todas"),sx:{borderRadius:2},children:"Todas"})]}),e.jsx(t,{sx:{flexGrow:1}}),e.jsxs(t,{sx:{display:"flex",gap:1},children:[e.jsx(G,{title:"Actualizar",children:e.jsx(F,{onClick:D,sx:{bgcolor:"white","&:hover":{bgcolor:"grey.100"}},children:e.jsx(Ur,{})})}),e.jsx(v,{variant:"contained",onClick:()=>B(),startIcon:e.jsx(q,{}),sx:{borderRadius:2,background:"linear-gradient(45deg, #1976d2 0%, #0d47a1 100%)","&:hover":{background:"linear-gradient(45deg, #1565c0 0%, #0a3880 100%)"},px:3,py:1},children:"Nueva Tarea Para HOY"})]})]}),d!=="dia"&&e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{item:!0,xs:12,md:4,children:e.jsx(g,{fullWidth:!0,placeholder:"Buscar tareas...",value:ee,onChange:r=>Ze(r.target.value),InputProps:{startAdornment:e.jsx(vr,{position:"start",children:e.jsx(yr,{})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(l,{item:!0,xs:12,md:4,children:e.jsxs(g,{select:!0,fullWidth:!0,label:"Filtrar por usuario",value:re,onChange:r=>Qe(r.target.value),sx:{"& .MuiOutlinedInput-root":{borderRadius:2}},children:[e.jsx(p,{value:"",children:"Todos los usuarios"}),_e.map(r=>e.jsx(p,{value:r,children:r},r))]})}),e.jsx(l,{item:!0,xs:12,md:4,children:e.jsxs(g,{select:!0,fullWidth:!0,label:"Filtrar por prioridad",value:ae,onChange:r=>Xe(r.target.value),sx:{"& .MuiOutlinedInput-root":{borderRadius:2}},children:[e.jsx(p,{value:"",children:"Todas las prioridades"}),e.jsx(p,{value:"alta",children:"Alta"}),e.jsx(p,{value:"media",children:"Media"}),e.jsx(p,{value:"baja",children:"Baja"})]})})]}),e.jsxs(t,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(C,{icon:e.jsx(Cr,{}),label:`${A.length} tareas`,color:"primary",variant:"outlined",sx:{fontWeight:"bold"}}),d!=="dia"&&e.jsxs(e.Fragment,{children:[e.jsx(C,{icon:e.jsx(ur,{}),label:`${_e.length} usuarios`,color:"primary",variant:"outlined",sx:{fontWeight:"bold"}}),e.jsx(C,{icon:e.jsx(we,{}),label:`${new Set(h.map(r=>{var a;return(a=r.company)==null?void 0:a.name}).filter(Boolean)).size} empresas`,color:"primary",variant:"outlined",sx:{fontWeight:"bold"}})]})]})]})}),Re&&e.jsx(Y,{in:!0,children:e.jsxs(Z,{sx:{mb:3,borderRadius:3,border:"3px solid #1976d2",boxShadow:"0 8px 32px rgba(25, 118, 210, 0.2)",overflow:"hidden"},children:[e.jsxs(t,{sx:{p:3,background:"linear-gradient(135deg, #1976d2 0%, #0d47a1 100%)",color:"white"},children:[e.jsx(n,{variant:"h5",fontWeight:"bold",sx:{display:"flex",alignItems:"center",gap:1},children:"âœ¨ Crear Nueva Tarea"}),e.jsx(n,{variant:"body2",sx:{opacity:.9,mt:.5},children:"Completa todos los campos para crear una tarea detallada"})]}),e.jsx(t,{sx:{p:4,background:"linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%)"},children:e.jsxs(l,{container:!0,spacing:3,children:[e.jsx(l,{item:!0,xs:12,md:6,children:e.jsxs(P,{component:"fieldset",fullWidth:!0,children:[e.jsx(Q,{component:"legend",sx:{fontWeight:"bold",mb:1,color:"#1976d2"},children:"ðŸ‘¥ Tipo de AsignaciÃ³n"}),e.jsxs(O,{row:!0,value:R,onChange:r=>{_(r.target.value),r.target.value==="aleatoria"&&K("")},children:[e.jsx(j,{value:"aleatoria",control:e.jsx(f,{}),label:"Aleatoria"}),e.jsx(j,{value:"manual",control:e.jsx(f,{}),label:"Manual"})]})]})}),R==="manual"&&e.jsx(l,{item:!0,xs:12,children:e.jsxs(g,{select:!0,fullWidth:!0,label:"ðŸ§‘â€ðŸ’¼ Seleccionar Pasante",value:ue,onChange:r=>K(r.target.value),required:!0,sx:{"& .MuiOutlinedInput-root":{borderRadius:2}},children:[e.jsx(p,{value:"",children:"Seleccionar pasante"}),xe.map(r=>e.jsx(p,{value:r.id,children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(de,{sx:{width:24,height:24,bgcolor:je(r.name),fontSize:"0.875rem"},children:be(r.name)}),e.jsx(n,{children:r.name}),e.jsxs(n,{variant:"caption",sx:{color:"text.secondary"},children:["(",r.email,")"]})]})},r.id))]})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(g,{fullWidth:!0,label:"ðŸ“ TÃ­tulo de la tarea",value:x.titulo,onChange:r=>I({...x,titulo:r.target.value}),required:!0,sx:{"& .MuiOutlinedInput-root":{borderRadius:2,"&:hover":{borderColor:"#1976d2"}}}})}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(g,{type:"date",fullWidth:!0,label:"ðŸ“… Fecha",value:x.fecha,onChange:r=>I({...x,fecha:r.target.value}),InputLabelProps:{shrink:!0},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsxs(g,{select:!0,fullWidth:!0,label:"ðŸ·ï¸ Tipo",value:x.tipo_id,onChange:r=>I({...x,tipo_id:r.target.value}),sx:{"& .MuiOutlinedInput-root":{borderRadius:2}},children:[e.jsx(p,{value:"",children:"Sin tipo"}),W.map(r=>e.jsx(p,{value:r.id,children:r.nombre},r.id))]})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsxs(P,{component:"fieldset",fullWidth:!0,children:[e.jsx(Q,{component:"legend",sx:{fontWeight:"bold",mb:1,color:"#1976d2"},children:"âš¡ Prioridad"}),e.jsxs(O,{row:!0,value:x.prioridad,onChange:r=>I({...x,prioridad:r.target.value}),children:[e.jsx(j,{value:"alta",control:e.jsx(f,{sx:{color:"#FF1744","&.Mui-checked":{color:"#FF1744"}}}),label:"ðŸ”´ Alta"}),e.jsx(j,{value:"media",control:e.jsx(f,{sx:{color:"#FF9100","&.Mui-checked":{color:"#FF9100"}}}),label:"ðŸŸ¡ Media"}),e.jsx(j,{value:"baja",control:e.jsx(f,{sx:{color:"#00E676","&.Mui-checked":{color:"#00E676"}}}),label:"ðŸŸ¢ Baja"})]})]})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsxs(P,{component:"fieldset",fullWidth:!0,children:[e.jsx(Q,{component:"legend",sx:{fontWeight:"bold",mb:1,color:"#1976d2"},children:"ðŸ¢ Â¿Asignar empresa?"}),e.jsxs(O,{row:!0,value:ze,onChange:r=>{me(r.target.value),r.target.value==="no"&&I({...x,company_id:""})},children:[e.jsx(j,{value:"si",control:e.jsx(f,{}),label:"SÃ­"}),e.jsx(j,{value:"no",control:e.jsx(f,{}),label:"No"})]})]})}),ze==="si"&&e.jsx(l,{item:!0,xs:12,children:e.jsxs(g,{select:!0,fullWidth:!0,label:"ðŸ¢ Empresa",value:x.company_id,onChange:r=>I({...x,company_id:r.target.value}),sx:{"& .MuiOutlinedInput-root":{borderRadius:2}},children:[e.jsx(p,{value:"",children:"Seleccionar empresa"}),J.map(r=>e.jsx(p,{value:r.id,children:r.nombre},r.id))]})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(g,{fullWidth:!0,multiline:!0,rows:3,label:"ðŸ“„ DescripciÃ³n",value:x.descripcion,onChange:r=>I({...x,descripcion:r.target.value}),placeholder:"Describe la tarea en detalle...",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(l,{item:!0,xs:12,children:e.jsxs(t,{sx:{display:"flex",gap:2,justifyContent:"flex-end"},children:[e.jsx(v,{variant:"outlined",startIcon:e.jsx(Ie,{}),onClick:tr,sx:{borderRadius:2,minWidth:120},children:"Cancelar"}),e.jsx(v,{variant:"contained",startIcon:e.jsx(Fe,{}),onClick:sr,disabled:!x.titulo.trim()||R==="manual"&&!ue,sx:{borderRadius:2,minWidth:120,background:"linear-gradient(45deg, #4caf50 0%, #2e7d32 100%)","&:hover":{background:"linear-gradient(45deg, #388e3c 0%, #1b5e20 100%)"}},children:"Crear Tarea"})]})})]})})]})}),pe&&e.jsx(Y,{in:!0,children:e.jsxs(Z,{sx:{mb:3,borderRadius:3,border:"3px solid #FF9100",boxShadow:"0 8px 32px rgba(255, 145, 0, 0.2)",overflow:"hidden"},children:[e.jsxs(t,{sx:{p:3,background:"linear-gradient(135deg, #FF9100 0%, #FF6F00 100%)",color:"white"},children:[e.jsx(n,{variant:"h5",fontWeight:"bold",sx:{display:"flex",alignItems:"center",gap:1},children:"âœï¸ Editar Tarea"}),e.jsx(n,{variant:"body2",sx:{opacity:.9,mt:.5},children:"Modifica los campos que necesites actualizar"})]}),e.jsx(t,{sx:{p:4,background:"linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%)"},children:e.jsxs(l,{container:!0,spacing:3,children:[e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(g,{fullWidth:!0,label:"ðŸ“ TÃ­tulo de la tarea",value:c.titulo,onChange:r=>k({...c,titulo:r.target.value}),required:!0,sx:{"& .MuiOutlinedInput-root":{borderRadius:2,"&:hover":{borderColor:"#FF9100"}}}})}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(g,{type:"date",fullWidth:!0,label:"ðŸ“… Fecha",value:c.fecha,onChange:r=>k({...c,fecha:r.target.value}),InputLabelProps:{shrink:!0},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsxs(g,{select:!0,fullWidth:!0,label:"ðŸ·ï¸ Tipo",value:c.tipo_id,onChange:r=>k({...c,tipo_id:r.target.value}),sx:{"& .MuiOutlinedInput-root":{borderRadius:2}},children:[e.jsx(p,{value:"",children:"Sin tipo"}),W.map(r=>e.jsx(p,{value:r.id,children:r.nombre},r.id))]})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsxs(P,{component:"fieldset",fullWidth:!0,children:[e.jsx(Q,{component:"legend",sx:{fontWeight:"bold",mb:1,color:"#FF9100"},children:"âš¡ Prioridad"}),e.jsxs(O,{row:!0,value:c.prioridad,onChange:r=>k({...c,prioridad:r.target.value}),children:[e.jsx(j,{value:"alta",control:e.jsx(f,{sx:{color:"#FF1744","&.Mui-checked":{color:"#FF1744"}}}),label:"ðŸ”´ Alta"}),e.jsx(j,{value:"media",control:e.jsx(f,{sx:{color:"#FF9100","&.Mui-checked":{color:"#FF9100"}}}),label:"ðŸŸ¡ Media"}),e.jsx(j,{value:"baja",control:e.jsx(f,{sx:{color:"#00E676","&.Mui-checked":{color:"#00E676"}}}),label:"ðŸŸ¢ Baja"})]})]})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsxs(P,{component:"fieldset",fullWidth:!0,children:[e.jsx(Q,{component:"legend",sx:{fontWeight:"bold",mb:1,color:"#FF9100"},children:"ðŸ¢ Â¿Cambiar empresa?"}),e.jsxs(O,{row:!0,value:Ae,onChange:r=>{ge(r.target.value),r.target.value==="no"&&k({...c,company_id:""})},children:[e.jsx(j,{value:"si",control:e.jsx(f,{}),label:"SÃ­"}),e.jsx(j,{value:"no",control:e.jsx(f,{}),label:"No"})]})]})}),Ae==="si"&&e.jsx(l,{item:!0,xs:12,children:e.jsxs(g,{select:!0,fullWidth:!0,label:"ðŸ¢ Empresa",value:c.company_id,onChange:r=>k({...c,company_id:r.target.value}),sx:{"& .MuiOutlinedInput-root":{borderRadius:2}},children:[e.jsx(p,{value:"",children:"Sin empresa"}),J.map(r=>e.jsx(p,{value:r.id,children:r.nombre},r.id))]})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(g,{fullWidth:!0,multiline:!0,rows:3,label:"ðŸ“„ DescripciÃ³n",value:c.descripcion,onChange:r=>k({...c,descripcion:r.target.value}),placeholder:"Describe la tarea en detalle...",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(l,{item:!0,xs:12,children:e.jsxs(t,{sx:{display:"flex",gap:2,justifyContent:"flex-end"},children:[e.jsx(v,{variant:"outlined",startIcon:e.jsx(Ie,{}),onClick:ar,sx:{borderRadius:2,minWidth:120},children:"Cancelar"}),e.jsx(v,{variant:"contained",startIcon:e.jsx(Fe,{}),onClick:dr,disabled:!c.titulo.trim(),sx:{borderRadius:2,minWidth:120,background:"linear-gradient(45deg, #FF9100 0%, #FF6F00 100%)","&:hover":{background:"linear-gradient(45deg, #FF8F00 0%, #E65100 100%)"}},children:"Actualizar"})]})})]})})]})}),d==="semana"&&e.jsx(V,{in:!0,children:e.jsxs(U,{sx:{borderRadius:3,overflow:"hidden",boxShadow:"0 8px 32px rgba(0,0,0,0.12)"},children:[e.jsxs(t,{sx:{background:"linear-gradient(90deg, #1976d2 0%, #2196f3 100%)",color:"white",p:2,textAlign:"center"},children:[e.jsx(n,{variant:"h5",fontWeight:"bold",children:"ðŸ“… Calendario Semanal"}),e.jsxs(n,{variant:"body2",sx:{opacity:.9},children:[fe[0]," - ",fe[6]]})]}),e.jsx(t,{sx:{display:"flex",minHeight:600},children:fe.map((r,a)=>{const s=$(r),i=s.toLocaleDateString("es-ES",{weekday:"long"}),S=s.getDate(),u=s.toLocaleDateString("es-ES",{month:"short"}),m=Ke[r]||[],b=r===new Date().toISOString().split("T")[0];return e.jsxs(t,{sx:{flex:1,borderRight:a<6?"1px solid rgba(0,0,0,0.1)":"none",cursor:"pointer",transition:"all 0.3s ease","&:hover":{bgcolor:w("#1976d2",.05)},display:"flex",flexDirection:"column"},onClick:()=>Le(r),children:[e.jsxs(t,{sx:{background:ir(a,b),color:"white",p:b?3:2,textAlign:"center",position:"relative",minHeight:b?140:100},children:[e.jsx(n,{variant:b?"h6":"body2",fontWeight:"bold",sx:{textTransform:"capitalize"},children:i}),e.jsx(n,{variant:b?"h2":"h4",fontWeight:"bold",sx:{my:b?1:0},children:S}),e.jsx(n,{variant:b?"body1":"caption",sx:{opacity:.9},children:u}),b&&e.jsxs(t,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:1,mt:1},children:[e.jsx(Ue,{sx:{fontSize:20}}),e.jsx(n,{variant:"body1",sx:{fontWeight:"bold"},children:"HOY"}),e.jsx(Ue,{sx:{fontSize:20}})]})]}),e.jsx(t,{sx:{p:1,flex:1,display:"flex",flexDirection:"column",gap:1},children:m.length===0?e.jsxs(t,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1,color:"text.secondary"},children:[e.jsx(n,{variant:"body2",sx:{mb:1},children:"Sin tareas"}),e.jsx(v,{size:"small",variant:"outlined",startIcon:e.jsx(q,{}),onClick:y=>{y.stopPropagation(),B(r)},sx:{borderRadius:2},children:"Agregar"})]}):e.jsxs(e.Fragment,{children:[m.map((y,Ce)=>e.jsx(Y,{in:!0,style:{transitionDelay:`${Ce*100}ms`},children:e.jsx(Z,{sx:{p:1,borderRadius:2,borderLeft:`4px solid ${M(y.prioridad)}`,bgcolor:M(y.prioridad),color:"white",cursor:"pointer",transition:"all 0.2s ease","&:hover":{transform:"translateX(4px)",boxShadow:"0 4px 12px rgba(0,0,0,0.25)",filter:"brightness(1.1)"},minHeight:50,display:"flex",alignItems:"center"},onClick:cr=>{cr.stopPropagation(),Le(r)},children:e.jsxs(t,{sx:{flex:1},children:[e.jsx(n,{variant:"body2",fontWeight:"bold",sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"0.85rem"},children:y.titulo}),y.tipo&&e.jsx(n,{variant:"caption",sx:{opacity:.9,fontSize:"0.7rem",display:"block"},children:y.tipo.nombre_tipo})]})})},y.id)),e.jsx(v,{size:"small",variant:"text",startIcon:e.jsx(q,{}),onClick:y=>{y.stopPropagation(),B(r)},sx:{borderRadius:2,color:"#1976d2","&:hover":{bgcolor:w("#1976d2",.1)},mt:"auto"},children:"Agregar"})]})})]},r)})})]})}),(d==="mes"||d==="todas")&&e.jsx(V,{in:!0,children:e.jsx(t,{children:A.length===0?e.jsxs(U,{sx:{p:6,textAlign:"center",borderRadius:3,background:"linear-gradient(145deg, #f8f9fa 0%, #e9ecef 100%)"},children:[e.jsx(n,{variant:"h5",color:"text.secondary",sx:{mb:2},children:"ðŸ“ No hay tareas que mostrar"}),e.jsx(n,{color:"text.secondary",sx:{mb:3},children:d==="mes"?"No se encontraron tareas para este mes":"No se encontraron tareas"})]}):e.jsxs(U,{sx:{borderRadius:3,overflow:"hidden"},children:[e.jsxs(t,{sx:{background:"linear-gradient(90deg, #1976d2 0%, #2196f3 100%)",color:"white",p:2,textAlign:"center"},children:[e.jsxs(n,{variant:"h5",fontWeight:"bold",children:["ðŸ“‹ ",d==="mes"?"Tareas del Mes":"Todas las Tareas"]}),e.jsxs(n,{variant:"body2",sx:{opacity:.9},children:[A.length," tareas encontradas"]})]}),e.jsx(Sr,{disablePadding:!0,children:A.map((r,a)=>e.jsx(Y,{in:!0,style:{transitionDelay:`${a*50}ms`},children:e.jsxs(t,{children:[e.jsxs(kr,{sx:{py:2,px:3,borderLeft:`6px solid ${M(r.prioridad)}`,"&:hover":{bgcolor:w(M(r.prioridad),.05)}},children:[e.jsx(Hr,{children:e.jsx(de,{sx:{bgcolor:M(r.prioridad),color:"white"},children:r.prioridad==="alta"?e.jsx(Br,{}):r.prioridad==="media"?e.jsx(Rr,{}):e.jsx(Vr,{})})}),e.jsx(zr,{primary:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap",mb:1},children:[e.jsx(n,{variant:"h6",fontWeight:"bold",children:r.titulo}),e.jsx(C,{label:r.prioridad.toUpperCase(),size:"small",sx:{bgcolor:M(r.prioridad),color:"white",fontWeight:"bold"}})]}),secondary:e.jsxs(t,{children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap",mb:1},children:[e.jsx(C,{icon:e.jsx(Ve,{fontSize:"small"}),label:r.fecha,size:"small",variant:"outlined",color:"primary"}),r.company&&e.jsx(C,{icon:e.jsx(we,{fontSize:"small"}),label:r.company.name,size:"small",variant:"outlined",color:"primary"}),r.tipo&&e.jsx(C,{icon:e.jsx($e,{fontSize:"small"}),label:r.tipo.nombre_tipo,size:"small",variant:"outlined",color:"primary"})]}),r.descripcion&&e.jsx(n,{variant:"body2",color:"text.secondary",sx:{mb:1},children:r.descripcion}),r.asignados.length>0&&e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsx(n,{variant:"body2",color:"text.secondary",children:"Asignado a:"}),r.asignados.map(s=>e.jsx(C,{avatar:e.jsx(de,{sx:{bgcolor:je(s.user_name)},children:be(s.user_name)}),label:s.user_name,size:"small",variant:"outlined"},s.user_id))]})]})}),e.jsx(Ir,{children:e.jsxs(t,{sx:{display:"flex",gap:1},children:[e.jsx(G,{title:"Editar tarea",children:e.jsx(F,{onClick:()=>Pe(r),color:"primary",sx:{bgcolor:w("#1976d2",.1),"&:hover":{bgcolor:w("#1976d2",.2)}},children:e.jsx(Ee,{})})}),e.jsx(G,{title:"Eliminar tarea",children:e.jsx(F,{onClick:()=>Oe(r.id),color:"error",sx:{bgcolor:w("#f44336",.1),"&:hover":{bgcolor:w("#f44336",.2)}},children:e.jsx(Ge,{})})})]})})]}),a<A.length-1&&e.jsx(Ar,{variant:"inset",component:"li"})]})},r.id))})]})})}),d==="dia"&&e.jsx(V,{in:!0,children:e.jsx(t,{children:Object.keys(oe).length===0?e.jsxs(U,{sx:{p:6,textAlign:"center",borderRadius:3,background:"linear-gradient(145deg, #f8f9fa 0%, #e9ecef 100%)"},children:[e.jsx(n,{variant:"h5",color:"text.secondary",sx:{mb:2},children:"ðŸ“ No hay tareas para este dÃ­a"}),e.jsxs(n,{color:"text.secondary",sx:{mb:3},children:["No se encontraron tareas programadas para el ",z]}),e.jsx(v,{variant:"contained",startIcon:e.jsx(q,{}),onClick:()=>B(z||void 0),sx:{borderRadius:2,background:"linear-gradient(45deg, #1976d2 0%, #0d47a1 100%)"},children:"Crear primera tarea"})]}):Object.entries(oe).map(([r,a],s)=>e.jsx(V,{in:!0,timeout:300+s*100,children:e.jsxs(Z,{sx:{mb:3,borderRadius:3,overflow:"hidden",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:3,background:"linear-gradient(135deg, #1976d2 0%, #2196f3 100%)",color:"white",cursor:"pointer","&:hover":{background:"linear-gradient(135deg, #1565c0 0%, #1976d2 100%)"},transition:"background 0.3s ease"},onClick:()=>er(r),children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(de,{sx:{bgcolor:"white",color:je(r),fontWeight:"bold",width:48,height:48},children:be(r)}),e.jsxs(t,{children:[e.jsx(n,{variant:"h5",fontWeight:"bold",children:r}),e.jsxs(n,{variant:"body1",sx:{opacity:.9},children:[a.length," ",a.length===1?"tarea asignada":"tareas asignadas"]})]})]}),e.jsx(F,{sx:{color:"white"},children:De[r]?e.jsx(hr,{}):e.jsx(pr,{})})]}),e.jsx(_r,{in:De[r]??!0,children:e.jsx(t,{sx:{p:2},children:a.map((i,S)=>e.jsx(Y,{in:!0,style:{transitionDelay:`${S*100}ms`},children:e.jsx(Z,{sx:{mb:2,borderRadius:2,border:"1px solid rgba(0,0,0,0.1)",transition:"all 0.3s ease","&:hover":{boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},borderLeft:`6px solid ${M(i.prioridad)}`},children:e.jsxs(t,{sx:{p:3},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",mb:2},children:[e.jsxs(t,{sx:{flexGrow:1},children:[e.jsx(n,{variant:"h6",fontWeight:"bold",sx:{mb:1},children:i.titulo}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsx(C,{label:i.prioridad.toUpperCase(),sx:{bgcolor:M(i.prioridad),color:"white",fontWeight:"bold"}}),e.jsx(C,{icon:e.jsx(Ve,{fontSize:"small"}),label:i.fecha,variant:"outlined",color:"primary"}),i.tipo&&e.jsx(C,{icon:e.jsx($e,{fontSize:"small"}),label:i.tipo.nombre_tipo,variant:"outlined",color:"primary"}),i.company&&e.jsx(C,{icon:e.jsx(we,{fontSize:"small"}),label:i.company.name,variant:"outlined",color:"primary"})]})]}),e.jsxs(t,{sx:{display:"flex",gap:1,ml:2},children:[e.jsx(G,{title:"Editar tarea",children:e.jsx(F,{onClick:()=>Pe(i),color:"primary",sx:{bgcolor:w("#1976d2",.1),"&:hover":{bgcolor:w("#1976d2",.2)}},children:e.jsx(Ee,{})})}),e.jsx(G,{title:"Eliminar tarea",children:e.jsx(F,{onClick:()=>Oe(i.id),color:"error",sx:{bgcolor:w("#f44336",.1),"&:hover":{bgcolor:w("#f44336",.2)}},children:e.jsx(Ge,{})})})]})]}),e.jsxs(t,{sx:{p:2,bgcolor:w("#1976d2",.05),borderRadius:2,borderLeft:"4px solid #1976d2",display:"flex",flexDirection:"column",gap:1},children:[i.descripcion&&e.jsxs(n,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"DescripciÃ³n:"})," ",i.descripcion]}),i.asignados.map(u=>e.jsxs(t,{sx:{ml:1,mb:1},children:[ve===u.id?e.jsxs(ke,{direction:"row",spacing:2,alignItems:"center",children:[e.jsxs(P,{component:"fieldset",size:"small",children:[e.jsxs(O,{row:!0,value:ne.estado,onChange:m=>le(b=>({...b,estado:m.target.value})),children:[e.jsx(j,{value:"pendiente",control:e.jsx(f,{}),label:"Pendiente"}),e.jsx(j,{value:"en_revision",control:e.jsx(f,{}),label:"En revisiÃ³n"}),e.jsx(j,{value:"publicada",control:e.jsx(f,{}),label:"Publicada"})]}),e.jsx(g,{fullWidth:!0,size:"small",label:"Detalle",value:ne.detalle,onChange:m=>le(b=>({...b,detalle:m.target.value})),sx:{mt:2}})]}),e.jsx(F,{size:"small",onClick:lr,children:e.jsx(Fe,{fontSize:"small"})}),e.jsx(F,{size:"small",onClick:nr,children:e.jsx(Ie,{fontSize:"small"})})]}):e.jsxs(ke,{direction:"row",spacing:1,alignItems:"center",children:[e.jsxs(n,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Estado:"})," ",u.estado]}),e.jsx(F,{size:"small",onClick:()=>or(u),children:e.jsx(Ee,{fontSize:"small"})})]}),u.detalle&&e.jsxs(n,{variant:"body2",color:"text.secondary",sx:{ml:4,mt:.5},children:[e.jsx("strong",{children:"Detalle:"})," ",u.detalle]})]},u.id))]})]})})},i.id))})})]})},r))})}),d==="dia"&&!Re&&!pe&&e.jsx(Lr,{color:"primary","aria-label":"Nueva tarea rÃ¡pida",onClick:()=>B(z||void 0),sx:{position:"fixed",bottom:24,right:24,background:"linear-gradient(45deg, #4caf50 0%, #2e7d32 100%)","&:hover":{background:"linear-gradient(45deg, #388e3c 0%, #1b5e20 100%)",transform:"scale(1.1)"},transition:"all 0.3s ease",zIndex:1e3},children:e.jsx(q,{})})]})]})}export{ht as default};
