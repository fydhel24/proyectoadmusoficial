import{j as e,r as d,$ as K,m as y}from"./app-DWYhLQL6.js";import{A as V,B as Y,d as J,P as N}from"./app-layout-p7K4X7eV.js";import{u as Q,P as U}from"./Paper-EniTK7He.js";import{C as X}from"./Container-C7xxEfFj.js";import{B as S}from"./Box-BbMU-_RR.js";import{T as p}from"./Typography-IkT196je.js";import{S as m}from"./Stack-nT1jkqe3.js";import{B as b}from"./Button-BrLf_Pls.js";import{P as Z}from"./PictureAsPdf-DoMbi8fJ.js";import{T as f}from"./TextField-MHNYv_sC.js";import{I as ee}from"./InputAdornment-elME3r4g.js";import{S as re}from"./Search-DU2LiQPG.js";import{C as T}from"./Card-8ZfkaAJ7.js";import{T as oe}from"./TableContainer-DwTJ9q9t.js";import{T as te,a as ae,b as A,c as ie}from"./TableRow-DBOU2XrP.js";import{T as c}from"./TableCell-C5DOKis2.js";import{c as ne}from"./createSvgIcon-C-V1FIKo.js";import{C as w}from"./Chip-Dd1dfm5j.js";import{A as se}from"./Add-C3coAMIP.js";import{F as le}from"./Fade-BWgYys4A.js";import{A as P}from"./Avatar-DoV_5ciI.js";import{T as de}from"./Tooltip-D9IkZOyx.js";import{D as me,a as pe,b as ce}from"./DialogTitle-BRc-au27.js";import{I as xe}from"./IconButton-BGvBFu85.js";import{C as ue}from"./Close-CWq84GBm.js";import{D as he}from"./DialogActions-2fZYmJbN.js";import{C as ge}from"./Cancel-DqEYgzrO.js";import{C as be}from"./CheckCircle-BPToE68B.js";import{b as t}from"./DefaultPropsProvider-CHy6HlRv.js";import"./button-wMTuvAkw.js";import"./clsx-B-dksMZM.js";import"./avatar-C0bnmZQz.js";import"./createLucideIcon-DISkT-zV.js";import"./index-vDywYphy.js";import"./index-CvZMSx04.js";import"./index-C-qtZoBa.js";import"./settings-B1FLQ7wV.js";import"./app-logo-icon-HoYzQaBs.js";import"./useThemeProps-Bas4AH8z.js";import"./getThemeProps-DLKBaTjH.js";import"./createSimplePaletteValueFilter-WGi9SSDd.js";import"./useId-o3zk_1yM.js";import"./ButtonBase-DpqQEAAf.js";import"./useTimeout-CcjJ2cmE.js";import"./TransitionGroupContext-D4TXwhqE.js";import"./CircularProgress-Bo20HsGQ.js";import"./useSlot-CO4IlLCl.js";import"./Select-DJEe7ust.js";import"./useFormControl-CsRgqpY5.js";import"./isMuiElement-D94hBNTL.js";import"./index-DtBJPI5W.js";import"./useSlotProps-CBCDIG0V.js";import"./List-DOdfdsGa.js";import"./ownerDocument-DW-IO8s5.js";import"./Modal-N30Js5sT.js";import"./createChainedFunction-BO_9K8Jh.js";import"./Portal-Dt5KHSRP.js";import"./debounce-Be36O1Ab.js";import"./Grow-IF_zPiYA.js";import"./useControlled-5UsadrEY.js";import"./Popper-BNtv9MeI.js";const E=ne(e.jsx("path",{d:"M21.99 4c0-1.1-.89-2-1.99-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14l4 4zM18 14H6v-2h12zm0-3H6V9h12zm0-3H6V6h12z"})),Tr=({planes:R})=>{const r=Q(),[I,k]=d.useState(R),[M,$]=d.useState(!1),[C,W]=d.useState(null),[x,j]=d.useState(""),[z,_]=d.useState(""),[D,h]=d.useState(null),[v,F]=d.useState(""),H=(o,n,a)=>{const l=I.map(i=>i.id===o?{...i,[n]:a}:i);k(l)},O=o=>{y.post("/planes-empresas/save",o,{preserveScroll:!0})},L=o=>{W(o),j(""),$(!0)},g=()=>{$(!1),W(null),j("")},q=()=>{!x.trim()||!C||y.post("/comentarios-planes",{contenido:x,plan_empresa_id:C},{onSuccess:()=>{k(o=>o.map(n=>n.id===C?{...n,comentarios:[...n.comentarios||[],{id:Date.now(),contenido:x,user:{name:"Tú"}}]}:n)),g()}})},B=(o,n,a)=>{if(!n.trim()||!a){h(null);return}y.post("/comentarios-planes/update",{id:o,contenido:n},{preserveScroll:!0,onSuccess:()=>{k(l=>l.map(i=>{var u;return i.id===a?{...i,comentarios:(u=i.comentarios)==null?void 0:u.map(s=>s.id===o?{...s,contenido:n}:s)}:i})),h(null)}})},G=I.filter(o=>o.empresa.name.toLowerCase().includes(z.toLowerCase()));return e.jsxs(V,{children:[e.jsx(K,{title:"Planes de Empresas"}),e.jsxs(X,{maxWidth:"xl",sx:{py:4},children:[e.jsxs(S,{sx:{mb:4},children:[e.jsx(p,{variant:"h3",component:"h1",sx:{fontWeight:700,background:`linear-gradient(45deg, ${r.palette.primary.main}, ${r.palette.secondary.main})`,backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",mb:2},children:"Planes de Empresas"}),e.jsxs(m,{direction:"row",spacing:2,alignItems:"center",sx:{mb:3},children:[e.jsx(b,{variant:"contained",startIcon:e.jsx(Z,{}),onClick:()=>window.open("/planes-empresas/pdf","_blank"),sx:{background:"linear-gradient(45deg, #4CAF50, #66BB6A)","&:hover":{background:"linear-gradient(45deg, #388E3C, #4CAF50)"},boxShadow:"0 4px 20px rgba(76, 175, 80, 0.3)",borderRadius:3,textTransform:"none",fontWeight:600,px:3},children:"Generar PDF"}),e.jsx(f,{variant:"outlined",placeholder:"Buscar por empresa...",value:z,onChange:o=>_(o.target.value),InputProps:{startAdornment:e.jsx(ee,{position:"start",children:e.jsx(re,{color:"action"})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:3,backgroundColor:t(r.palette.background.paper,.8),"&:hover":{backgroundColor:r.palette.background.paper},"&.Mui-focused":{backgroundColor:r.palette.background.paper,boxShadow:`0 0 0 2px ${t(r.palette.primary.main,.2)}`}},minWidth:300}})]})]}),e.jsx(T,{elevation:0,sx:{borderRadius:4,border:`1px solid ${t(r.palette.divider,.1)}`,boxShadow:"0 8px 32px rgba(0,0,0,0.08)",overflow:"hidden"},children:e.jsx(oe,{children:e.jsxs(te,{stickyHeader:!0,children:[e.jsx(ae,{children:e.jsxs(A,{children:[e.jsx(c,{sx:{backgroundColor:t(r.palette.primary.main,.05),fontWeight:700,fontSize:"0.9rem",color:r.palette.primary.main,borderBottom:`2px solid ${t(r.palette.primary.main,.1)}`},children:e.jsxs(m,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(Y,{fontSize:"small"}),e.jsx("span",{children:"Empresa"})]})}),[{key:"TikTok (Mes)",color:"#000000"},{key:"TikTok (Semana)",color:"#000000"},{key:"Facebook (Mes)",color:"#1877F2"},{key:"Facebook (Semana)",color:"#1877F2"},{key:"Instagram (Mes)",color:"#E4405F"},{key:"Instagram (Semana)",color:"#E4405F"},{key:"Mensajes",color:r.palette.info.main}].map(o=>e.jsx(c,{sx:{backgroundColor:t(o.color,.05),fontWeight:700,fontSize:"0.85rem",color:o.color,borderBottom:`2px solid ${t(o.color,.1)}`,minWidth:120},children:o.key},o.key)),e.jsx(c,{sx:{backgroundColor:t(r.palette.secondary.main,.05),fontWeight:700,fontSize:"0.9rem",color:r.palette.secondary.main,borderBottom:`2px solid ${t(r.palette.secondary.main,.1)}`,minWidth:200},children:e.jsxs(m,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(E,{fontSize:"small"}),e.jsx("span",{children:"Comentarios"})]})})]})}),e.jsx(ie,{children:G.map((o,n)=>e.jsxs(A,{sx:{"&:hover":{backgroundColor:t(r.palette.action.hover,.04),transition:"background-color 0.2s ease"},"&:nth-of-type(even)":{backgroundColor:t(r.palette.action.hover,.02)}},children:[e.jsx(c,{sx:{py:2,minWidth:250},children:e.jsxs(T,{variant:"outlined",sx:{p:2,borderRadius:2,border:`1px solid ${t(r.palette.divider,.1)}`,backgroundColor:t(r.palette.background.paper,.5)},children:[e.jsx(p,{variant:"subtitle2",component:"a",href:`/empresas/${o.empresa_id}/seguimiento-videos`,sx:{color:r.palette.primary.main,textDecoration:"none",fontWeight:600,fontSize:"0.9rem","&:hover":{textDecoration:"underline",color:r.palette.primary.dark},display:"block",mb:1},children:o.empresa.name}),e.jsxs(m,{spacing:.5,children:[e.jsx(w,{icon:e.jsx(J,{}),label:o.empresa.category_name,size:"small",variant:"outlined",sx:{fontSize:"0.7rem",height:22,borderColor:t(r.palette.info.main,.3),color:r.palette.info.main}}),e.jsx(w,{label:`Plan: ${o.empresa.paquete_nombre}`,size:"small",variant:"filled",sx:{fontSize:"0.7rem",height:22,backgroundColor:t(r.palette.success.main,.1),color:r.palette.success.main}}),o.empresa.influencer&&e.jsx(w,{icon:e.jsx(N,{}),label:o.empresa.influencer,size:"small",variant:"outlined",sx:{fontSize:"0.7rem",height:22,fontStyle:"italic",borderColor:t(r.palette.warning.main,.3),color:r.palette.warning.main}})]})]})}),[{field:"tiktok_mes",color:"#000000"},{field:"tiktok_semana",color:"#000000"},{field:"facebook_mes",color:"#1877F2"},{field:"facebook_semana",color:"#1877F2"},{field:"instagram_mes",color:"#E4405F"},{field:"instagram_semana",color:"#E4405F"},{field:"mensajes",color:r.palette.info.main}].map(({field:a,color:l})=>e.jsx(c,{sx:{py:2},children:e.jsx(f,{variant:"outlined",size:"small",fullWidth:!0,value:o[a]||"",onChange:i=>H(o.id,a,i.target.value),onBlur:()=>O(o),sx:{"& .MuiOutlinedInput-root":{borderRadius:2,fontSize:"0.85rem","&:hover fieldset":{borderColor:t(l,.5)},"&.Mui-focused fieldset":{borderColor:l,boxShadow:`0 0 0 2px ${t(l,.1)}`}}}})},a)),e.jsx(c,{sx:{py:2,minWidth:250},children:e.jsxs(S,{children:[e.jsx(b,{variant:"contained",startIcon:e.jsx(se,{}),onClick:()=>L(o.id),size:"small",sx:{mb:2,borderRadius:2,textTransform:"none",fontWeight:600,background:`linear-gradient(45deg, ${r.palette.primary.main}, ${r.palette.primary.dark})`,"&:hover":{background:`linear-gradient(45deg, ${r.palette.primary.dark}, ${r.palette.primary.main})`},boxShadow:`0 3px 15px ${t(r.palette.primary.main,.3)}`},children:"Agregar"}),e.jsx(U,{variant:"outlined",sx:{maxHeight:200,overflow:"auto",borderRadius:2,backgroundColor:t(r.palette.background.default,.5),border:`1px solid ${t(r.palette.divider,.1)}`},children:e.jsx(S,{sx:{p:2},children:o.comentarios&&o.comentarios.length>0?e.jsx(m,{spacing:2,children:o.comentarios.map((a,l)=>{var i,u;return e.jsx(le,{in:!0,children:e.jsxs(T,{variant:"outlined",sx:{p:1.5,borderRadius:2,border:`1px solid ${t(r.palette.divider,.1)}`,backgroundColor:r.palette.background.paper,"&:hover":{boxShadow:`0 2px 8px ${t(r.palette.action.hover,.15)}`}},children:[e.jsxs(m,{direction:"row",alignItems:"center",spacing:1,sx:{mb:1},children:[e.jsx(P,{sx:{width:24,height:24,fontSize:"0.7rem",backgroundColor:r.palette.primary.main},children:(((i=a.user)==null?void 0:i.name)||"A").charAt(0)}),e.jsx(p,{variant:"caption",sx:{fontWeight:600,color:r.palette.text.primary},children:((u=a.user)==null?void 0:u.name)||"Anónimo"})]}),D===a.id?e.jsx(f,{variant:"outlined",size:"small",fullWidth:!0,multiline:!0,autoFocus:!0,value:v,onChange:s=>F(s.target.value),onBlur:()=>B(a.id,v,o.id),onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey?(s.preventDefault(),B(a.id,v,o.id)):s.key==="Escape"&&h(null)},sx:{"& .MuiOutlinedInput-root":{fontSize:"0.8rem",borderRadius:1.5}}}):e.jsx(de,{title:"Click para editar",children:e.jsx(p,{variant:"body2",onClick:()=>{h(a.id),F(a.contenido)},sx:{cursor:"pointer",fontSize:"0.8rem",lineHeight:1.4,"&:hover":{backgroundColor:t(r.palette.action.hover,.08),borderRadius:1,px:1,py:.5,ml:-1,mr:-1}},children:a.contenido})})]})},a.id)})}):e.jsx(p,{variant:"caption",sx:{color:r.palette.text.disabled,fontStyle:"italic",textAlign:"center",display:"block"},children:"Sin comentarios"})})})]})})]},o.empresa_id))})]})})}),e.jsxs(me,{open:M,onClose:g,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:4,boxShadow:"0 20px 60px rgba(0,0,0,0.15)",overflow:"hidden"}},children:[e.jsxs(pe,{sx:{background:`linear-gradient(135deg, ${r.palette.primary.main}, ${r.palette.secondary.main})`,color:"white",py:3,position:"relative"},children:[e.jsxs(m,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(P,{sx:{backgroundColor:"rgba(255,255,255,0.2)"},children:e.jsx(E,{})}),e.jsx(p,{variant:"h6",sx:{fontWeight:600},children:"Agregar Comentario"})]}),e.jsx(xe,{onClick:g,sx:{position:"absolute",right:16,top:"50%",transform:"translateY(-50%)",color:"rgba(255,255,255,0.8)","&:hover":{backgroundColor:"rgba(255,255,255,0.1)",color:"white"}},children:e.jsx(ue,{})})]}),e.jsx(ce,{sx:{p:3,mt:2},children:e.jsx(f,{variant:"outlined",fullWidth:!0,multiline:!0,rows:6,value:x,onChange:o=>j(o.target.value),placeholder:"Escribe tu comentario aquí...",sx:{"& .MuiOutlinedInput-root":{borderRadius:3,"&:hover fieldset":{borderColor:r.palette.primary.main},"&.Mui-focused fieldset":{borderColor:r.palette.primary.main,borderWidth:2}},"& .MuiInputBase-input":{fontSize:"0.95rem",lineHeight:1.5}}})}),e.jsxs(he,{sx:{p:3,pt:0},children:[e.jsx(b,{onClick:g,variant:"outlined",startIcon:e.jsx(ge,{}),sx:{borderRadius:3,textTransform:"none",fontWeight:600,px:3},children:"Cancelar"}),e.jsx(b,{onClick:q,variant:"contained",startIcon:e.jsx(be,{}),disabled:!x.trim(),sx:{borderRadius:3,textTransform:"none",fontWeight:600,px:3,background:`linear-gradient(45deg, ${r.palette.primary.main}, ${r.palette.primary.dark})`,"&:hover":{background:`linear-gradient(45deg, ${r.palette.primary.dark}, ${r.palette.primary.main})`},boxShadow:`0 4px 20px ${t(r.palette.primary.main,.3)}`,"&:disabled":{background:t(r.palette.action.disabled,.12),color:r.palette.action.disabled}},children:"Guardar"})]})]})]})]})};export{Tr as default};
