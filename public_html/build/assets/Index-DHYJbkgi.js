import{j as e,r as t,$ as Y,a as b}from"./app-BS78KgI9.js";import{A as Z,P as U}from"./app-layout-DXAC2WAv.js";import{B as s}from"./Box-DUIKlT8z.js";import{T as i}from"./Typography-CcX01ihT.js";import{c as E}from"./createSvgIcon-12aY9Ngm.js";import{D as L}from"./Divider-B8ontJjP.js";import{S as x}from"./Stack-D-Gkkt_v.js";import{G as j}from"./Grow-CxMvSjLL.js";import{C as ee}from"./Chip-co4ExwZU.js";import{B as l}from"./Button-DqXQBeNq.js";import{A as oe}from"./Add--ainIzPA.js";import{M as B}from"./Modal-BH4F5tNL.js";import{T as y}from"./TextField-CvGdJWCa.js";import{I as re}from"./InputAdornment-BT-QByY7.js";import{S as te}from"./Search-0IMiUOv4.js";import{G as O}from"./Grid-rYS9TwvK.js";import{C as ie}from"./Card-Cu_cYAkA.js";import{C as se}from"./CardContent-CAp0mljq.js";import{A as P}from"./Avatar-Bg0t12nq.js";import{C as ae}from"./CardActions-Ry5i2n2V.js";import{I as ne}from"./IconButton-CZ7CUvid.js";import{C as le}from"./Close-BY2rlbAm.js";import{C as G}from"./CircularProgress-DHT395bS.js";import{A as pe}from"./Autocomplete-CHiLwGpf.js";import{T as ce}from"./Tooltip-IWvH1ko8.js";import{S as de}from"./Snackbar-DysO8TuN.js";import{A as me}from"./Alert-B4Vyu2Ut.js";import"./button-oAFDZpeO.js";import"./clsx-B-dksMZM.js";import"./avatar-BWsYigjR.js";import"./createLucideIcon-D-6WHVmO.js";import"./index-Qic-rRyU.js";import"./index--gTV4hvx.js";import"./index-DBd0QHkk.js";import"./settings-DV0Bctrx.js";import"./app-logo-icon-GUvtkzgu.js";import"./DefaultPropsProvider-Dk6HDr1M.js";import"./dividerClasses-893dsvZ6.js";import"./useThemeProps-hgA8uWgq.js";import"./getThemeProps--CMPU-9n.js";import"./Fade-FGt6R6vx.js";import"./useTimeout-oSTK7AfQ.js";import"./useSlot-DerHgNuN.js";import"./ButtonBase-DLk8W6EL.js";import"./useId-DZf0Wwsg.js";import"./Portal-CCwm8dqL.js";import"./Select-9OsFqQh0.js";import"./isMuiElement-w8fP3KeW.js";import"./index-BZb61BhM.js";import"./useSlotProps-Cf7xKLKx.js";import"./List-ctjg6MFH.js";import"./debounce-Be36O1Ab.js";import"./useControlled-wSjlUgLl.js";import"./Close-CzLUv769.js";import"./usePreviousProps-D-3arf61.js";import"./Popper-DnDfq_y6.js";import"./ClickAwayListener-VJqoF_b6.js";const C=E(e.jsx("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m0 4c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3m6 12H6v-1.4c0-2 4-3.1 6-3.1s6 1.1 6 3.1z"})),v=E(e.jsx("path",{d:"M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12z"}));function go({users:N,tipos:_}){const[h,$]=t.useState(""),[D,S]=t.useState(!1),[F,T]=t.useState(!1),[p,w]=t.useState(""),[c,H]=t.useState(_),[a,A]=t.useState(null),[d,m]=t.useState([]),[Q,W]=t.useState(!1),[I,k]=t.useState(!1),[u,n]=t.useState({open:!1,message:"",severity:"success"}),V=N.filter(o=>o.name.toLowerCase().includes(h.toLowerCase())||o.email.toLowerCase().includes(h.toLowerCase())),q=()=>S(!0),z=()=>{S(!1),w("")},J=async()=>{if(p.trim())try{const o=await b.post("/tipos",{nombre_tipo:p});H(r=>[...r,o.data.tipo]),n({open:!0,message:"Tipo creado con éxito",severity:"success"}),z()}catch{n({open:!0,message:"Error al crear tipo",severity:"error"})}},K=async o=>{A(o),W(!0);try{const r=await b.get(`/tipos/${o.id}/tipos`);m(r.data.map(g=>g.id))}catch{m([])}W(!1),T(!0)},f=()=>{T(!1),A(null),m([])},M=o=>{m(r=>r.includes(o)?r.filter(g=>g!==o):[...r,o])},X=async()=>{if(a){k(!0);try{await b.put(`/tipos/${a.id}/tipos`,{tipos:d}),n({open:!0,message:"Tipos actualizados",severity:"success"}),f()}catch{n({open:!0,message:"Error al actualizar tipos",severity:"error"})}k(!1)}},R=["primary","secondary","success","error","warning","info"];return e.jsxs(Z,{breadcrumbs:[{title:"Tipos",href:"/tipos"}],children:[e.jsx(Y,{title:"Tipos"}),e.jsxs(s,{sx:{mb:4},children:[e.jsxs(i,{variant:"h4",fontWeight:700,gutterBottom:!0,color:"primary.main",sx:{letterSpacing:1},children:[e.jsx(C,{sx:{mr:1,verticalAlign:"middle",fontSize:36}}),"Gestión de Personal"]}),e.jsx(L,{sx:{mb:2}}),e.jsx(x,{direction:"row",spacing:2,alignItems:"center",flexWrap:"wrap",sx:{mb:2,gap:2},children:c.map((o,r)=>e.jsx(j,{in:!0,timeout:400+r*80,children:e.jsx(ee,{icon:e.jsx(v,{}),label:o.nombre_tipo,color:R[r%R.length],sx:{fontWeight:500,fontSize:15,borderRadius:2,boxShadow:2,px:2,py:1,mb:1}})},o.id))}),e.jsx(l,{variant:"contained",color:"primary",startIcon:e.jsx(oe,{}),onClick:q,sx:{ml:1,height:40,borderRadius:2,boxShadow:2,fontWeight:600,textTransform:"none"},children:"Nuevo Tipo"})]}),e.jsx(B,{open:D,onClose:z,closeAfterTransition:!0,BackdropProps:{timeout:500},children:e.jsxs(s,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",borderRadius:4,boxShadow:24,p:4,outline:"none"},children:[e.jsxs(i,{variant:"h6",fontWeight:700,gutterBottom:!0,color:"primary.main",children:[e.jsx(v,{sx:{mr:1,verticalAlign:"middle"}}),"Crear Nuevo Tipo"]}),e.jsx(y,{label:"Nombre del Tipo",variant:"outlined",fullWidth:!0,value:p,onChange:o=>w(o.target.value),sx:{mb:3}}),e.jsx(l,{variant:"contained",color:"primary",fullWidth:!0,onClick:J,disabled:!p.trim(),sx:{borderRadius:2,fontWeight:600},children:"Crear"})]})}),e.jsx(y,{label:"Buscar Personl",variant:"outlined",fullWidth:!0,value:h,onChange:o=>$(o.target.value),InputProps:{endAdornment:e.jsx(re,{position:"end",children:e.jsx(te,{})})},sx:{mb:4,borderRadius:2,boxShadow:1}}),e.jsx(O,{container:!0,spacing:4,children:V.map((o,r)=>e.jsx(j,{in:!0,timeout:400+r*80,children:e.jsx(O,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(ie,{elevation:6,sx:{borderRadius:4,boxShadow:6,transition:"transform 0.2s","&:hover":{transform:"scale(1.025)",boxShadow:12},mb:2,bgcolor:"background.paper"},children:[e.jsx(se,{children:e.jsxs(x,{direction:"row",spacing:2,alignItems:"center",sx:{mb:1},children:[e.jsx(P,{sx:{bgcolor:"primary.main",width:48,height:48,fontWeight:700,fontSize:22,boxShadow:2},children:e.jsx(U,{fontSize:"large"})}),e.jsxs(s,{children:[e.jsx(i,{variant:"h6",fontWeight:700,color:"text.primary",children:o.name}),e.jsx(i,{variant:"body2",color:"text.secondary",children:o.email})]})]})}),e.jsx(ae,{sx:{pt:0},children:e.jsx(l,{variant:"outlined",color:"primary",onClick:()=>K(o),fullWidth:!0,sx:{borderRadius:2,fontWeight:600,textTransform:"none",py:1,letterSpacing:.5},startIcon:e.jsx(C,{}),children:"Gestionar Tipos"})})]})})},o.id))}),e.jsx(B,{open:F,onClose:f,closeAfterTransition:!0,BackdropProps:{timeout:500},children:e.jsxs(s,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:440,bgcolor:"background.paper",borderRadius:4,boxShadow:24,p:4,outline:"none"},children:[e.jsxs(s,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:[e.jsxs(i,{variant:"h6",fontWeight:700,color:"primary.main",children:[e.jsx(U,{sx:{mr:1,verticalAlign:"middle"}}),"Tipos de ",a==null?void 0:a.name]}),e.jsx(ne,{onClick:f,children:e.jsx(le,{})})]}),Q?e.jsx(s,{display:"flex",justifyContent:"center",py:4,children:e.jsx(G,{})}):e.jsxs(e.Fragment,{children:[e.jsx(pe,{options:c.filter(o=>!d.includes(o.id)),getOptionLabel:o=>o.nombre_tipo,renderInput:o=>e.jsx(y,{...o,label:"Agregar tipo",variant:"outlined"}),renderOption:(o,r)=>t.createElement("li",{...o,key:r.id},r.nombre_tipo),onChange:(o,r)=>{r&&M(r.id)},sx:{mb:3},isOptionEqualToValue:(o,r)=>o.id===r.id,noOptionsText:"No hay tipos para agregar"}),e.jsx(L,{sx:{mb:2}}),e.jsx(i,{variant:"subtitle1",fontWeight:700,sx:{mb:1},children:"Tipos asignados"}),e.jsxs(x,{spacing:1,sx:{mb:2},children:[c.filter(o=>d.includes(o.id)).map((o,r)=>e.jsx(j,{in:!0,timeout:400+r*60,children:e.jsxs(s,{display:"flex",alignItems:"center",justifyContent:"space-between",sx:{border:"1px solid",borderColor:"primary.light",borderRadius:2,px:2,py:1,bgcolor:"primary.50",boxShadow:1},children:[e.jsxs(x,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(P,{sx:{bgcolor:"primary.light",width:32,height:32,fontSize:18},children:e.jsx(v,{fontSize:"small"})}),e.jsx(i,{fontWeight:600,children:o.nombre_tipo})]}),e.jsx(ce,{title:"Quitar tipo",children:e.jsx(l,{variant:"contained",color:"error",size:"small",onClick:()=>M(o.id),sx:{borderRadius:2,fontWeight:600},children:"Quitar"})})]})},o.id)),c.filter(o=>d.includes(o.id)).length===0&&e.jsx(i,{variant:"body2",color:"text.secondary",align:"center",children:"No hay tipos asignados."})]}),e.jsx(l,{variant:"contained",color:"primary",onClick:X,disabled:I,fullWidth:!0,sx:{borderRadius:2,fontWeight:700,py:1.2,fontSize:16},startIcon:e.jsx(C,{}),children:I?e.jsx(G,{size:24}):"Guardar Cambios"})]})]})}),e.jsx(de,{open:u.open,autoHideDuration:3e3,onClose:()=>n(o=>({...o,open:!1})),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(me,{severity:u.severity,variant:"filled",sx:{width:"100%"},children:u.message})})]})}export{go as default};
