import{r as o,a as h,j as e,$ as fe}from"./app-DwTpSH0U.js";import{A as je,P as rr,B as ve,b as ye,c as Ce,d as ar}from"./app-layout-DnzGBPFG.js";import{l as Se}from"./lodash-DeqzbXaO.js";import{u as tr,T as c,P as we}from"./Typography-B8heRhDi.js";import{u as ir}from"./index-DL-LkUPI.js";import{C as V}from"./Container-tLZarD4t.js";import{S as Fe}from"./Skeleton-B7vlTadS.js";import{G as s}from"./Grid-CGKqZQau.js";import{B as l}from"./Box-Dm-9Odlo.js";import{F as ee}from"./Fade-CPmkmtx1.js";import{C as y}from"./Chip-BiIDCYhV.js";import{S as or}from"./Slide-6IwV-Tqb.js";import{A as sr}from"./Alert-CXzScL7w.js";import{B as _}from"./Button-D3LYaN2t.js";import{S as lr}from"./Stack-CfXKeJ1o.js";import{T as p}from"./TextField-C7xTuRXe.js";import{I as nr}from"./InputAdornment-BmV4kISm.js";import{S as dr}from"./Search-CsVShFsE.js";import{A as C}from"./Autocomplete-CSwjbcAC.js";import{A as cr}from"./Assignment-B3Mr45bW.js";import{Z as re}from"./Zoom-DUqF8g2H.js";import{C as $}from"./Card-BU2PQy8v.js";import{F as T,a as z}from"./Select-D3mwh1vN.js";import{R as I,a as x}from"./RadioGroup-D5FHdKIf.js";import{F as m}from"./FormControlLabel-DD1hsK1z.js";import{C as Ee}from"./Cancel-BcY0_vEY.js";import{S as ke}from"./Save-BENE8ZKc.js";import{A as pr}from"./Add-DVZ5trvM.js";import{A as ur}from"./Avatar-Dm_AmidV.js";import{I as ae}from"./IconButton-zbVVF-M4.js";import{C as We}from"./Collapse-B_0kxdNU.js";import{C as xr}from"./CalendarToday-wKIm76Dd.js";import{T as mr}from"./Tooltip-CIjkDYaB.js";import{E as hr}from"./Edit-DMjXLoX-.js";import{b as f}from"./DefaultPropsProvider-DRRnqVYH.js";import"./button-CE2sw9In.js";import"./clsx-B-dksMZM.js";import"./avatar-3rZPDCsD.js";import"./createLucideIcon-8z-XiBgF.js";import"./index-DQwHB60N.js";import"./index-Bu13Uyqm.js";import"./index-DuFQU5C7.js";import"./settings-BWGxbpXO.js";import"./app-logo-icon-kT6HeMlV.js";import"./createSvgIcon-DkcSd2-O.js";import"./createSimplePaletteValueFilter-fPviOYGM.js";import"./getThemeProps-BDgLecqf.js";import"./useTimeout--HoZvQIH.js";import"./useThemeProps-BzNHYq9I.js";import"./isMuiElement-BJS3qdzF.js";import"./TransitionGroupContext-nALX_Gj3.js";import"./useSlot-DErp_0ST.js";import"./ButtonBase-DRmvLRZN.js";import"./debounce-Be36O1Ab.js";import"./Modal-EvmVwdIL.js";import"./ownerDocument-DW-IO8s5.js";import"./Portal-dRwe7D2B.js";import"./Close-C7XsUd9X.js";import"./useId-DQCmvY1A.js";import"./CircularProgress-D9k1A7p4.js";import"./useControlled-CkY63cvR.js";import"./usePreviousProps-B2anHRtO.js";import"./Popper-z26wZ0XF.js";import"./index-Bw2APseq.js";import"./useSlotProps-BNWp3nnv.js";import"./List-NBjoO2Ug.js";import"./Grow-BaQddceE.js";import"./SwitchBase-DWy3ZVON.js";import"./FormGroup-DzPvduDi.js";function Pa(){const[S,te]=o.useState([]),[D,ie]=o.useState([]),[L,oe]=o.useState([]),[R,B]=o.useState("aleatoria"),[se,le]=o.useState([]),[U,G]=o.useState(""),[_e,ne]=o.useState(!0),[q,w]=o.useState(null),[Te,gr]=o.useState("dia"),[br,fr]=o.useState(new Date().toISOString().split("T")[0]),[F,Ie]=o.useState(""),[E,Re]=o.useState(""),[k,Ae]=o.useState(""),[de,H]=o.useState(null),[n,b]=o.useState({titulo:"",prioridad:"",descripcion:"",empresa:"",fecha:"",tipo_id:"",company_id:""}),[ze,Z]=o.useState(!1),[d,g]=o.useState({titulo:"",prioridad:"",descripcion:"",empresa:"",fecha:"",tipo_id:"",company_id:""}),[ce,K]=o.useState("no"),[pe,Q]=o.useState("no"),[jr,vr]=o.useState(null),[yr,Cr]=o.useState({estado:"",detalle:""}),[ue,xe]=o.useState({}),[J,W]=o.useState({}),[De,X]=o.useState(null),[Le,me]=o.useState(""),[M,Me]=o.useState({}),Pe=tr();ir(Pe.breakpoints.down("sm"));const j=async()=>{try{const[r,a,t,i]=await Promise.all([h.get("/tareas-con-asignaciones"),h.get("/api/tipos"),h.get("/api/companies"),h.get("/api/pasantes")]),A=r.data.filter(u=>{var v;return(v=u.asignados)==null?void 0:v.some(O=>{var N;return((N=O.estado)==null?void 0:N.toLowerCase().replace(/\s/g,""))==="en_revision"})});te(A),ie(a.data),oe(t.data),le(i.data.data)}catch(r){console.error("Error al cargar datos:",r),w("Error al cargar datos.")}finally{ne(!1)}},Oe=o.useCallback(async(r,a)=>{W(t=>({...t,[r]:!0}));try{await h.patch(`/asignaciones/${r}`,{estado:a}),await j()}catch(t){console.error("Error al actualizar estado:",t),w("No se pudo actualizar el estado")}finally{W(t=>({...t,[r]:!1}))}},[j]),Ne=o.useCallback(Se.debounce(async(r,a)=>{W(t=>({...t,[r]:!0}));try{await h.patch(`/asignaciones/${r}`,{detalle:a}),await j()}catch(t){console.error("Error al actualizar detalle:",t),w("No se pudo actualizar el detalle")}finally{W(t=>({...t,[r]:!1}))}},1e3),[j]),$e=o.useCallback(Se.debounce(async(r,a)=>{W(t=>({...t,[r]:!0}));try{await h.put(`/tareas/${r}`,{descripcion:a}),await j(),X(null)}catch(t){console.error("Error al actualizar descripci√≥n:",t),w("No se pudo actualizar la descripci√≥n")}finally{W(t=>({...t,[r]:!1}))}},1e3),[j]),Y=o.useMemo(()=>{new Date().toISOString().split("T")[0];let r=S;return S.filter(a=>a.asignados.some(t=>{var i;return((i=t.estado)==null?void 0:i.toLowerCase().replace(/\s/g,""))==="en_revision"})),F&&(r=r.filter(a=>a.titulo.toLowerCase().includes(F.toLowerCase()))),k&&(r=r.filter(a=>a.prioridad===k)),E&&(r=r.filter(a=>a.asignados.some(t=>t.user_name===E))),r},[S,F,k,E]),P=o.useMemo(()=>{const r={};return Y.forEach(a=>{a.asignados.forEach(t=>{const i=t.user_name;r[i]||(r[i]=[]),r[i].push(a)})}),r},[Y]),he=o.useMemo(()=>{const r=new Set;return S.forEach(a=>{a.asignados.forEach(t=>{r.add(t.user_name)})}),Array.from(r).sort()},[S]);o.useEffect(()=>{(async()=>{try{const[a,t,i,A]=await Promise.all([h.get("/tareas-con-asignaciones"),h.get("/api/tipos"),h.get("/api/companies"),h.get("/api/pasantes")]),u=a.data.filter(v=>{var O;return(O=v.asignados)==null?void 0:O.some(N=>{var be;return((be=N.estado)==null?void 0:be.toLowerCase().replace(/\s/g,""))==="en_revision"})});console.log("üìå TAREAS EN REVISI√ìN:",u),te(u),ie(t.data),oe(i.data),le(A.data.data)}catch(a){console.error("Error al cargar datos:",a),w("Hubo un error al cargar los datos. Por favor, intenta de nuevo.")}finally{ne(!1)}})()},[]),o.useEffect(()=>{const r={};Object.keys(P).forEach(a=>{r[a]=!0}),xe(r)},[P]);const Be=r=>{xe(a=>({...a,[r]:!a[r]}))},Ue=r=>{var a,t;H(r.id),b({titulo:r.titulo,prioridad:r.prioridad,descripcion:r.descripcion,empresa:r.empresa,fecha:r.fecha,tipo_id:(a=r.tipo)!=null&&a.id?String(r.tipo.id):"",company_id:(t=r.company)!=null&&t.id?String(r.company.id):""}),Q(r.company?"si":"no")},Ge=()=>{H(null),b({titulo:"",prioridad:"",descripcion:"",empresa:"",fecha:"",tipo_id:"",company_id:""}),Q("no")},qe=async()=>{if(n.titulo.trim())try{const r={...n,tipo_id:n.tipo_id?Number(n.tipo_id):null,company_id:n.company_id?Number(n.company_id):null};await h.put(`/tareas/${de}`,r),H(null),j()}catch(r){console.error("Error al actualizar tarea:",r),w("Error al actualizar la tarea")}},He=()=>{Z(!0),g({titulo:"",prioridad:"",descripcion:"",empresa:"",fecha:new Date().toISOString().split("T")[0],tipo_id:"",company_id:""}),K("no")},Ze=()=>{Z(!1),g({titulo:"",prioridad:"",descripcion:"",empresa:"",fecha:"",tipo_id:"",company_id:""}),K("no"),B("aleatoria"),G("")},Ke=async()=>{if(d.titulo.trim())try{const r={...d,tipo_id:d.tipo_id?Number(d.tipo_id):null,company_id:d.company_id?Number(d.company_id):null,asignacion_aleatoria:R==="aleatoria",pasante_id:R==="manual"?Number(U):null};await h.post("/create/tareas",r),Z(!1),j(),B("aleatoria"),G("")}catch(r){console.error("Error al crear tarea:",r),w("Error al crear la tarea")}},ge=r=>{switch(r.toLowerCase()){case"alta":return"#FF1744";case"media":return"#FF9100";case"baja":return"#00E676";default:return"#9E9E9E"}},Qe=r=>{const a=["#1976d2","#1565c0","#0d47a1","#2196f3","#0288d1","#01579b","#03a9f4","#00b0ff","#0091ea","#3f51b5"],t=r.charCodeAt(0)%a.length;return a[t]},Je=r=>r.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2),Xe=Y.filter(r=>E?r.asignados.some(a=>a.user_name.includes(E)):!0).filter(r=>k?r.prioridad===k:!0).filter(r=>F?r.titulo.toLowerCase().includes(F.toLowerCase()):!0);if(_e)return e.jsxs(je,{breadcrumbs:[{title:"Tareas",href:"/tareas"}],children:[e.jsx(fe,{title:"Tareas"}),e.jsxs(V,{maxWidth:"xl",sx:{py:4},children:[e.jsx(Fe,{variant:"rectangular",height:60,sx:{mb:2,borderRadius:1}}),e.jsx(s,{container:!0,spacing:2,children:[...Array(7)].map((r,a)=>e.jsx(s,{item:!0,xs:12,sm:6,md:!0,children:e.jsx(Fe,{variant:"rectangular",height:400,sx:{borderRadius:2}})},a))})]})]});const Ye=r=>{X(r.id),me(r.descripcion||"")},Ve=`
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
`,er=r=>{Me(a=>({...a,[r]:!a[r]}))};return e.jsxs(je,{breadcrumbs:[{title:"Tareas",href:"/tareas"}],children:[e.jsx(fe,{title:"Tareas"}),e.jsx("style",{children:Ve}),e.jsx(l,{sx:{background:"linear-gradient(135deg, #1976d2 0%, #0d47a1 100%)",color:"white",py:3,position:"relative",overflow:"hidden"},children:e.jsx(V,{maxWidth:"xl",sx:{position:"relative",zIndex:1},children:e.jsx(ee,{in:!0,timeout:800,children:e.jsxs(l,{display:"flex",alignItems:"center",gap:1,mb:2,children:[e.jsx(c,{variant:"h5",fontWeight:"bold",children:"üìÑ Tareas"}),e.jsx(y,{label:"Para Revisi√≥n",color:"warning",variant:"outlined"})]})})})}),e.jsxs(V,{maxWidth:"xl",sx:{py:3},children:[q&&e.jsx(or,{direction:"down",in:!!q,children:e.jsx(sr,{severity:"error",sx:{mb:3,borderRadius:2},action:e.jsx(_,{color:"inherit",size:"small",onClick:j,children:"Reintentar"}),children:q})}),e.jsx(we,{elevation:0,sx:{p:3,mb:3,borderRadius:3,background:"linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%)",border:"1px solid rgba(0,0,0,0.05)",boxShadow:"0 4px 20px rgba(0,0,0,0.08)"},children:e.jsxs(lr,{spacing:3,children:[e.jsxs(l,{sx:{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap"},children:[e.jsx(l,{sx:{flexGrow:1}}),e.jsx(l,{sx:{display:"flex",gap:1}})]}),e.jsxs(s,{container:!0,spacing:2,children:[e.jsx(s,{item:!0,xs:12,md:4,children:e.jsx(p,{fullWidth:!0,placeholder:"Buscar tareas...",value:F,onChange:r=>Ie(r.target.value),InputProps:{startAdornment:e.jsx(nr,{position:"start",children:e.jsx(dr,{})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(s,{item:!0,xs:12,md:4,children:e.jsx(C,{options:he,getOptionLabel:r=>r,value:E||null,onChange:(r,a)=>Re(a||""),clearOnEscape:!0,sx:{minWidth:300},renderInput:r=>e.jsx(p,{...r,label:"üë§ Filtrar por Usuario",placeholder:"Filtrar por usuario",fullWidth:!0})})}),e.jsx(s,{item:!0,xs:12,md:4,children:e.jsx(C,{options:["alta","media","baja"],getOptionLabel:r=>r.charAt(0).toUpperCase()+r.slice(1),value:k||null,onChange:(r,a)=>Ae(a||""),clearOnEscape:!0,sx:{minWidth:300},renderInput:r=>e.jsx(p,{...r,label:"‚ö° Filtrar por Prioridad",placeholder:"Filtrar por prioridad",fullWidth:!0})})})]}),e.jsxs(l,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(y,{icon:e.jsx(cr,{}),label:`${Xe.length} tareas de hoy`,color:"primary",variant:"outlined",sx:{fontWeight:"bold"}}),Te!=="dia"&&e.jsxs(e.Fragment,{children:[e.jsx(y,{icon:e.jsx(rr,{}),label:`${he.length} usuarios`,color:"primary",variant:"outlined",sx:{fontWeight:"bold"}}),e.jsx(y,{icon:e.jsx(ve,{}),label:`${new Set(S.map(r=>{var a;return(a=r.company)==null?void 0:a.name}).filter(Boolean)).size} empresas`,color:"primary",variant:"outlined",sx:{fontWeight:"bold"}})]})]})]})}),ze&&e.jsx(re,{in:!0,children:e.jsxs($,{sx:{mb:3,borderRadius:3,border:"2px solid #1976d2",boxShadow:"0 6px 24px rgba(25, 118, 210, 0.15)"},children:[e.jsxs(l,{sx:{p:3,background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",color:"white"},children:[e.jsx(c,{variant:"h5",fontWeight:"bold",children:"‚ú® Nueva Tarea para Hoy"}),e.jsx(c,{variant:"body2",sx:{opacity:.9},children:"Completa los campos para crear la tarea"})]}),e.jsx(l,{sx:{p:4,background:"white"},children:e.jsxs(s,{container:!0,spacing:3,children:[e.jsx(s,{item:!0,xs:12,children:e.jsx(C,{options:S,getOptionLabel:r=>`${r.titulo} - ${r.fecha}`,filterOptions:(r,{inputValue:a})=>r.filter(t=>t.titulo.toLowerCase().includes(a.toLowerCase())),onChange:(r,a)=>{a&&g(t=>({...t,titulo:a.titulo,descripcion:a.descripcion,empresa:a.empresa}))},renderInput:r=>e.jsx(p,{...r,label:"üîç Buscar tareas existentes",placeholder:"Escribe para buscar una tarea similar...",fullWidth:!0})})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(p,{label:"üìù T√≠tulo",value:d.titulo,onChange:r=>g({...d,titulo:r.target.value}),fullWidth:!0,required:!0})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(p,{label:"üìÖ Fecha",type:"date",value:d.fecha,onChange:r=>g({...d,fecha:r.target.value}),fullWidth:!0,InputLabelProps:{shrink:!0}})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(C,{options:D,getOptionLabel:r=>r.nombre,value:D.find(r=>r.id===Number(d.tipo_id))||null,onChange:(r,a)=>g({...d,tipo_id:a?String(a.id):""}),sx:{minWidth:280},renderInput:r=>e.jsx(p,{...r,label:"üè∑Ô∏è Tipo de tarea",fullWidth:!0})})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsxs(T,{component:"fieldset",children:[e.jsx(z,{children:"‚ö° Prioridad"}),e.jsxs(I,{row:!0,value:d.prioridad,onChange:r=>g({...d,prioridad:r.target.value}),children:[e.jsx(m,{value:"alta",control:e.jsx(x,{}),label:"Alta"}),e.jsx(m,{value:"media",control:e.jsx(x,{}),label:"Media"}),e.jsx(m,{value:"baja",control:e.jsx(x,{}),label:"Baja"})]})]})}),e.jsx(s,{item:!0,xs:12,children:e.jsxs(T,{component:"fieldset",children:[e.jsx(z,{children:"üë• Asignaci√≥n"}),e.jsxs(I,{row:!0,value:R,onChange:r=>B(r.target.value),children:[e.jsx(m,{value:"aleatoria",control:e.jsx(x,{}),label:"Aleatoria"}),e.jsx(m,{value:"manual",control:e.jsx(x,{}),label:"Manual"})]})]})}),R==="manual"&&e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(C,{options:se,getOptionLabel:r=>`${r.name} (${r.email})`,value:se.find(r=>String(r.id)===U)||null,onChange:(r,a)=>G(a?String(a.id):""),sx:{minWidth:300},renderInput:r=>e.jsx(p,{...r,label:"üßë‚Äçüíº Seleccionar Pasante",fullWidth:!0})})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsxs(T,{component:"fieldset",children:[e.jsx(z,{children:"üè¢ ¬øAsignar empresa?"}),e.jsxs(I,{row:!0,value:ce,onChange:r=>{K(r.target.value),r.target.value==="no"&&g({...d,company_id:""})},children:[e.jsx(m,{value:"si",control:e.jsx(x,{}),label:"S√≠"}),e.jsx(m,{value:"no",control:e.jsx(x,{}),label:"No"})]})]})}),ce==="si"&&e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(C,{options:L,getOptionLabel:r=>r.nombre,value:L.find(r=>r.id===Number(d.company_id))||null,onChange:(r,a)=>g({...d,company_id:a?String(a.id):""}),sx:{minWidth:280},renderInput:r=>e.jsx(p,{...r,label:"üè¢ Seleccionar Empresa",fullWidth:!0})})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(p,{label:"üìÑ Descripci√≥n",multiline:!0,rows:3,value:d.descripcion,onChange:r=>g({...d,descripcion:r.target.value}),fullWidth:!0})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(p,{label:"üìÑ Contenido",multiline:!0,rows:3,value:d.empresa,onChange:r=>g({...d,empresa:r.target.value}),fullWidth:!0})}),e.jsxs(s,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:2},children:[e.jsx(_,{variant:"outlined",onClick:Ze,startIcon:e.jsx(Ee,{}),sx:{borderRadius:2,px:3,py:1,fontWeight:"bold",borderColor:"#9e9e9e",color:"#424242","&:hover":{backgroundColor:"#f5f5f5",borderColor:"#616161"}},children:"Cancelar"}),e.jsx(_,{variant:"contained",onClick:Ke,disabled:!d.titulo.trim()||R==="manual"&&!U,startIcon:e.jsx(ke,{}),sx:{borderRadius:2,px:3,py:1,fontWeight:"bold",background:"linear-gradient(45deg, #4caf50 0%, #2e7d32 100%)","&:hover":{background:"linear-gradient(45deg, #388e3c 0%, #1b5e20 100%)",transform:"scale(1.02)"},transition:"all 0.3s ease"},children:"Crear Tarea"})]})]})})]})}),de&&e.jsx(re,{in:!0,children:e.jsxs($,{sx:{mb:3,borderRadius:3,border:"3px solid #FF9100",boxShadow:"0 8px 32px rgba(255, 145, 0, 0.2)",overflow:"hidden"},children:[e.jsxs(l,{sx:{p:3,background:"linear-gradient(135deg, #FF9100 0%, #FF6F00 100%)",color:"white"},children:[e.jsx(c,{variant:"h5",fontWeight:"bold",sx:{display:"flex",alignItems:"center",gap:1},children:"‚úèÔ∏è Editar Tarea"}),e.jsx(c,{variant:"body2",sx:{opacity:.9,mt:.5},children:"Modifica los campos que necesites actualizar"})]}),e.jsx(l,{sx:{p:4,background:"linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%)"},children:e.jsxs(s,{container:!0,spacing:3,children:[e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(p,{fullWidth:!0,label:"üìù T√≠tulo de la tarea",value:n.titulo,onChange:r=>b({...n,titulo:r.target.value}),required:!0,sx:{"& .MuiOutlinedInput-root":{borderRadius:2,"&:hover":{borderColor:"#FF9100"}}}})}),e.jsx(s,{item:!0,xs:12,md:3,children:e.jsx(p,{type:"date",fullWidth:!0,label:"üìÖ Fecha",value:n.fecha,onChange:r=>b({...n,fecha:r.target.value}),InputLabelProps:{shrink:!0},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(s,{item:!0,xs:12,md:4,children:e.jsx(C,{options:D,getOptionLabel:r=>r.nombre,value:D.find(r=>r.id===Number(n.tipo_id))||null,onChange:(r,a)=>b({...n,tipo_id:a?String(a.id):""}),sx:{minWidth:300},renderInput:r=>e.jsx(p,{...r,label:"üè∑Ô∏è Tipo de tarea",placeholder:"Selecciona un tipo",fullWidth:!0})})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsxs(T,{component:"fieldset",fullWidth:!0,children:[e.jsx(z,{component:"legend",sx:{fontWeight:"bold",mb:1,color:"#FF9100"},children:"‚ö° Prioridad"}),e.jsxs(I,{row:!0,value:n.prioridad,onChange:r=>b({...n,prioridad:r.target.value}),children:[e.jsx(m,{value:"alta",control:e.jsx(x,{sx:{color:"#FF1744","&.Mui-checked":{color:"#FF1744"}}}),label:"Alta"}),e.jsx(m,{value:"media",control:e.jsx(x,{sx:{color:"#FF9100","&.Mui-checked":{color:"#FF9100"}}}),label:"Media"}),e.jsx(m,{value:"baja",control:e.jsx(x,{sx:{color:"#00E676","&.Mui-checked":{color:"#00E676"}}}),label:"Baja"})]})]})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsxs(T,{component:"fieldset",fullWidth:!0,children:[e.jsx(z,{component:"legend",sx:{fontWeight:"bold",mb:1,color:"#FF9100"},children:"üè¢ ¬øCambiar empresa?"}),e.jsxs(I,{row:!0,value:pe,onChange:r=>{Q(r.target.value),r.target.value==="no"&&b({...n,company_id:""})},children:[e.jsx(m,{value:"si",control:e.jsx(x,{}),label:"S√≠"}),e.jsx(m,{value:"no",control:e.jsx(x,{}),label:"No"})]})]})}),pe==="si"&&e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(C,{options:L,getOptionLabel:r=>r.nombre,value:L.find(r=>r.id===Number(n.company_id))||null,onChange:(r,a)=>b({...n,company_id:a?String(a.id):""}),sx:{minWidth:300},renderInput:r=>e.jsx(p,{...r,label:"üè¢ Empresa",placeholder:"Selecciona una empresa",fullWidth:!0})})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,multiline:!0,rows:3,label:"üìÑ Descripci√≥n",value:n.descripcion,onChange:r=>b({...n,descripcion:r.target.value}),placeholder:"Describe la tarea en detalle...",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,multiline:!0,rows:3,label:"üìÑ Contenido",value:n.empresa,onChange:r=>b({...n,empresa:r.target.value}),placeholder:"Describe la tarea en detalle...",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(s,{item:!0,xs:12,children:e.jsxs(l,{sx:{display:"flex",gap:2,justifyContent:"flex-end"},children:[e.jsx(_,{variant:"outlined",startIcon:e.jsx(Ee,{}),onClick:Ge,sx:{borderRadius:2,minWidth:120},children:"Cancelar"}),e.jsx(_,{variant:"contained",startIcon:e.jsx(ke,{}),onClick:qe,disabled:!n.titulo.trim(),sx:{borderRadius:2,minWidth:120,background:"linear-gradient(45deg, #FF9100 0%, #FF6F00 100%)","&:hover":{background:"linear-gradient(45deg, #FF8F00 0%, #E65100 100%)"}},children:"Actualizar"})]})})]})})]})}),e.jsx(ee,{in:!0,children:e.jsx(l,{children:Object.keys(P).length===0?e.jsxs(we,{sx:{p:6,textAlign:"center",borderRadius:3,background:"linear-gradient(145deg, #f8f9fa 0%, #e9ecef 100%)"},children:[e.jsx(c,{variant:"h5",color:"text.secondary",sx:{mb:2},children:"üìù No hay tareas para hoy"}),e.jsx(c,{color:"text.secondary",sx:{mb:3},children:"No se encontraron tareas programadas para hoy"}),e.jsx(_,{variant:"contained",startIcon:e.jsx(pr,{}),onClick:()=>He(),sx:{borderRadius:2,background:"linear-gradient(45deg, #1976d2 0%, #0d47a1 100%)"},children:"Crear primera tarea"})]}):Object.entries(P).map(([r,a],t)=>e.jsx(ee,{in:!0,timeout:300+t*100,children:e.jsxs($,{sx:{mb:3,borderRadius:3,overflow:"hidden",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:3,background:"linear-gradient(135deg, #1976d2 0%, #2196f3 100%)",color:"white",cursor:"pointer","&:hover":{background:"linear-gradient(135deg, #1565c0 0%, #1976d2 100%)"},transition:"background 0.3s ease"},onClick:()=>Be(r),children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(ur,{sx:{bgcolor:"white",color:Qe(r),fontWeight:"bold",width:48,height:48},children:Je(r)}),e.jsxs(l,{children:[e.jsx(c,{variant:"h5",fontWeight:"bold",children:r}),e.jsxs(c,{variant:"body1",sx:{opacity:.9},children:[a.length," ",a.length===1?"tarea asignada":"tareas asignadas"]})]})]}),e.jsx(ae,{sx:{color:"white"},children:ue[r]?e.jsx(ye,{}):e.jsx(Ce,{})})]}),e.jsx(We,{in:ue[r]??!0,children:e.jsx(l,{sx:{p:2},children:a.map((i,A)=>e.jsx(re,{in:!0,style:{transitionDelay:`${A*100}ms`},children:e.jsxs($,{sx:{mb:2,borderRadius:2,border:"1px solid rgba(0,0,0,0.1)",transition:"all 0.3s ease","&:hover":{boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},borderLeft:`6px solid ${ge(i.prioridad)}`,overflow:"hidden"},children:[e.jsxs(l,{onClick:()=>er(i.id),sx:{p:2,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",bgcolor:M[i.id]?f("#1976d2",.02):"transparent","&:hover":{bgcolor:f("#1976d2",.05)},transition:"background-color 0.2s ease"},children:[e.jsxs(l,{sx:{flexGrow:1},children:[e.jsx(c,{variant:"h6",fontWeight:"bold",sx:{mb:1,color:M[i.id]?"#1976d2":"text.primary"},children:i.titulo}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsx(y,{size:"small",label:i.prioridad.toUpperCase(),sx:{bgcolor:ge(i.prioridad),color:"white",fontWeight:"bold",fontSize:"0.75rem"}}),e.jsx(y,{size:"small",icon:e.jsx(xr,{fontSize:"small"}),label:i.fecha,variant:"outlined",color:"primary"}),i.tipo&&e.jsx(y,{size:"small",icon:e.jsx(ar,{fontSize:"small"}),label:i.tipo.nombre_tipo,variant:"outlined",color:"primary"}),i.company&&e.jsx(y,{size:"small",icon:e.jsx(ve,{fontSize:"small"}),label:i.company.name,variant:"outlined",color:"primary"})]})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(mr,{title:"Editar tarea",children:e.jsx(ae,{onClick:u=>{u.stopPropagation(),Ue(i)},size:"small",color:"primary",sx:{bgcolor:f("#1976d2",.1),"&:hover":{bgcolor:f("#1976d2",.2)}},children:e.jsx(hr,{fontSize:"small"})})}),e.jsx(ae,{size:"small",sx:{color:"#1976d2"},children:M[i.id]?e.jsx(ye,{}):e.jsx(Ce,{})})]})]}),e.jsx(We,{in:M[i.id]??!1,children:e.jsx(l,{sx:{px:3,pb:3},children:e.jsxs(l,{sx:{borderTop:"1px solid rgba(0,0,0,0.1)",pt:2},children:[i.asignados.map(u=>e.jsxs(l,{sx:{mb:3,p:2,borderRadius:2,bgcolor:f("#1976d2",.02),border:"1px solid rgba(25, 118, 210, 0.1)"},children:[e.jsxs(l,{sx:{mb:2},children:[e.jsxs(c,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:"bold",display:"flex",alignItems:"center",gap:1},children:["üìä Estado de la tarea:",J[u.id]&&e.jsx(l,{sx:{width:16,height:16,border:"2px solid #1976d2",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}})]}),e.jsx(T,{component:"fieldset",size:"small",children:e.jsxs(I,{row:!0,value:u.estado,onChange:v=>Oe(u.id,v.target.value),sx:{gap:2,flexWrap:"wrap"},children:[e.jsx(m,{value:"pendiente",control:e.jsx(x,{size:"small",sx:{color:"#FF9100","&.Mui-checked":{color:"#FF9100"},"&:hover":{bgcolor:f("#FF9100",.1)}}}),label:e.jsx(c,{variant:"body2",sx:{fontSize:"0.875rem"},children:"Pendiente"})}),e.jsx(m,{value:"en_revision",control:e.jsx(x,{size:"small",sx:{color:"#2196F3","&.Mui-checked":{color:"#2196F3"},"&:hover":{bgcolor:f("#2196F3",.1)}}}),label:e.jsx(c,{variant:"body2",sx:{fontSize:"0.875rem"},children:"En revisi√≥n"})}),e.jsx(m,{value:"corregir",control:e.jsx(x,{size:"small",sx:{color:"#2196F3","&.Mui-checked":{color:"#2196F3"},"&:hover":{bgcolor:f("#2196F3",.1)}}}),label:e.jsx(c,{variant:"body2",sx:{fontSize:"0.875rem"},children:"Corregir"})}),e.jsx(m,{value:"publicada",control:e.jsx(x,{size:"small",sx:{color:"#4CAF50","&.Mui-checked":{color:"#4CAF50"},"&:hover":{bgcolor:f("#4CAF50",.1)}}}),label:e.jsx(c,{variant:"body2",sx:{fontSize:"0.875rem"},children:"Publicada"})})]})})]}),e.jsxs(l,{sx:{mb:2},children:[e.jsxs(c,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:"bold",display:"flex",alignItems:"center",gap:1},children:["üìù Detalle del progreso:",J[u.id]&&e.jsx(c,{variant:"caption",color:"primary",sx:{fontStyle:"italic"},children:"Guardando..."})]}),e.jsx(p,{fullWidth:!0,size:"small",multiline:!0,rows:2,placeholder:"Escribe aqu√≠ los detalles del progreso...",defaultValue:u.detalle||"",onChange:v=>Ne(u.id,v.target.value),sx:{"& .MuiOutlinedInput-root":{borderRadius:2,bgcolor:"white","&:hover":{bgcolor:"white",borderColor:"#1976d2"},"&.Mui-focused":{bgcolor:"white",borderColor:"#1976d2"}}}})]})]},u.id)),e.jsxs(l,{sx:{mt:2},children:[e.jsxs(c,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:"bold",display:"flex",alignItems:"center",gap:1},children:["üìÑ Descripci√≥n de la tarea:",J[i.id]&&e.jsx(c,{variant:"caption",color:"primary",sx:{fontStyle:"italic"},children:"Guardando..."})]}),De===i.id?e.jsx(p,{fullWidth:!0,multiline:!0,rows:3,value:Le,onChange:u=>{me(u.target.value),$e(i.id,u.target.value)},onBlur:()=>X(null),autoFocus:!0,placeholder:"Describe la tarea en detalle...",sx:{"& .MuiOutlinedInput-root":{borderRadius:2,bgcolor:"white","&:hover":{borderColor:"#1976d2"}}}}):e.jsx(l,{onClick:()=>Ye(i),sx:{p:2,borderRadius:2,bgcolor:"white",border:"1px dashed rgba(25, 118, 210, 0.3)",cursor:"pointer",transition:"all 0.2s ease","&:hover":{bgcolor:f("#1976d2",.02),borderColor:"#1976d2",borderStyle:"solid"}},children:e.jsx(c,{variant:"body2",color:i.descripcion?"text.primary":"text.secondary",sx:{fontStyle:i.descripcion?"normal":"italic",lineHeight:1.5},children:i.descripcion||"Haz clic para agregar una descripci√≥n..."})})]})]})})})]})},i.id))})})]})},r))})})]})]})}export{Pa as default};
