import{q as oe,r as h,v as z,m as k,j as e,$ as te}from"./app-gcPa0s22.js";import{A as ae,B as N}from"./app-layout-CO_KMSKV.js";import{A as D}from"./Add-BwNGm6w2.js";import{C as se}from"./CalendarToday-DFbyrGqB.js";import{R as ie,C as ne,a as le}from"./react-confetti-BblYtwKS.js";import{C as de}from"./CheckCircle-7bn5U5qY.js";import{E as ce}from"./Edit-Ds06yvyx.js";import{P as pe}from"./Phone-C-psF8Yy.js";import{S as xe}from"./Search-BvbNGRVG.js";import{T as me}from"./TrendingUp-DNzIyDEv.js";import{S as ue}from"./Snackbar-CdaY7GhV.js";import{A as he}from"./Alert-CJikWYwn.js";import{B as t}from"./Box-DeqaGcCp.js";import{A as H}from"./Avatar-DkFLvq6x.js";import{T as s}from"./Typography-C3iDGIYS.js";import{T as f}from"./TextField-CU4Ift9l.js";import{I as A}from"./InputAdornment-TnoEheyC.js";import{I as W}from"./IconButton-DjCumPI2.js";import{B as v}from"./Button-C4bSYQaA.js";import{G as l}from"./Grid-CyJainsZ.js";import{P as fe}from"./Pagination-7xZgUlhP.js";import{M as ge}from"./Modal-DgGQVq81.js";import{F as M,I as O,S as B}from"./Select-B5o_GQW_.js";import{M as G}from"./MenuItem-SlLzB4Lr.js";import{C as be}from"./Card-bCG4Y8ZR.js";import{C as je}from"./CardContent-DbNFM9e4.js";import{C as L}from"./Chip-B5Ywctie.js";import{L as ve}from"./LinearProgress-BkNA7VTC.js";import{D as Ce}from"./Divider-D8Enaemt.js";import{C as Se}from"./CardActions-NGQ3xXj8.js";import{T as R}from"./Tooltip-BHE_YPiI.js";import{G as ye}from"./index-BRiNMHR3.js";import"./button-DWmv4xKc.js";import"./clsx-B-dksMZM.js";import"./avatar-DEAtloF7.js";import"./createLucideIcon-DtIvEspD.js";import"./index-8qmTPeiK.js";import"./index-C3PMNp9i.js";import"./index-BZXrUZ9C.js";import"./settings-COpbVc2A.js";import"./app-logo-icon-TNEIzHJ2.js";import"./createSvgIcon-Bvn2cbuR.js";import"./DefaultPropsProvider-D0UdZHkc.js";import"./useTimeout-D1Dphss0.js";import"./useSlot-DDOmgoeR.js";import"./TransitionGroupContext-dVxC_wZ9.js";import"./ClickAwayListener-CnDlVj7z.js";import"./Fade-D2Lgt6Fr.js";import"./ownerDocument-DW-IO8s5.js";import"./Grow-DazsCD7o.js";import"./createSimplePaletteValueFilter-BHDmXtX9.js";import"./Close-DObueOUl.js";import"./useId-B2TArqAG.js";import"./ButtonBase-BZ4Bemvj.js";import"./CircularProgress-CfS9p-RR.js";import"./useThemeProps-C-UIwKqD.js";import"./getThemeProps-D5BX1hbN.js";import"./isMuiElement-QxEqWT4A.js";import"./index-B2WmQ1i5.js";import"./LastPage-BD3VpcH-.js";import"./useControlled-CKqLkeIN.js";import"./Portal-ltdkSTfj.js";import"./useSlotProps-CY715XIJ.js";import"./List-DL6HMG9F.js";import"./debounce-Be36O1Ab.js";import"./listItemTextClasses-DWX30277.js";import"./dividerClasses-DdJp5AUC.js";import"./Popper-4em_Wl-9.js";const we=["Sin exito","En proceso","Completado"],_e={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600,bgcolor:"background.paper",boxShadow:24,p:4,borderRadius:"12px",maxHeight:"90vh",overflowY:"auto"},Ie=o=>{switch(o){case"Completado":return{color:"success",bg:"#e8f5e8",text:"#2e7d32"};case"En proceso":return{color:"warning",bg:"#fff3e0",text:"#ef6c00"};case"Sin exito":return{color:"error",bg:"#ffebee",text:"#c62828"};default:return{color:"default",bg:"#f5f5f5",text:"#666"}}},Ee=o=>{switch(o){case"Completado":return 100;case"En proceso":return 50;case"Sin exito":return 25;default:return 0}},ze=({seguimiento:o,onEdit:x,onFinalize:g,onCancel:c,disabled:i})=>{var j;const m=Ie(o.estado),C=Ee(o.estado),[b,w]=h.useState(!1);return e.jsxs(be,{sx:{height:"100%",display:"flex",flexDirection:"column",borderRadius:3,boxShadow:"0 4px 20px rgba(0,0,0,0.08)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",border:"1px solid rgba(0,0,0,0.05)",position:"relative",overflow:"hidden",minWidth:0,wordBreak:"break-word","&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 30px rgba(0,0,0,0.12)"}},children:[e.jsx(t,{sx:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",p:2,color:"white"},children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(H,{sx:{bgcolor:"rgba(255,255,255,0.2)",width:40,height:40},children:e.jsx(N,{})}),e.jsxs(t,{sx:{flexGrow:1},children:[e.jsx(s,{variant:"h6",sx:{fontWeight:600,fontSize:"1.1rem",lineHeight:1.2,textShadow:"0 1px 2px rgba(0,0,0,0.1)"},children:o.nombre_empresa}),e.jsx(s,{variant:"body2",sx:{opacity:.9,fontSize:"0.85rem"},children:(j=o.paquete)==null?void 0:j.nombre_paquete})]})]})}),e.jsxs(je,{sx:{flexGrow:1,p:2.5},children:[e.jsxs(t,{sx:{mb:2.5},children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsx(s,{variant:"body2",color:"text.secondary",fontWeight:500,children:"Estado del proyecto"}),e.jsx(L,{label:o.estado,size:"small",sx:{bgcolor:m.bg,color:m.text,fontWeight:600,fontSize:"0.75rem"}})]}),e.jsx(ve,{variant:"determinate",value:C,sx:{height:6,borderRadius:3,bgcolor:"rgba(0,0,0,0.08)","& .MuiLinearProgress-bar":{borderRadius:3,bgcolor:m.text}}})]}),e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:1.5},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(se,{sx:{fontSize:18,color:"text.secondary"}}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Inicio:"}),e.jsx(s,{variant:"body2",fontWeight:500,children:new Date(o.fecha_inicio).toLocaleDateString("es-ES")})]}),o.celular&&e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(pe,{sx:{fontSize:18,color:"text.secondary"}}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Contacto:"}),e.jsx(s,{variant:"body2",fontWeight:500,children:o.celular})]})]})]}),e.jsx(Ce,{}),e.jsxs(Se,{sx:{p:2,justifyContent:"space-between"},children:[e.jsx(t,{sx:{display:"flex",gap:1},children:o.estado!=="Completado"&&o.estado!=="Sin exito"&&e.jsxs(e.Fragment,{children:[e.jsx(R,{title:"Editar empresa",children:e.jsx(W,{size:"small",onClick:()=>x(o),disabled:i,sx:{bgcolor:"primary.main",color:"white","&:hover":{bgcolor:"primary.dark"}},children:e.jsx(ce,{fontSize:"small"})})}),e.jsx(R,{title:"Completar contrato",children:e.jsx(v,{variant:"contained",size:"small",startIcon:e.jsx(de,{fontSize:"small"}),onClick:()=>g(o),disabled:i,sx:{bgcolor:"success.main",color:"white",borderRadius:2,textTransform:"none",fontSize:"0.85rem","&:hover":{bgcolor:"success.dark"}},children:"Completar contrato"})}),e.jsx(R,{title:"Cancelar empresa",children:e.jsx(W,{size:"small",onClick:()=>c(o),disabled:i,sx:{bgcolor:"error.main",color:"white","&:hover":{bgcolor:"error.dark"}},children:e.jsx(ye,{fontSize:"small"})})})]})}),(o.estado==="Sin exito"||o.estado==="Completado")&&e.jsx(L,{label:o.estado==="Sin exito"?"Cancelado":"Completado",size:"small",sx:{bgcolor:m.bg,color:m.text,fontWeight:600}})]})]})},Nr=()=>{const{seguimientos:o,paquetes:x,auth:g,filters:c}=oe().props,i=o,[m,C]=h.useState(!1),[b,w]=h.useState(!1),[j,_]=h.useState(null),[n,q]=h.useState((c==null?void 0:c.search)||""),[T,I]=h.useState(!1),P=new Date().toISOString().slice(0,10),{data:u,setData:p,post:$,put:V,reset:F,processing:S,errors:a}=z({nombre_empresa:"",id_user:g.user.id,id_paquete:x.length>0?x[0].id:0,estado:"En proceso",fecha_inicio:P,fecha_fin:"",descripcion:"",celular:""}),{put:Y,processing:U}=z(),{put:J,processing:K}=z();h.useEffect(()=>{const r=setTimeout(()=>{n!==(c==null?void 0:c.search)&&k.get(route("seguimiento-empresa-vendedor.index"),{search:n},{preserveState:!0,preserveScroll:!0,replace:!0})},500);return()=>clearTimeout(r)},[n]);const E=r=>{r?(w(!0),_(r),p({nombre_empresa:r.nombre_empresa,id_user:r.id_user,id_paquete:r.id_paquete,estado:r.estado,fecha_inicio:r.fecha_inicio,fecha_fin:r.fecha_fin||"",descripcion:r.descripcion||"",celular:r.celular||""})):(w(!1),_(null),F(),p({nombre_empresa:"",id_user:g.user.id,id_paquete:x.length>0?x[0].id:0,estado:"En proceso",fecha_inicio:P,fecha_fin:"",descripcion:"",celular:""})),C(!0)},y=()=>{C(!1),_(null),F()},Q=r=>{r.preventDefault(),b&&j?V(route("seguimiento-empresa-vendedor.update",j.id),{onSuccess:()=>{y()},onError:d=>{console.error("Error al actualizar:",d)}}):$(route("seguimiento-empresa-vendedor.store"),{onSuccess:()=>{y()},onError:d=>{console.error("Error al crear:",d)}})},X=r=>{confirm("Â¿EstÃ¡s seguro de que deseas completar este contrato?")&&Y(route("seguimiento-empresa-vendedor.finalize",r.id),{onSuccess:()=>{I(!0)},onError:d=>{console.error("Error al finalizar:",d)}})},Z=r=>{confirm("Â¿EstÃ¡s seguro de que deseas cancelar esta empresa?")&&J(route("seguimiento-empresa-vendedor.cancel",r.id),{onSuccess:()=>{},onError:d=>{console.error("Error al cancelar:",d)}})},ee=(r,d)=>{k.get(route("seguimiento-empresa-vendedor.index"),{page:d,search:n},{preserveState:!0,preserveScroll:!0})},re=()=>{q(""),k.get(route("seguimiento-empresa-vendedor.index"),{},{preserveState:!0,preserveScroll:!0,replace:!0})};return e.jsxs(ae,{user:g.user,header:e.jsx("h2",{className:"text-xl leading-tight font-semibold text-gray-800",children:"Seguimiento de Empresas"}),children:[e.jsx(te,{title:"Seguimiento de Empresas"}),T&&e.jsx(ie,{width:window.innerWidth,height:window.innerHeight,numberOfPieces:300,recycle:!1}),e.jsx(ue,{open:T,autoHideDuration:4e3,onClose:()=>I(!1),anchorOrigin:{vertical:"top",horizontal:"center"},children:e.jsx(he,{elevation:6,variant:"filled",onClose:()=>I(!1),severity:"success",icon:e.jsx(ne,{fontSize:"inherit"}),sx:{fontSize:18,alignItems:"center"},children:"Â¡Felicidades! Has finalizado un contrato exitosamente ðŸŽ‰"})}),e.jsxs(t,{sx:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",p:4,borderRadius:3,mb:4,position:"relative",overflow:"hidden"},children:[e.jsx(t,{sx:{position:"relative",zIndex:1},children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:3,mb:2},children:[e.jsx(H,{sx:{width:60,height:60,bgcolor:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)"},children:e.jsx(me,{sx:{fontSize:32}})}),e.jsxs(t,{children:[e.jsx(s,{variant:"h4",sx:{fontWeight:700,textShadow:"0 2px 4px rgba(0,0,0,0.3)",mb:.5},children:"Seguimiento de Empresas"}),e.jsx(s,{variant:"h6",sx:{opacity:.9,fontWeight:400},children:"Gestiona y monitorea tus contratos activos"})]})]})}),e.jsx(t,{sx:{position:"absolute",top:-20,right:-20,width:150,height:150,borderRadius:"50%",bgcolor:"rgba(255,255,255,0.1)",opacity:.5}}),e.jsx(t,{sx:{position:"absolute",bottom:-30,left:-30,width:100,height:100,borderRadius:"50%",bgcolor:"rgba(255,255,255,0.1)",opacity:.3}})]}),e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:[e.jsxs(t,{sx:{mb:4},children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,gap:2},children:[e.jsx(f,{placeholder:"Buscar por empresa, celular o paquete...",value:n,onChange:r=>q(r.target.value),sx:{flexGrow:1,maxWidth:500,"& .MuiOutlinedInput-root":{borderRadius:3,bgcolor:"white","&:hover":{boxShadow:"0 4px 20px rgba(0,0,0,0.08)"}}},InputProps:{startAdornment:e.jsx(A,{position:"start",children:e.jsx(xe,{})}),endAdornment:n&&e.jsx(A,{position:"end",children:e.jsx(W,{"aria-label":"limpiar bÃºsqueda",onClick:re,edge:"end",size:"small",children:e.jsx(le,{})})})}}),e.jsx(v,{variant:"contained",startIcon:e.jsx(D,{}),onClick:()=>E(),sx:{borderRadius:3,px:3,py:1.5,textTransform:"none",fontWeight:600,background:"linear-gradient(45deg, #667eea 30%, #764ba2 90%)",boxShadow:"0 4px 20px rgba(102, 126, 234, 0.3)","&:hover":{background:"linear-gradient(45deg, #5a67d8 30%, #6b46c1 90%)",boxShadow:"0 6px 25px rgba(102, 126, 234, 0.4)"}},children:"Nueva Empresa"})]}),e.jsxs(s,{variant:"body2",color:"text.secondary",sx:{mb:3},children:["Mostrando ",i.data.length," de ",i.total," empresas",n&&` (filtrado por: "${n}")`]})]}),e.jsx(l,{container:!0,spacing:3,sx:{mb:4,display:"flex",alignItems:"center",justifyContent:"center"},children:i.data.map(r=>e.jsx(l,{item:!0,xs:12,sm:6,lg:4,sx:{display:"flex"},children:e.jsx(ze,{seguimiento:r,onEdit:E,onFinalize:X,onCancel:Z,disabled:S||U||K})},r.id))}),i.data.length===0&&e.jsxs(t,{sx:{textAlign:"center",py:8,bgcolor:"white",borderRadius:3,boxShadow:"0 4px 20px rgba(0,0,0,0.08)"},children:[e.jsx(N,{sx:{fontSize:80,color:"text.secondary",mb:2}}),e.jsx(s,{variant:"h5",color:"text.primary",fontWeight:600,mb:1,children:n?"No se encontraron empresas":"No hay empresas registradas"}),e.jsx(s,{variant:"body1",color:"text.secondary",mb:3,children:n?"Intenta con diferentes tÃ©rminos de bÃºsqueda":'Crea tu primera empresa haciendo clic en "Nueva Empresa"'}),!n&&e.jsx(v,{variant:"contained",startIcon:e.jsx(D,{}),onClick:()=>E(),sx:{borderRadius:3,px:4,py:1.5,textTransform:"none",fontWeight:600,background:"linear-gradient(45deg, #667eea 30%, #764ba2 90%)"},children:"Crear Primera Empresa"})]}),i.last_page>1&&e.jsx(t,{sx:{display:"flex",justifyContent:"center",mt:4},children:e.jsx(fe,{count:i.last_page,page:i.current_page,onChange:ee,color:"primary",showFirstButton:!0,showLastButton:!0,sx:{"& .MuiPaginationItem-root":{borderRadius:2}}})})]})}),e.jsx(ge,{open:m,onClose:y,children:e.jsxs(t,{sx:_e,component:"form",onSubmit:Q,children:[e.jsx(s,{variant:"h6",component:"h2",mb:3,fontWeight:600,children:b?"Editar Empresa":"Crear Nueva Empresa"}),e.jsxs(l,{container:!0,spacing:3,children:[e.jsx(l,{item:!0,xs:12,children:e.jsx(f,{fullWidth:!0,label:"Nombre de Empresa",value:u.nombre_empresa,onChange:r=>p("nombre_empresa",r.target.value),required:!0,error:!!a.nombre_empresa,helperText:a.nombre_empresa,sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(f,{fullWidth:!0,label:"Celular",value:u.celular,onChange:r=>p("celular",r.target.value),placeholder:"Ej: +591 70000000",error:!!a.celular,helperText:a.celular,sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(l,{item:!0,xs:12,children:e.jsxs(M,{fullWidth:!0,required:!0,error:!!a.id_paquete,children:[e.jsx(O,{children:"Paquete"}),e.jsx(B,{value:u.id_paquete,label:"Paquete",onChange:r=>p("id_paquete",r.target.value),sx:{borderRadius:2},children:x.map(r=>e.jsx(G,{value:r.id,children:r.nombre_paquete},r.id))}),a.id_paquete&&e.jsx(s,{variant:"caption",color:"error",sx:{mt:.5,ml:1.5},children:a.id_paquete})]})}),e.jsx(l,{item:!0,xs:12,children:e.jsxs(M,{fullWidth:!0,required:!0,error:!!a.estado,children:[e.jsx(O,{children:"Estado"}),e.jsx(B,{value:u.estado,label:"Estado",disabled:!0,sx:{borderRadius:2},children:we.map(r=>e.jsx(G,{value:r,children:r},r))}),a.estado&&e.jsx(s,{variant:"caption",color:"error",sx:{mt:.5,ml:1.5},children:a.estado})]})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(f,{fullWidth:!0,label:"Fecha de Inicio",type:"date",value:u.fecha_inicio,onChange:r=>p("fecha_inicio",r.target.value),InputLabelProps:{shrink:!0},required:!0,error:!!a.fecha_inicio,helperText:a.fecha_inicio,sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(f,{fullWidth:!0,label:"DescripciÃ³n",multiline:!0,rows:4,value:u.descripcion,onChange:r=>p("descripcion",r.target.value),placeholder:"Describe detalles del seguimiento, contactos, notas importantes...",error:!!a.descripcion,helperText:a.descripcion,sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),b&&e.jsx(l,{item:!0,xs:12,children:e.jsx(f,{fullWidth:!0,label:"Fecha de Fin",type:"date",value:u.fecha_fin,onChange:r=>p("fecha_fin",r.target.value),InputLabelProps:{shrink:!0},error:!!a.fecha_fin,helperText:a.fecha_fin||"Solo completar si el seguimiento ya ha finalizado",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})})]}),e.jsxs(t,{sx:{display:"flex",justifyContent:"flex-end",mt:4,gap:2},children:[e.jsx(v,{onClick:y,variant:"outlined",disabled:S,sx:{borderRadius:2,px:3,py:1,textTransform:"none",fontWeight:500},children:"Cancelar"}),e.jsx(v,{type:"submit",variant:"contained",disabled:S,sx:{borderRadius:2,px:3,py:1,textTransform:"none",fontWeight:600,background:"linear-gradient(45deg, #667eea 30%, #764ba2 90%)","&:hover":{background:"linear-gradient(45deg, #5a67d8 30%, #6b46c1 90%)"}},children:S?"Procesando...":b?"Guardar Cambios":"Crear Empresa"})]})]})})]})};export{Nr as default};
